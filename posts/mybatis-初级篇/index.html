<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='MyBatis å®éªŒç¯å¢ƒæ­å»º å‰è¨€ MyBatis æ˜¯ä¸€ä¸ªç†è®ºå°‘ï¼Œå®è·µæ€§å¼ºçš„æ¡†æ¶ï¼›å®ƒæ²¡æœ‰å¤ªå¤šçš„æ¦‚å¿µï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼å°±æ˜¯å®è·µã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ­å»º MyBatis çš„å®è·µç¯å¢ƒï¼Œæ–¹ä¾¿åç»­ç« èŠ‚çš„å­¦ä¹ ã€‚
æ–°å»ºé¡¹ç›® è€ƒè™‘åˆ°å·¥ç¨‹çš„ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é€‰æ‹© IDE æ¥æ–°å»ºä¸€ä¸ª Maven é¡¹ç›®æ¥ä½¿ç”¨ MyBatisã€‚å½“ç„¶å¦‚æœä½ æ›´å€¾å‘äº† Gradleï¼Œé‚£ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œä½ åªéœ€è¦æ›´æ”¹æ·»åŠ ä¾èµ–çš„æ–¹å¼å³å¯ã€‚
åœ¨ IDE ä¸Šï¼Œä½ å¯ä»¥é€‰æ‹© Eclipse æˆ–è€… IDEAï¼Œå½“ç„¶æˆ‘ä»¬æ›´æ¨èä½ ä½¿ç”¨ IDEAï¼Œå› ä¸ºå®ƒçš„ç¤¾åŒºç‰ˆå·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹  MyBatis äº†ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯å…è´¹çš„ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬ä»¥ IDEA ä½œä¸ºé»˜è®¤çš„å¼€å‘ç¯å¢ƒã€‚
æ‰“å¼€ IDEAï¼Œé€‰æ‹© New Projectï¼Œç‚¹å‡»å·¦ä¾§çš„Mavené¡¹ï¼Œç„¶å Next æ–°å»ºé¡¹ç›®ï¼Œå¦‚ä¸‹å›¾ï¼š
è¿›å…¥ä¸‹ä¸€é¡µåï¼Œè¾“å…¥å¯¹åº”çš„ GroupId å’Œ ArtifactIdï¼Œå¦‚ä¸‹å›¾ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„ idï¼Œä½†æ˜¯æˆ‘ä»¬æ¨èä½ è·Ÿæˆ‘ä»¬ä¿æŒä¸€è‡´ï¼Œè¿™æ ·åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä½ çš„é…ç½®å’Œä»£ç æ‰èƒ½è·Ÿæˆ‘ä»¬å®Œå…¨ä¸€è‡´ã€‚
å¡«å®Œä»¥åï¼Œç‚¹å‡» Next ç›´åˆ°å‡ºç° Finishï¼Œç‚¹å‡»å®Œæˆå³å¯ã€‚
æ·»åŠ ä¾èµ– é¡¹ç›®æ–°å»ºåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° pom.xmlæ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  &amp;lt;dependencies&amp;gt; &amp;lt;!'><title>MyBatis åˆçº§ç¯‡</title>

<link rel='canonical' href='https://ahao.ink/posts/mybatis-%E5%88%9D%E7%BA%A7%E7%AF%87/'>

<link rel="stylesheet" href="/scss/style.min.baba905ab2d1209de74a1930c487a8a663c37860af6aa1c26588d298bf620306.css"><meta property='og:title' content='MyBatis åˆçº§ç¯‡'>
<meta property='og:description' content='MyBatis å®éªŒç¯å¢ƒæ­å»º å‰è¨€ MyBatis æ˜¯ä¸€ä¸ªç†è®ºå°‘ï¼Œå®è·µæ€§å¼ºçš„æ¡†æ¶ï¼›å®ƒæ²¡æœ‰å¤ªå¤šçš„æ¦‚å¿µï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼å°±æ˜¯å®è·µã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ­å»º MyBatis çš„å®è·µç¯å¢ƒï¼Œæ–¹ä¾¿åç»­ç« èŠ‚çš„å­¦ä¹ ã€‚
æ–°å»ºé¡¹ç›® è€ƒè™‘åˆ°å·¥ç¨‹çš„ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é€‰æ‹© IDE æ¥æ–°å»ºä¸€ä¸ª Maven é¡¹ç›®æ¥ä½¿ç”¨ MyBatisã€‚å½“ç„¶å¦‚æœä½ æ›´å€¾å‘äº† Gradleï¼Œé‚£ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œä½ åªéœ€è¦æ›´æ”¹æ·»åŠ ä¾èµ–çš„æ–¹å¼å³å¯ã€‚
åœ¨ IDE ä¸Šï¼Œä½ å¯ä»¥é€‰æ‹© Eclipse æˆ–è€… IDEAï¼Œå½“ç„¶æˆ‘ä»¬æ›´æ¨èä½ ä½¿ç”¨ IDEAï¼Œå› ä¸ºå®ƒçš„ç¤¾åŒºç‰ˆå·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹  MyBatis äº†ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯å…è´¹çš„ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬ä»¥ IDEA ä½œä¸ºé»˜è®¤çš„å¼€å‘ç¯å¢ƒã€‚
æ‰“å¼€ IDEAï¼Œé€‰æ‹© New Projectï¼Œç‚¹å‡»å·¦ä¾§çš„Mavené¡¹ï¼Œç„¶å Next æ–°å»ºé¡¹ç›®ï¼Œå¦‚ä¸‹å›¾ï¼š
è¿›å…¥ä¸‹ä¸€é¡µåï¼Œè¾“å…¥å¯¹åº”çš„ GroupId å’Œ ArtifactIdï¼Œå¦‚ä¸‹å›¾ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„ idï¼Œä½†æ˜¯æˆ‘ä»¬æ¨èä½ è·Ÿæˆ‘ä»¬ä¿æŒä¸€è‡´ï¼Œè¿™æ ·åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä½ çš„é…ç½®å’Œä»£ç æ‰èƒ½è·Ÿæˆ‘ä»¬å®Œå…¨ä¸€è‡´ã€‚
å¡«å®Œä»¥åï¼Œç‚¹å‡» Next ç›´åˆ°å‡ºç° Finishï¼Œç‚¹å‡»å®Œæˆå³å¯ã€‚
æ·»åŠ ä¾èµ– é¡¹ç›®æ–°å»ºåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° pom.xmlæ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  &amp;lt;dependencies&amp;gt; &amp;lt;!'>
<meta property='og:url' content='https://ahao.ink/posts/mybatis-%E5%88%9D%E7%BA%A7%E7%AF%87/'>
<meta property='og:site_name' content='ahao&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-06-16T13:36:41&#43;00:00'/><meta property='article:modified_time' content='2022-03-18T08:28:31&#43;00:00'/><meta property='og:image' content='https://ahao.ink/18.jpg' />
<meta name="twitter:title" content="MyBatis åˆçº§ç¯‡">
<meta name="twitter:description" content="MyBatis å®éªŒç¯å¢ƒæ­å»º å‰è¨€ MyBatis æ˜¯ä¸€ä¸ªç†è®ºå°‘ï¼Œå®è·µæ€§å¼ºçš„æ¡†æ¶ï¼›å®ƒæ²¡æœ‰å¤ªå¤šçš„æ¦‚å¿µï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼å°±æ˜¯å®è·µã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ­å»º MyBatis çš„å®è·µç¯å¢ƒï¼Œæ–¹ä¾¿åç»­ç« èŠ‚çš„å­¦ä¹ ã€‚
æ–°å»ºé¡¹ç›® è€ƒè™‘åˆ°å·¥ç¨‹çš„ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é€‰æ‹© IDE æ¥æ–°å»ºä¸€ä¸ª Maven é¡¹ç›®æ¥ä½¿ç”¨ MyBatisã€‚å½“ç„¶å¦‚æœä½ æ›´å€¾å‘äº† Gradleï¼Œé‚£ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œä½ åªéœ€è¦æ›´æ”¹æ·»åŠ ä¾èµ–çš„æ–¹å¼å³å¯ã€‚
åœ¨ IDE ä¸Šï¼Œä½ å¯ä»¥é€‰æ‹© Eclipse æˆ–è€… IDEAï¼Œå½“ç„¶æˆ‘ä»¬æ›´æ¨èä½ ä½¿ç”¨ IDEAï¼Œå› ä¸ºå®ƒçš„ç¤¾åŒºç‰ˆå·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹  MyBatis äº†ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯å…è´¹çš„ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬ä»¥ IDEA ä½œä¸ºé»˜è®¤çš„å¼€å‘ç¯å¢ƒã€‚
æ‰“å¼€ IDEAï¼Œé€‰æ‹© New Projectï¼Œç‚¹å‡»å·¦ä¾§çš„Mavené¡¹ï¼Œç„¶å Next æ–°å»ºé¡¹ç›®ï¼Œå¦‚ä¸‹å›¾ï¼š
è¿›å…¥ä¸‹ä¸€é¡µåï¼Œè¾“å…¥å¯¹åº”çš„ GroupId å’Œ ArtifactIdï¼Œå¦‚ä¸‹å›¾ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„ idï¼Œä½†æ˜¯æˆ‘ä»¬æ¨èä½ è·Ÿæˆ‘ä»¬ä¿æŒä¸€è‡´ï¼Œè¿™æ ·åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä½ çš„é…ç½®å’Œä»£ç æ‰èƒ½è·Ÿæˆ‘ä»¬å®Œå…¨ä¸€è‡´ã€‚
å¡«å®Œä»¥åï¼Œç‚¹å‡» Next ç›´åˆ°å‡ºç° Finishï¼Œç‚¹å‡»å®Œæˆå³å¯ã€‚
æ·»åŠ ä¾èµ– é¡¹ç›®æ–°å»ºåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° pom.xmlæ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  &amp;lt;dependencies&amp;gt; &amp;lt;!"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://ahao.ink/18.jpg' />
    <link rel="shortcut icon" href="img/avatar_hua8acc2063f8134c9d13980a8a63800c2_11114_300x0_resize_box_3.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hua8acc2063f8134c9d13980a8a63800c2_11114_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ·</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ahao&#39;s Blog</a></h1>
            <h2 class="site-description">é“é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/'
                        target="_blank"
                        title="GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ / Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ / Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ / Search</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº / About</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>æš—è‰²æ¨¡å¼</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/posts/mybatis-%E5%88%9D%E7%BA%A7%E7%AF%87/">
                
                    <img src="/18.jpg" loading="lazy" alt="Featured image of post MyBatis åˆçº§ç¯‡" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/mybatis/" >
                MyBatis
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/mybatis-%E5%88%9D%E7%BA%A7%E7%AF%87/">MyBatis åˆçº§ç¯‡</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2021å¹´6æœˆ16æ—¥</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 29 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h1 id="mybatis-å®éªŒç¯å¢ƒæ­å»º">MyBatis å®éªŒç¯å¢ƒæ­å»º</h1>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>MyBatis æ˜¯ä¸€ä¸ªç†è®ºå°‘ï¼Œå®è·µæ€§å¼ºçš„æ¡†æ¶ï¼›å®ƒæ²¡æœ‰å¤ªå¤šçš„æ¦‚å¿µï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼å°±æ˜¯<code>å®è·µ</code>ã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ­å»º MyBatis çš„å®è·µç¯å¢ƒï¼Œæ–¹ä¾¿åç»­ç« èŠ‚çš„å­¦ä¹ ã€‚</p>
<h2 id="æ–°å»ºé¡¹ç›®">æ–°å»ºé¡¹ç›®</h2>
<p>è€ƒè™‘åˆ°å·¥ç¨‹çš„ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é€‰æ‹© IDE æ¥æ–°å»ºä¸€ä¸ª Maven é¡¹ç›®æ¥ä½¿ç”¨ MyBatisã€‚å½“ç„¶å¦‚æœä½ æ›´å€¾å‘äº† Gradleï¼Œé‚£ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œä½ åªéœ€è¦æ›´æ”¹æ·»åŠ ä¾èµ–çš„æ–¹å¼å³å¯ã€‚</p>
<p>åœ¨ IDE ä¸Šï¼Œä½ å¯ä»¥é€‰æ‹© Eclipse æˆ–è€… IDEAï¼Œå½“ç„¶æˆ‘ä»¬æ›´æ¨èä½ ä½¿ç”¨ IDEAï¼Œå› ä¸ºå®ƒçš„ç¤¾åŒºç‰ˆå·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹  MyBatis äº†ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯å…è´¹çš„ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬ä»¥ IDEA ä½œä¸ºé»˜è®¤çš„å¼€å‘ç¯å¢ƒã€‚</p>
<p>æ‰“å¼€ IDEAï¼Œé€‰æ‹© <code>New Project</code>ï¼Œç‚¹å‡»å·¦ä¾§çš„<code>Maven</code>é¡¹ï¼Œç„¶å Next æ–°å»ºé¡¹ç›®ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<!-- raw HTML omitted -->
<p>è¿›å…¥ä¸‹ä¸€é¡µåï¼Œè¾“å…¥å¯¹åº”çš„ GroupId å’Œ ArtifactIdï¼Œå¦‚ä¸‹å›¾ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„ idï¼Œä½†æ˜¯æˆ‘ä»¬æ¨èä½ è·Ÿæˆ‘ä»¬<code>ä¿æŒä¸€è‡´</code>ï¼Œè¿™æ ·åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä½ çš„é…ç½®å’Œä»£ç æ‰èƒ½è·Ÿæˆ‘ä»¬å®Œå…¨ä¸€è‡´ã€‚</p>
<!-- raw HTML omitted -->
<p>å¡«å®Œä»¥åï¼Œç‚¹å‡» Next ç›´åˆ°å‡ºç° Finishï¼Œç‚¹å‡»å®Œæˆå³å¯ã€‚</p>
<h2 id="æ·»åŠ ä¾èµ–">æ·»åŠ ä¾èµ–</h2>
<p>é¡¹ç›®æ–°å»ºåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° <code>pom.xml</code>æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- MyBatis ä¾èµ– --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>3.5.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- mysql é©±åŠ¨ --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>8.0.18<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- æ—¥å¿—ä¾èµ– --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- æ–‡ä»¶æ‰“åŒ…é…ç½® --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;resources&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;resource&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;directory&gt;</span>src/main/resources<span class="nt">&lt;/directory&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;filtering&gt;</span>false<span class="nt">&lt;/filtering&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/resource&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;resource&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;directory&gt;</span>src/main/java<span class="nt">&lt;/directory&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;includes&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;include&gt;</span>**/*.properties<span class="nt">&lt;/include&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;include&gt;</span>**/*.xml<span class="nt">&lt;/include&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;include&gt;</span>**/*.tld<span class="nt">&lt;/include&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/includes&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;filtering&gt;</span>false<span class="nt">&lt;/filtering&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/resource&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/resources&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ çš„ä¾èµ–æ¯”è¾ƒå¤šï¼Œè™½ç„¶åœ¨ç›¸åº”çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿæ‰“ä¸Šäº†æ³¨é‡Šï¼Œä¸è¿‡æˆ‘ä»¬ä¾ç„¶å¾—è¯´æ˜ä¸€ä¸‹ã€‚dependency æ˜¯ Maven ç®¡ç†ä¾èµ–çš„æ–¹å¼ï¼Œæˆ‘ä»¬åˆ†åˆ«æ·»åŠ äº† mybatisã€mysql-connector-java å’Œ logback-classicã€‚</p>
<p>å…¶ä¸­ MyBatis ä½œä¸ºæˆ‘ä»¬çš„ä¸»è§’ï¼Œå®ƒçš„ä¾èµ–æ˜¯å¿…ä¸å¯å°‘çš„ï¼›ç”±äºå®æ“éœ€è¦æ•°æ®åº“ç¯å¢ƒï¼Œæˆ‘ä»¬ä¹Ÿæ·»åŠ ä¸Šäº† MySQL é©±åŠ¨ä¾èµ–ï¼›ä¸ºäº†æ›´å¥½çš„æŸ¥çœ‹ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿæ·»åŠ äº† logback æ—¥å¿—æ¡†æ¶ã€‚</p>
<p>å¦å¤–ï¼Œç”±äº Maven æ‰“åŒ…é»˜è®¤ä¸ä¼šæ‰“åŒ… <code>src/main/java</code>æ–‡ä»¶å¤¹ä¸‹çš„èµ„æºæ–‡ä»¶ï¼Œä½†å®é™…çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾èµ„æºæ–‡ä»¶ï¼Œå¦‚<code>.xml</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¿…é¡»æ›´æ”¹è¿™ä¸ªé…ç½®ã€‚</p>
<p>æ·»åŠ ä¾èµ–åï¼ŒIDE ä¼šæä¾›ä½ æ˜¯å¦å¯¼å…¥è¿™äº›ä¾èµ–ï¼Œè¯·ä½ ç‚¹å‡»ç¡®è®¤ï¼Œå¹¶ä¸”ç­‰å¾…ä¸€ä¼šå„¿ï¼Œå¾…ä¾èµ–å¯¼å…¥å®Œæˆæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥äº†ã€‚</p>
<h2 id="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</h2>
<p>é¡¹ç›®æ­å»ºå¥½åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€å®šçš„æ•°æ®æ”¯æŒã€‚é¦–å…ˆï¼Œè¯·åœ¨ä½ å¯ç”¨çš„æ•°æ®åº“ç¯å¢ƒä¸­æ–°å»ºä¸€ä¸ªåä¸º<code>mybatisdemo</code>çš„æ•°æ®åº“ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„åç§°ï¼Œä½†è¿˜æ˜¯å¸Œæœ›ä½ èƒ½ä¸æˆ‘ä»¬ä¿æŒä¸€è‡´ï¼Œæ–°å»ºæ•°æ®åº“æˆåŠŸåï¼Œæ¥ç€è¿è¡Œä»¥ä¸‹ SQL è„šæœ¬ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">user</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">username</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">age</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">score</span><span class="w"> </span><span class="nb">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">user</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;peter&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;pedro&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;jerry&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;mike&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;tom&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">+</span><span class="c1">----+----------+-----+-------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">----+----------+-----+-------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">peter</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">18</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">100</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">pedro</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">24</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">200</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">jerry</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">28</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">500</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">mike</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mi">12</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">300</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">tom</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">27</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">1000</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">----+----------+-----+-------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“">å°ç»“</h2>
<p>æœ¬å°èŠ‚æ˜¯ä¸€ä¸ªçº¯å®æ“å°èŠ‚ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»‹ç»ä»»ä½•æ¦‚å¿µï¼Œè€Œæ˜¯å¸¦ä½ ä¸€èµ·æ­å»ºäº†å­¦ä¹  MyBatis éœ€è¦çš„ç¯å¢ƒå’Œæ•°æ®ï¼Œåç»­çš„æ‰€æœ‰å°èŠ‚éƒ½å°†<code>ç›´æ¥ä¾èµ–äº</code>æœ¬å°èŠ‚ã€‚</p>
<h1 id="mybatis-ç®€å•ä½¿ç”¨">MyBatis ç®€å•ä½¿ç”¨</h1>
<h2 id="å‰è¨€-1">å‰è¨€</h2>
<p>åœ¨ä¸Šé¢ä¸­ï¼Œæˆ‘ä»¬æ­å»ºäº† MyBatis å®éªŒç¯å¢ƒã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹ å¦‚ä½•ä½¿ç”¨ MyBatisï¼Œè™½ç„¶åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä½ å‡ ä¹ä¸ä¼šæŒ‰ç…§æœ¬å°èŠ‚æ‰€ä»‹ç»çš„æ–¹å¼å»ä½¿ç”¨ MyBatisï¼Œä½†æ˜¯è¿™å¯¹ä½ ç†Ÿæ‚‰ MyBatis æ•´ä½“ç»“æ„æœ‰ç€é‡è¦ä½œç”¨ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯é¢è¯•çš„é‡ç‚¹ã€‚</p>
<h2 id="ç¼–ç¨‹å¼ä½¿ç”¨">ç¼–ç¨‹å¼ä½¿ç”¨</h2>
<p>MyBatis å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æœªè¯¦ç»†çš„ä»‹ç»å¦‚ä½•ç¼–ç¨‹å¼ä½¿ç”¨ MyBatisï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ <code>é…ç½®æ–‡ä»¶</code>æ¥æ‹¿åˆ°é…ç½®ç„¶åå¼€å¯ä¼šè¯çš„ã€‚è¿™æ ·çš„æ–¹å¼å›ºç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å´å±è”½äº†å¤ªå¤šçš„ç»†èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬æƒ³ä»ç‚¹åˆ°é¢ï¼Œå±‚å±‚é€’è¿›ç»™ä½ ä»‹ç» MyBatis çš„åŸºç¡€ç”¨æ³•ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å†™ä¸€ä¸ªç®€å•çš„ demo æ¥ä½¿ç”¨ä¸€ä¸‹ MyBatisã€‚</p>
<h3 id="å¯åŠ¨-mybatis">å¯åŠ¨ MyBatis</h3>
<p>åœ¨ mybatis-primer é¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤çš„åŒ…<code>com.ahao.mybatis</code>ï¼Œåœ¨è¯¥åŒ…ä¸‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªåŒ…åä¸º<code>pattern</code>ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»ºä¸€ä¸ªåä¸º<code>StartNoXml.java</code>çš„ç±»ï¼Œå¹¶å‘è¯¥æ–‡ä»¶ä¸­å¡«å……å¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.pattern</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.datasource.pooled.PooledDataSource</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.mapping.Environment</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.Configuration</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">&#34;SqlResolve&#34;</span><span class="o">,</span> <span class="s">&#34;SqlNoDataSourceInspection&#34;</span><span class="o">,</span> <span class="s">&#34;Duplicates&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StartNoXml</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æ— éœ€xmlé…ç½®çš„æ–¹å¼ä½¿ç”¨MyBatis
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// å‡†å¤‡jdbcäº‹åŠ¡ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">JdbcTransactionFactory</span> <span class="n">jdbcTransactionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JdbcTransactionFactory</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// é…ç½®æ•°æ®æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">PooledDataSource</span> <span class="n">dataSource</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">      <span class="k">new</span> <span class="n">PooledDataSource</span><span class="o">(</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;jdbc:mysql://localhost:3306/mybatisdemo?useSSL=false&amp;characterEncoding=utf8&amp;serverTimezone = GMT&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;root&#34;</span><span class="o">,</span> <span class="s">&#34;123456&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// é…ç½®ç¯å¢ƒï¼Œå‘ç¯å¢ƒä¸­æŒ‡å®šç¯å¢ƒidã€äº‹åŠ¡å’Œæ•°æ®æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Environment</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="s">&#34;development&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="na">transactionFactory</span><span class="o">(</span><span class="n">jdbcTransactionFactory</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æ–°å»º MyBatis é…ç½®ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Configuration</span> <span class="n">configuration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Configuration</span><span class="o">(</span><span class="n">environment</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å¾—åˆ° SqlSessionFactory æ ¸å¿ƒç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">configuration</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å¼€å§‹ä¸€ä¸ª sql ä¼šè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å¾—åˆ° sql è¿æ¥å¹¶è¿è¡Œ sql è¯­å¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">PreparedStatement</span> <span class="n">preStatement</span> <span class="o">=</span> <span class="n">session</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="na">getConnection</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">&#34;SELECT * FROM user WHERE id = ?&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">preStatement</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ResultSet</span> <span class="n">result</span> <span class="o">=</span> <span class="n">preStatement</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// éªŒè¯ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;username: &#34;</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å…³é—­ä¼šè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä½¿ä½ ä¸ç†Ÿæ‚‰ MyBatisï¼Œä¹Ÿæ²¡æœ‰å¿…è¦è¢«è¿™æ®µä»£ç ç»™å“åˆ°ï¼Œå› ä¸ºåœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä½ å‡ ä¹æ²¡æœ‰æœºä¼šå»å†™è¿™æ®µä»£ç ã€‚ä½†æ˜¯æˆ‘ä»¬ä»éœ€è¦ä»‹ç»è¿™æ®µä»£ç ï¼Œå®ƒå¯èƒ½æ˜¯ä½ é¢è¯•çš„é‡ç‚¹ã€‚</p>
<p>ä¹¦å†™å®Œæ¯•åï¼Œè¯·åœ¨ PooledDataSource ç±»æ„é€ å‡½æ•°ä¸­æ›´æ”¹æ•°æ®ç”¨æˆ·åã€å¯†ç å’Œ url é…ç½®ä»¥æ»¡è¶³ä½ æ‰€ä½¿ç”¨çš„æ•°æ®åº“ç¯å¢ƒã€‚è¿è¡Œä¸€ä¸‹è¿™æ®µä»£ç ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåœ¨æ§åˆ¶å°ä¸­ä½ ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºå†…å®¹ï¼ˆåªæˆªå–äº†éƒ¨åˆ†å†…å®¹ï¼‰ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/25/Mh7JZbSyBqPcXWx.png"
	
	
	
	loading="lazy"
	
		alt="image-20211225112035789"
	
	
></p>
<h3 id="ä½¿ç”¨æµç¨‹">ä½¿ç”¨æµç¨‹</h3>
<p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€å®šé‡çš„æ³¨é‡Šè¯´æ˜äº†æµç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ã€‚</p>
<p>å¯¹äº MyBatis çš„åŸºç¡€ä½¿ç”¨å¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹<code>3</code>æ­¥ï¼š</p>
<ol>
<li>å¾—åˆ° MyBatis é…ç½®ä¿¡æ¯ï¼Œå³ä»£ç ä¸­çš„<code>Configuration</code>ç±»ã€‚Configuration è´Ÿè´£ MyBatis æ¶æ„ä¸­çš„é…ç½®éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šdataSourceæ•°æ®æºä¿¡æ¯éƒ½ä¼šäº¤ç»™ Configuration å»ç®¡ç†ï¼›è¿™ä¸€æ­¥å…¶å®æ˜¯æ¯”è¾ƒç¹æ‚çš„ï¼ŒEnvironment æ˜¯ Configuration ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè€Œ PooledDataSource å’Œ JdbcTransactionFactory åˆæ˜¯ Environment ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬æ˜¯å±äºå±‚å±‚é€’è¿›çš„å…³ç³»ã€‚å…¶ä¸­ JdbcTransactionFactory è¡¨ç¤ºäº‹åŠ¡å·¥å‚ï¼Œå½“ MyBatis éœ€è¦æ–°å»ºäº‹åŠ¡çš„æ—¶å€™ï¼Œä¼šé€šè¿‡å®ƒæ¥æ–°å»ºï¼›PooledDataSource è¡¨ç¤ºæ•°æ®æºï¼Œé€šè¿‡å…¶æ„é€ å‚æ•°ï¼Œæˆ‘ä»¬ä¼ å…¥äº†æ•°æ®åº“ urlï¼Œæ•°æ®åº“ç”¨æˆ·å’Œå¯†ç ç­‰é…ç½®ï¼›Configuration å¯ä»¥æœ‰å¤šä¸ª Environmentï¼Œå› æ­¤æ¯ä¸ª Environment éƒ½å¿…é¡»æœ‰å”¯ä¸€çš„ idï¼Œå³ä»£ç ä¸­çš„ developmentï¼Œå°†è¿™äº›é…ç½®æ­é…ç»„åˆåå°±æ˜¯ä¸€ä¸ªå¯ç”¨çš„ Configurationã€‚</li>
<li>é€šè¿‡ Configuration æ¥åˆ›å»º <code>SqlSessionFactory</code>ã€‚MyBatis æ˜¯é€šè¿‡ä¼šè¯çš„æ–¹å¼æ¥æ‰§è¡Œ SQL çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¼šè¯åˆ›å»ºå™¨ï¼Œå³ä¼šè¯å·¥å‚ã€‚</li>
<li>æ–°å»º<code>SqlSession</code>æ¥æ‰§è¡Œ SQLã€‚æœ‰äº† SqlSessionFactory åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿åœ°æ–°å»ºä¼šè¯ï¼Œå¹¶é€šè¿‡ä¼šè¯æ¥æ‰§è¡Œ SQL äº†ã€‚</li>
</ol>
<p>è€Œ<code>PreparedStatement</code>åŠä»¥ä¸‹çš„å†…å®¹ï¼Œå…¶å®å¹¶ä¸å±äº MyBatisï¼Œå®ƒä»¬æ˜¯ JDBC æä¾›çš„ï¼Œåœ¨å®é™…çš„ MyBatis å¼€å‘ä¸­ï¼Œä½ ä¹Ÿä¸ä¼šè¿™æ ·å»æ‰§è¡Œ SQLï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªæ˜¯ä¸ºäº†å±•ç¤º MyBatis å’Œ JDBC çš„å…³ç³»ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¼–ç¨‹å¼ä½¿ç”¨ MyBatis å…¶å®æ˜¯æ¯”è¾ƒå¤æ‚ï¼Œä½ éœ€è¦ååˆ†ç†Ÿæ‚‰ MyBatis çš„ APIï¼Œè€Œä¸”è¿™ç§ç¡¬ç¼–ç çš„æ–¹å¼æ˜¯æ¯”è¾ƒç¬¨é‡çš„ï¼Œæ‰€ä»¥ç»å¤§å¤šæ•°èµ„æ–™éƒ½æ¨èé…ç½®çš„æ–¹å¼ä½¿ç”¨ MyBatisã€‚</p>
<h2 id="é…ç½®å¼ä½¿ç”¨">é…ç½®å¼ä½¿ç”¨</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹å¦‚ä½•é€šè¿‡é…ç½®æ¥ä½¿ç”¨ MyBatisã€‚</p>
<h3 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨<code>resources</code>ç›®å½•ä¸‹æ–°å»º<code>mybatis-config.xml</code>é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä¸Šå¦‚ä¸‹é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatisdemo?useSSL=false&amp;amp;serverTimezone = GMT&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰äº†ä¸Šé¢ç¼–ç¨‹å¼ API çš„ä½¿ç”¨ç»éªŒï¼Œé‚£ä¹ˆä½ ä¸€å®šå¯ä»¥è½»æ¾çš„çœ‹æ‡‚é…ç½®é¡¹ï¼Œ<code>configuration</code> æ ‡ç­¾å¯¹åº” Configuration ç±»ï¼Œ<code>environment</code> æ ‡ç­¾å¯¹åº” Environment ç±»ï¼Œ<code>transactionManager</code>æ ‡ç­¾å’Œ<code>dataSource</code>æ ‡ç­¾åˆ†åˆ«å¯¹åº” JdbcTransactionFactory å’Œ PooledDataSource ç±»ã€‚</p>
<p>æœ‰äº†é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬æ— éœ€ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªçš„æ–°å»ºç±»ï¼Œè€Œæ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå³å¯ï¼Œå¦‚<code>driver</code>çš„å€¼æŒ‡å®šä¸º<code>com.mysql.cj.jdbc.Driver</code>ã€‚å½“åç»­éœ€è¦ä¿®æ”¹çš„æ—¶å€™ï¼Œä¹Ÿä¸éœ€è¦å»ä»£ç ä¸­æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å³å¯ã€‚</p>
<blockquote>
<p><strong>TIPSï¼š</strong> æ³¨æ„ï¼Œ è¯·åœ¨ä½ è‡ªå·±çš„é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æ•°æ®åº“é…ç½®ï¼Œä»¥æ»¡è¶³ä½ è‡ªå·±çš„æ•°æ®åº“ç¯å¢ƒã€‚</p>
</blockquote>
<h3 id="å¯åŠ¨-mybatis-1">å¯åŠ¨ MyBatis</h3>
<p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬åœ¨ patter åŒ…ä¸‹æ–°å»ºå¦ä¸€ä¸ªç±»ï¼Œåä¸º<code>StartWithXml.java</code>ï¼Œå¹¶å¡«å……ä»¥ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.pattern</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">&#34;SqlResolve&#34;</span><span class="o">,</span> <span class="s">&#34;SqlNoDataSourceInspection&#34;</span><span class="o">,</span> <span class="s">&#34;Duplicates&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StartWithXml</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">SQLException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// é…ç½®å¼ä½¿ç”¨MyBatis
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// è¯»å–é…ç½®æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æŒ‰ç…§é…ç½®æ–‡ä»¶å¾—åˆ° SqlSessionFactory
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æ–°å»ºä¼šè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æ‰§è¡ŒSQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">PreparedStatement</span> <span class="n">preStatement</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getConnection</span><span class="o">().</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">&#34;SELECT * FROM user WHERE id = ?&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">preStatement</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ResultSet</span> <span class="n">result</span> <span class="o">=</span> <span class="n">preStatement</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;username: &#34;</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å…³é—­ä¼šè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œä»£ç ï¼Œä½ ä¼šçœ‹åˆ°è·Ÿä¸Šé¢ä¸€æ ·çš„ç»“æœã€‚</p>
<h3 id="ä½¿ç”¨æµç¨‹-1">ä½¿ç”¨æµç¨‹</h3>
<p>é…ç½®å¼ä½¿ç”¨ MyBatisï¼Œä¹Ÿå¯åˆ†ä¸º<code>3</code>æ­¥ï¼š</p>
<ol>
<li>è¯»å–é…ç½®æ–‡ä»¶ï¼Œå³<code>mybatis-config.xml</code>ã€‚</li>
<li>é€šè¿‡é…ç½®æ–‡ä»¶æ¥åˆ›å»º <code>SqlSessionFactory</code>ã€‚</li>
<li>æ–°å»º<code>SqlSession</code>æ¥æ‰§è¡Œ SQLã€‚</li>
</ol>
<p>ä¸ç¼–ç¨‹å¼ç›¸æ¯”ï¼Œé…ç½®å¼æ›´ä¸ºç®€æ´ï¼Œæ›´æ˜“ç»´æŠ¤ï¼Œæ‰€ä»¥ä½¿ç”¨å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰èµ„æ–™éƒ½æ¨èè¿™ç§æ–¹å¼æ¥ä½¿ç”¨ MyBatisã€‚ä½†æ˜¯ç¼–ç¨‹å¼å¹¶éæ²¡æœ‰æ„ä¹‰ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ¢³ç† MyBatis ç»“æ„ï¼Œæœ‰äº†ç¼–ç¨‹å¼çš„åŸºç¡€ï¼Œä½ æ‰èƒ½æ›´åŠ å®¹æ˜“åœ°çœ‹æ‡‚é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåœ¨åç»­çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éƒ½å°†é»˜è®¤åœ°ä½¿ç”¨é…ç½®å¼ã€‚</p>
<h2 id="å°ç»“-1">å°ç»“</h2>
<ul>
<li>åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä½ éƒ½å°‘æœ‰æœºä¼šå»æŒ‰ç…§æœ¬å°èŠ‚çš„æ–¹å¼å»ä½¿ç”¨ MyBatisï¼Œä½†æ˜¯è¿™å¯¹ä½ <code>æ·±å…¥ç†è§£MyBatis</code>ç»“æ„æœ‰é‡è¦ä½œç”¨ã€‚</li>
<li>ç¼–ç¨‹å¼ä½¿ç”¨çš„ API è¾ƒå¤šï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦å»æ­»è®°ç¡¬èƒŒï¼Œç†Ÿç»ƒæŒæ¡å…¶ä½¿ç”¨æµç¨‹ï¼Œèƒ½åœ¨éœ€è¦çš„æ—¶å€™æŸ¥é˜…å³å¯ã€‚</li>
</ul>
<h1 id="mybatis-mapper">MyBatis mapper</h1>
<h2 id="å‰è¨€-2">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis mapperã€‚</p>
<p>åœ¨ä¸Šä¸€èŠ‚ä¸­æˆ‘ä»¬ä»¥ JDBC çš„æ–¹å¼ä½¿ç”¨äº† MyBatisï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­æ˜¯ä¸ä¼šé€‰æ‹©è¿™ç§æ–¹å¼æ¥æ‰§è¡Œ SQL çš„ï¼ŒMyBatisæä¾›äº† mapper è¿™ç§<code>ä¼˜é›…ä¸”æ˜“ç»´æŠ¤</code>çš„æ–¹å¼æ¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å»ä½¿ç”¨ SQLã€‚</p>
<h2 id="å®šä¹‰">å®šä¹‰</h2>
<blockquote>
<p>mapper æ˜¯ Java æ–¹æ³•å’Œ SQL è¯­å¥ä¹‹é—´çš„<code>æ¡¥æ¢</code>ã€‚</p>
</blockquote>
<p>Java æ¥å£æ–¹æ³•ä¸ SQL è¯­å¥ä»¥åŠ mapper ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s2.loli.net/2021/12/25/3fQxWmEFtY5lM16.png"
	
	
	
	loading="lazy"
	
		alt="å›¾ç‰‡æè¿°"
	
	
></p>
<h2 id="æ–°å»º-mapper">æ–°å»º mapper</h2>
<p>mapper åªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„<code>æ¦‚å¿µ</code>ï¼Œå®ƒå…¶å®å°±æ˜¯ Java é‡Œé¢çš„ä¸€ä¸ªæ¥å£ç±»ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç°è¿™ä¸ªæ¥å£ç±»ï¼ŒMyBatis ä¼šé€šè¿‡åŠ¨æ€ä»£ç†è‡ªåŠ¨å¸®æˆ‘ä»¬æ‰§è¡Œæ¥å£æ–¹æ³•æ‰€å¯¹åº”çš„ SQL è¯­å¥ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥<code>UserMapper</code>ä¸ºä¾‹ï¼Œæ¥çœ‹ä¸€çœ‹ mapper ç©¶ç«Ÿæ˜¯å¦‚ä½•å®šä¹‰å’Œç»„æˆçš„ã€‚</p>
<p>é¦–å…ˆï¼Œåœ¨ com.ahao.mybatis åŒ…ä¸‹æ–°å»º <code>mapper</code>åŒ…ï¼Œå¹¶åœ¨ mapper åŒ…ä¸‹æ–°å»ºæ¥å£ç±»<code>UserMapper.java</code>ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>MyBatis æä¾›äº†<code>æ³¨è§£</code>å’Œ<code>XML</code>ä¸¤ç§æ–¹å¼æ¥è¿æ¥æ¥å£æ–¹æ³•å’Œ SQL è¯­å¥ã€‚</p>
<h3 id="æ³¨è§£æ–¹å¼">æ³¨è§£æ–¹å¼</h3>
<p>æˆ‘ä»¬ä¸º UserMapper æ·»åŠ ä¸€ä¸ªæ–¹æ³•<code>selectUsernameById</code>ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨ä¸º<strong>é€šè¿‡ç”¨æˆ· id æŸ¥è¯¢ç”¨æˆ·åç§°</strong>ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">String</span> <span class="nf">selectUsernameById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>selectUsernameById æ–¹æ³•æ¥å— id å‚æ•°ï¼ˆç”¨æˆ· idï¼‰ï¼Œè¿”å›ç”¨æˆ·åç§°ï¼ˆString ç±»å‹ï¼‰ã€‚</p>
<p>æœ‰äº†æ–¹æ³•å®šä¹‰åï¼Œæˆ‘ä»¬å†é€šè¿‡æ³¨è§£ä¸ºè¯¥æ–¹æ³•æ·»åŠ ä¸Šå¯¹åº”çš„ SQL è¯­å¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;SELECT username FROM user WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">String</span> <span class="nf">selectUsernameById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Select</code>æ³¨è§£å¯¹åº” SQL çš„ select æŸ¥è¯¢ï¼Œæ³¨è§£ä¸­çš„è¯­å¥å°±æ˜¯ç›¸åº”çš„ SQL è¯­å¥ï¼Œå½“ç„¶è¿™å¹¶éçœŸå®çš„ SQL è¯­å¥ï¼Œå…·ä½“çš„å·®å¼‚æ€§æˆ‘ä»¬åç»­ç« èŠ‚å†è¯´ã€‚</p>
<h3 id="xml-æ–¹å¼">XML æ–¹å¼</h3>
<p>XML æ–¹å¼æ˜¯æ›´åŠ å¼ºå¤§å’Œæ˜“ç”¨çš„ä¸€ç§æ–¹å¼ï¼Œè™½ç„¶å®ƒæ²¡æœ‰æ³¨è§£é‚£ä¹ˆæ–¹ä¾¿ï¼Œä½†æ˜¯åŠŸèƒ½æ›´å¼ºã€æ›´æ˜“ç»´æŠ¤ï¼Œæ˜¯ MyBatis å®˜æ–¹æ¨èçš„ä¸€ç§æ–¹å¼ã€‚</p>
<p>åœ¨ mapper åŒ…ä¸­ï¼Œæˆ‘ä»¬æ–°å»ºå¦ä¸€ä¸ªæ–‡ä»¶<code>UserMapper.xml</code>ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE mapper
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.ahao.mybatis.mapper.UserMapper&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>mapper</code> æ ‡ç­¾å¯¹åº”ä¸€ä¸ª mapper æ¥å£ç±»ï¼Œè¿™é‡Œåº”è¯¥å¯¹åº” UserMapperï¼Œæ‰€ä»¥åœ¨ mapper æ ‡ç­¾é‡Œé¢æˆ‘ä»¬è¿˜éœ€è¦åŠ ä¸Š namespace è¿™ä¸ªå±æ€§ï¼Œå®ƒçš„å€¼ä¸º UserMapper çš„ç±»å…¨è·¯å¾„ï¼Œè¿™æ · UserMapper.xml é…ç½®æ–‡ä»¶å°±ä¸ UserMapper.java å¯¹åº”èµ·æ¥äº†ã€‚</p>
<p><strong>æç¤º</strong>ï¼Œ<strong>namespace å‘½åç©ºé—´æ˜¯æ¯ä¸€ä¸ª mapper æ–‡ä»¶æ‰€ç‹¬æœ‰çš„ï¼Œå®ƒå”¯ä¸€æ ‡è¯†ç€ä¸€ä¸ª mapper</strong>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong> åœ¨è¿™é‡Œï¼Œ.xml é…ç½®æ–‡ä»¶å¿…é¡»ä¸å…¶å¯¹åº”çš„æ¥å£åœ¨åŒä¸€ä¸ªåŒ…å†…ã€‚</p>
</blockquote>
<p>äºŒè€…åœ¨ç›®å½•ä¸­çš„ä½ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">src/main/java/com/ahao/mybatis/mapper
</span></span><span class="line"><span class="cl">â”œâ”€â”€ UserMapper.java
</span></span><span class="line"><span class="cl">â””â”€â”€ UserMapper.xml
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ UserMapper æ¥å£ä¸­ï¼Œæˆ‘ä»¬å†æ–°å¢ä¸€ä¸ªæ–¹æ³•<code>selectUserAgeById</code>ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯<strong>é€šè¿‡ç”¨æˆ· id æŸ¥è¯¢ç”¨æˆ·å¹´é¾„</strong>ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;SELECT username FROM user WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">String</span> <span class="nf">selectUsernameById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Integer</span> <span class="nf">selectUserAgeById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ä¹‹å¯¹åº”çš„ xml æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ·»åŠ ä¸Šå¯¹åº”çš„ SQL è¯­å¥ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE mapper
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.ahao.mybatis.mapper.UserMapper&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserAgeById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;java.lang.Integer&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    SELECT age FROM user WHERE id = #{id}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/select&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ mapper æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬æ–°å¢äº† select æ ‡ç­¾ï¼Œå¯¹åº” SQL ä¸­çš„ select æŸ¥è¯¢ï¼›select æ ‡ç­¾ä¸­æœ‰ä¸¤ä¸ªå¿…å¡«å±æ€§ï¼Œç¬¬ä¸€ä¸ªæ˜¯ id ï¼Œå®ƒå¯¹åº”æ¥å£çš„æ–¹æ³•åï¼Œå³ selectUserAgeByIdï¼Œé€šè¿‡å®ƒ MyBatis æ‰èƒ½å°†äºŒè€…å¯¹åº”èµ·æ¥ï¼Œç¬¬äºŒä¸ªæ˜¯ resultTypeï¼Œå®ƒå¯¹åº” SQL è¯­å¥çš„è¿”å›ç±»å‹ï¼Œä¸æ¥å£æ–¹æ³•çš„è¿”å›å€¼ç›¸åŒï¼Œä¸º Integer ç±»å‹ã€‚</p>
<p>å¥½äº†ï¼Œæ³¨è§£å’Œ XML çš„ä¸¤ç§æ–¹å¼çš„ç®€å•ä½¿ç”¨å·²ç»ä»‹ç»å®Œæ¯•äº†ï¼Œè¿™é‡Œä»ç„¶æœ‰ä¸€ä¸ªå¯ä»¥å®Œå–„çš„ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º UserMapper ç±»æ‰“ä¸Šä¸€ä¸ª <code>Mapper</code>æ³¨è§£ï¼Œè™½ç„¶è¿™ä¸ªæ³¨è§£å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯å¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// çœç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// çœç•¥å…¶å®ƒè¯¸å¤šä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä½¿ç”¨-mapper">ä½¿ç”¨ mapper</h2>
<p>mapper å®šä¹‰å¥½ä»¥åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šä»‹ç»å¦‚ä½•ä½¿ç”¨å®ƒã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† MyBatis é…ç½®å¼çš„ç®€å•ä½¿ç”¨ï¼Œé‚£ä¹ˆä½¿ç”¨ mapper å…¶å®å¾ˆç®€å•ï¼Œåªéœ€åœ¨é…ç½®å¼ä½¿ç”¨çš„åŸºç¡€ä¸Šå¢åŠ å‡ å¤„é…ç½®å’Œä»£ç å°±è¡Œäº†ã€‚</p>
<h3 id="mapper-é…ç½®">mapper é…ç½®</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ mybatis-config.xml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„ mapper é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatisdemo?useSSL=false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!--  mapper å¯¹åº”çš„é…ç½®  --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.ahao.mybatis.mapper.UserMapper&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/mappers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œmapper å¯ä»¥æœ‰å¤šä¸ªï¼Œå¯¹åº”çš„æ ‡ç­¾é¡¹åº”æ˜¯ mappersï¼Œåœ¨ mappers ä¸‹é¢æ‰æœ‰ä¸€ä¸ªä¸ªçš„ mapperï¼Œå¦‚ä¸Šé¢çš„ UserMapperï¼›é€šè¿‡mapper æ ‡ç­¾ä¸­çš„ class å±æ€§ï¼Œæˆ‘ä»¬æŒ‡å®šå…¶å¯¹åº”çš„æ¥å£ç±»ï¼Œclass å±æ€§å€¼ä¸º UserMapper çš„ç±»å…¨è·¯å¾„ã€‚</p>
<h3 id="ä»£ç è°ƒç”¨">ä»£ç è°ƒç”¨</h3>
<p>æœ‰äº†é…ç½®ä»¥åï¼Œæˆ‘ä»¬åˆ™å¯ä»¥åœ¨ä»£ç ä¸­è°ƒç”¨ mapper æ–¹æ³•ä»è€Œæ‰§è¡Œ SQL å¾—åˆ°ç»“æœäº†ã€‚åœ¨ pattern åŒ…ä¸‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåä¸º<code>StartWithMapper.java</code>ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.pattern</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.mapper.UserMapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">&#34;Duplicates&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StartWithMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">SQLException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å¾—åˆ° mapper
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// è°ƒç”¨æ³¨è§£çš„SQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectUsernameById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;username: &#34;</span> <span class="o">+</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// è°ƒç”¨XMLçš„SQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Integer</span> <span class="n">age</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectUserAgeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;age: &#34;</span> <span class="o">+</span> <span class="n">age</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å…³é—­ä¼šè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨æµç¨‹æˆ‘ä»¬å·²ç»å†™åœ¨äº†ä»£ç æ³¨é‡Šä¸­äº†ï¼Œè¯·åŠ¡å¿…é˜…è¯»ä¸€ä¸‹ã€‚</p>
<p>ä¸ä¸Šä¸€èŠ‚çš„åŒºåˆ«åœ¨äºï¼Œæˆ‘ä»¬ä¸å†é€šè¿‡ session å¾—åˆ°è¿æ¥ä»è€Œæ‰§è¡Œ SQL äº†ï¼Œè€Œæ˜¯åœ¨ session ä¸­å¾—åˆ°é…ç½®å¥½çš„ UserMapperï¼Œå†é€šè¿‡è°ƒç”¨UserMapper çš„æ–¹æ³•æ‰§è¡Œ SQL ä»è€Œå¾—åˆ°ç»“æœã€‚</p>
<p>æ‰§è¡Œè¿™æ®µä»£ç ï¼Œå®ƒä¼šåœ¨æ§åˆ¶å°ä¸Šæ‰“å°å¦‚ä¸‹ä¿¡æ¯ï¼ˆæˆªå–äº†éƒ¨åˆ†é‡è¦ä¿¡æ¯ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">13:13:50.104 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUsernameById - ==&gt;  Preparing: SELECT username FROM user WHERE id = ? 
</span></span><span class="line"><span class="cl">13:13:50.205 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUsernameById - ==&gt; Parameters: 1(Integer)
</span></span><span class="line"><span class="cl">13:13:50.344 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUsernameById - &lt;==      Total: 1
</span></span><span class="line"><span class="cl">username: peter
</span></span><span class="line"><span class="cl">13:13:50.351 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUserAgeById - ==&gt;  Preparing: SELECT age FROM user WHERE id = ? 
</span></span><span class="line"><span class="cl">13:13:50.351 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUserAgeById - ==&gt; Parameters: 1(Integer)
</span></span><span class="line"><span class="cl">13:13:50.354 [main] DEBUG com.ahao.mybatis.mapper.UserMapper.selectUserAgeById - &lt;==      Total: 1
</span></span><span class="line"><span class="cl">age: 18
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>ä»ç¨‹åºè¾“å‡ºçš„ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼ŒUserMapper çš„è°ƒç”¨éƒ½æˆåŠŸäº†ï¼Œ ç»“åˆä¸Šä¸€å°èŠ‚ä¸­ JDBC çš„ä½¿ç”¨ï¼Œå¯ä»¥æ¸…æ™°åœ°æ„Ÿå—åˆ° MyBatis å®Œç¾çš„å°† Java å¯¹è±¡ä¸ SQL è¯­å¥åˆ†ç¦»ï¼Œå¹¶é€šè¿‡ mapper å……å½“äºŒè€…çš„æ¡¥æ¢ï¼Œæå¤§çš„æå‡äº†ä»£ç å’Œ SQL è¯­å¥çš„ç»´æŠ¤æ€§ã€‚</p>
<p>ä¸åŒäºåŸç”Ÿ JDBC çš„ä½¿ç”¨æ–¹å¼ï¼ŒMyBatis ä¼šè‡ªåŠ¨çš„é€šè¿‡ resultType ç­‰é…ç½®æ¥å¸®æˆ‘ä»¬å®ç°æ•°æ®åº“ç±»å‹åˆ° Java ç±»å‹çš„è½¬æ¢ï¼Œå¸®æˆ‘ä»¬èŠ‚çœäº†å¤§é‡çš„å·¥ä½œï¼Œå½“ç„¶ MyBatis çš„åŠŸèƒ½è¿œä¸æ­¢å¦‚æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨åç»­çš„å°èŠ‚ä¸­ä¸€ä¸€æ­æ™“ã€‚</p>
<h2 id="å°ç»“-2">å°ç»“</h2>
<ul>
<li>mapper æ˜¯ MyBatis çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ˜¯ MyBatis <code>è§£è€¦</code> Java å¯¹è±¡ä¸ SQL è¯­å¥çš„æ¡¥æ¢ã€‚</li>
<li>MyBatis å®˜æ–¹æ–‡æ¡£ä¸­æ˜ç¡®<code>å¼ºè°ƒ</code>æ³¨è§£æ–¹å¼ SQL æ— æ³•å‘æŒ¥ MyBatis çš„å…¨éƒ¨åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥æ–¹ä¾¿åœ°æ¼”ç¤ºä¸€äº› demoã€‚</li>
<li>å¦‚æœå•ç‹¬ä½¿ç”¨ MyBatisï¼Œé‚£ä¹ˆ mapper æ¥å£å¿…é¡»å’Œ .xml é…ç½®æ–‡ä»¶åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ spring ç­‰å·¥å…·å°±å¯ä»¥ä¸å¿…å—æ­¤é™åˆ¶ã€‚</li>
</ul>
<h1 id="mybatis-select">MyBatis select</h1>
<h2 id="å‰è¨€-3">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis selectã€‚</p>
<p>åœ¨ MyBatis ä¸­ï¼Œselect æ ‡ç­¾å¯¹åº”äº SQL è¯­å¥ä¸­çš„ select æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¼šåœ¨ select æ ‡ç­¾ä¸­å¡«å…… SQL æŸ¥è¯¢è¯­å¥ï¼Œç„¶ååœ¨ä»£ç ä¸­é€šè¿‡å¯¹åº”æ¥å£æ–¹æ³•æ¥è°ƒç”¨ã€‚</p>
<h2 id="å®šä¹‰-1">å®šä¹‰</h2>
<blockquote>
<p>select æ ‡ç­¾ç”¨äºæ˜ å°„ SQL ä¸­çš„<code>æŸ¥è¯¢</code>è¯­å¥</p>
</blockquote>
<h2 id="å®ä¾‹">å®ä¾‹</h2>
<p>MyBatis select å¯åˆ†ä¸º<code>xml</code>å’Œ<code>æ³¨è§£</code>ä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚</p>
<h3 id="xml-å®ä¾‹">xml å®ä¾‹</h3>
<p>å°† select æŸ¥è¯¢å†™åœ¨ mapper.xml æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE mapper
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.ahao.mybatis.mapper.UserMapper&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserAgeById&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;java.lang.Integer&#34;</span> <span class="na">resultType=</span><span class="s">&#34;java.lang.Integer&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    SELECT age FROM user WHERE id = #{id}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/select&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­åä¸º selectUserAgeById çš„ select æ ‡ç­¾(ä¸€èˆ¬ä»¥ id åšä¸ºåç§°)ï¼Œæ¥æ”¶ Integer ç±»å‹çš„å‚æ•°ï¼ˆparameterTypeï¼‰ï¼Œå¹¶è¿”å› Integer ç±»å‹çš„ç»“æœï¼ˆresultTypeï¼‰ï¼›å†çœ‹ select æ ‡ç­¾ä¸­çš„æŸ¥è¯¢è¯­å¥ï¼Œæ¥æ”¶ id å‚æ•°ï¼Œç±»å‹ä¸º intï¼Œè¿”å› ageï¼Œç±»å‹ä¸º intï¼ŒäºŒè€…ä¸€ä¸€å¯¹åº”ã€‚</p>
<h3 id="å‚æ•°ç¬¦å·">å‚æ•°ç¬¦å·</h3>
<p>æ³¨æ„ï¼Œåœ¨ select æ ‡ç­¾ä¸­çš„ SQL è¯­å¥å‡ ä¹ä¸çœŸå®çš„ SQL è¯­å¥ä¸€è‡´ï¼Œä½†å®ƒçš„å‚æ•°ç¬¦å·ç¨æœ‰ä¸åŒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#{id}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è‹¥ä»¥ <code>#{}</code>ä½œä¸ºå‚æ•°ç¬¦å·ï¼ŒMyBatis åˆ™ä¼šåˆ›å»ºä¸€ä¸ªé¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰ï¼Œå®ƒä¼šè¢«å¤„ç†æˆ<code>?</code>ã€‚å¦‚æœä½ ä¸å¸Œæœ›ä½¿ç”¨é¢„å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>${}</code>å‚æ•°ç¬¦å·ï¼ŒMyBatis ä¼šå°†å…¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿›è¡Œæ‹¼æ¥ï¼Œä¸è¿‡æˆ‘ä»¬æ¨èä½ ä½¿ç”¨ <code>#{}</code>ï¼Œå‡ ä¹æ‰€æœ‰äººä¹Ÿéƒ½è¿™æ ·åšã€‚</p>
<h3 id="æ³¨è§£å®ä¾‹">æ³¨è§£å®ä¾‹</h3>
<p>å°† SQL è¯­å¥å†™åœ¨æ³¨è§£ä¸­ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;SELECT username FROM user WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">String</span> <span class="nf">selectUsernameById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨è§£ä¸­çš„ select è¯­å¥æ— éœ€å†æ·»åŠ  idã€parameterType ç­‰å±æ€§ï¼Œåªéœ€å†™ä¸Šå¯¹åº”çš„ SQL è¯­å¥ï¼ŒMyBatis ä¼šè‡ªåŠ¨æ ¹æ®å…¶ä¿®é¥°çš„æ–¹æ³•æ¥æ¨æ–­å‡ºè¿™äº›å‚æ•°ã€‚</p>
<blockquote>
<p><strong>TIPSï¼š</strong> ä½¿ç”¨æ³¨è§£æ¥ä¹¦å†™ MyBatis ç›¸å¯¹ä¼šæ–¹ä¾¿ä¸€äº›ï¼Œä½†æ˜¯æ³¨è§£æ— æ³•å‘æŒ¥ MyBatis åŠ¨æ€ SQL çœŸæ­£çš„å¨åŠ›ï¼Œå› æ­¤å¤§éƒ¨åˆ†äººéƒ½è¿˜æ˜¯ä¼šé€‰æ‹© xml çš„æ–¹å¼æ¥ä¹¦å†™ SQLï¼Œä½†æ˜¯å¯¹äºä¸€äº› demo çš„å±•ç¤ºï¼Œæ³¨è§£æ— ç–‘å®¹æ˜“ä¸Šæ‰‹ä¸€äº›ã€‚åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šä»‹ç»åˆ°æ³¨è§£çš„ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨å®è·µä¸­æˆ‘ä»¬é»˜è®¤ä½¿ç”¨ xml æ–¹å¼ã€‚</p>
</blockquote>
<h2 id="select-å±æ€§">select å±æ€§</h2>
<p>select æ ‡ç­¾æ”¯æŒå¾ˆå¤šå±æ€§æ¥æ”¹å˜æŸ¥è¯¢è¯­å¥çš„è¡Œä¸ºã€‚</p>
<p>æˆ‘ä»¬æ‘˜å–å…¶ä¸­å¸¸è§ä¸”é‡è¦çš„å±æ€§ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">åœ¨å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">parameterType</td>
<td style="text-align:left">è¯­å¥çš„å‚æ•°ç±»å‹ï¼Œé»˜è®¤å¯é€‰ï¼ŒMyBatis ä¼šè‡ªåŠ¨æ¨æ–­</td>
</tr>
<tr>
<td style="text-align:left">resultType</td>
<td style="text-align:left">è¯­å¥è¿”å›å€¼ç±»å‹ï¼Œå¦‚æœè¿”å›çš„æ˜¯é›†åˆï¼Œé‚£åº”è¯¥è®¾ç½®ä¸ºé›†åˆåŒ…å«çš„ç±»å‹</td>
</tr>
<tr>
<td style="text-align:left">resultMap</td>
<td style="text-align:left">è¯­å¥è¿”å›æ˜ å°„çš„ idï¼›å¯ä»¥ä½¿ç”¨ resultType æˆ– resultMapï¼Œä½†ä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td style="text-align:left">flushCache</td>
<td style="text-align:left">è®¾ç½®ä¸º true åï¼Œåªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¢«æ¸…ç©ºï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td style="text-align:left">useCache</td>
<td style="text-align:left">è®¾ç½®ä¸º true åï¼Œæœ¬æ¡è¯­å¥çš„æŸ¥è¯¢ç»“æœè¢«äºŒçº§ç¼“å­˜ç¼“å­˜èµ·æ¥ï¼Œé»˜è®¤ select æ ‡ç­¾ä¸º trueã€‚</td>
</tr>
<tr>
<td style="text-align:left">timeout</td>
<td style="text-align:left">è®¾ç½®è¶…æ—¶æ—¶é—´</td>
</tr>
<tr>
<td style="text-align:left">fetchSize</td>
<td style="text-align:left">è®¾ç½®é¢„æœŸè¿”å›çš„è®°å½•æ•°é‡</td>
</tr>
<tr>
<td style="text-align:left">statementType</td>
<td style="text-align:left">STATEMENTï¼ŒPREPARED æˆ– CALLABLE ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤ä¸º PREPAREDï¼ˆé¢„å¤„ç†ï¼‰</td>
</tr>
</tbody>
</table></div>
<h2 id="å‚æ•°">å‚æ•°</h2>
<p>åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†<code>#{id}</code>å‚æ•°ï¼Œè¿™æ˜¯å‚æ•°çš„æœ€ç®€å•æƒ…å†µï¼Œå¯¹äºå¤æ‚æƒ…å†µï¼Œå‚æ•°è¿˜æœ‰å…¶å®ƒæ›´å¤šçš„å¦™ç”¨ã€‚</p>
<h3 id="å¯¹è±¡å‚æ•°">å¯¹è±¡å‚æ•°</h3>
<p>æœ‰æ—¶å€™ï¼Œå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå¦‚ Java ä¸­çš„ä¸€ä¸ª User ç±»ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM user WHERE age = #{age} AND score = #{score}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>selectUserByAgeAndScore æŸ¥è¯¢çš„å‚æ•°æ˜¯ä¸€ä¸ªå¤æ‚ Java å¯¹è±¡ Userï¼Œå½“ User ä½œä¸ºå‚æ•°å¯¹è±¡æ—¶ï¼ŒUser ä¸­çš„å±æ€§éƒ½å¯ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„å‚æ•°ï¼Œå¦‚ age å’Œ scoreã€‚</p>
<h3 id="å‚æ•°é…ç½®">å‚æ•°é…ç½®</h3>
<p><code>#{}</code>ä¸ä»…å¯ä»¥ä¼ å…¥å‚æ•°åç§°ï¼Œè¿˜å¯ä»¥ä¼ å…¥å‚æ•°ç±»å‹å’Œç±»å‹å¤„ç†å™¨ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#{age,javaType=int,jdbcType=int,typeHandler=IntegerTypeHandler}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­ javaType è¡¨ç¤º age çš„ Java ç±»å‹ï¼ŒjdbcType è¡¨ç¤º age çš„æ•°æ®åº“ç±»å‹ï¼ŒtypeHandler è¡¨ç¤º age çš„ç±»å‹å¤„ç†å™¨ï¼Œå…³äºç±»å‹å¤„ç†å™¨æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä»‹ç»ã€‚</p>
<p>å¯¹äºå‚æ•°é…ç½®ï¼Œ90% çš„æƒ…å†µä½ éƒ½åªéœ€è¦ä¼ å…¥å‚æ•°åå³å¯ï¼Œå› ä¸º MyBatis éƒ½ä¼šè‡ªåŠ¨æ¨æ–­å‡ºé…ç½®ã€‚</p>
<h2 id="å®è·µ">å®è·µ</h2>
<p>ä»‹ç»äº†è¿™ä¹ˆå¤šæ¦‚å¿µï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®æ“å·©å›ºä¸€ä¸‹ã€‚</p>
<h3 id="ä¾‹1-é€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. é€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆåœ¨ user è¡¨ä¸­é€šè¿‡<code>å¹´é¾„</code>å’Œ<code>åˆ†æ•°</code>æŸ¥è¯¢ç”¨æˆ·çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨å¯¹åº” UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ é€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·çš„ select æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ com.ahao.mybatis åŒ…ä¸‹æ–°å»º model åŒ…ï¼Œç”¨äºä¿å­˜æ•°æ®åº“å¯¹è±¡ï¼Œå¹¶åœ¨ model åŒ…ä¸‹æ–°å»º User.java ç±»ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.model</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">score</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// çœç•¥äº† getter å’Œ setter æ–¹æ³•ï¼Œè¯·åŠ¡å¿…é€šè¿‡ IDE ç”Ÿæˆï¼Œå¦åˆ™ MyBatis æ— æ³•è‡ªåŠ¨æ˜ å°„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ UserMapper.xml æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ–°å¢ selectUserByAgeAndScore æ ‡ç­¾ï¼Œè¯¥ select æ ‡ç­¾çš„ä½œç”¨æ˜¯ï¼šé€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM user WHERE age = #{age} AND score = #{score}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java æ¥å£ä¸­ï¼Œæˆ‘ä»¬æ–°å¢å¯¹åº”çš„æ–¹æ³•ï¼Œæ–¹æ³•æ¥æ”¶å¤æ‚å‚æ•° Userï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">User</span> <span class="nf">selectUserByAgeAndScore</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUserByAgeAndScore æ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.pattern</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.entity.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.mapper.UserMapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">&#34;Duplicates&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">SQLException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¾—åˆ° mapper
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">User</span> <span class="n">condition</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">condition</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">18</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">condition</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è°ƒç”¨æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserByAgeAndScore</span><span class="o">(</span><span class="n">condition</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¾—åˆ° user
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">User{id=1, username=&#39;peter&#39;, age=18, score=100}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-3">å°ç»“</h2>
<ul>
<li>MyBatis è™½ç„¶æä¾›äº† <code>#{}</code>å’Œ<code>${}</code>ä¸¤ç§æ–¹å¼æ¥ä¼ é€’å‚æ•°ï¼Œä½†æ— ç–‘<code>#{}</code>æ›´åŠ å®ç”¨ã€‚</li>
<li>select æ ‡ç­¾å±æ€§è™½ç„¶å¤šï¼Œä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½ä¸ä¼šé’ˆå¯¹æŸä¸€ä¸ª select æ ‡ç­¾æ¥å®šåˆ¶åŒ–ï¼Œå¤šä¼šåœ¨å…¨å±€é‡Œè¿›è¡Œé…ç½®ã€‚</li>
<li>äº’è”ç½‘çš„åº”ç”¨åœºæ™¯å¤šæ•°ä¸ºè¯»å¤šå†™å°‘ï¼Œé‚£ä¹ˆ select è‚¯å®šæ˜¯ä½¿ç”¨<code>æœ€ä¸ºå¹¿æ³›</code>çš„æ ‡ç­¾äº†ã€‚</li>
</ul>
<h1 id="mybatis-resultmap-ä¸-sql">MyBatis resultMap ä¸ sql</h1>
<h2 id="å‰è¨€-4">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis resultMap å’Œ sqlã€‚</p>
<p>åœ¨å‰é¢çš„å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ° MyBatis å¯ä»¥è‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬æ˜ å°„æ•°æ®åº“æ•°æ®å’Œ Java å¯¹è±¡ï¼Œå…¶å®è¿™æ˜¯ MyBatis åœ¨å¹•åå¸®æˆ‘ä»¬åˆ›å»ºäº† resultMap å¯¹è±¡ï¼›è™½ç„¶ MyBatis å¯ä»¥è‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬åšæ•°æ®æ˜ å°„ï¼Œä½†æ˜¯å¯¹äºå¤æ‚çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¿…é¡»è‡ªå®šä¹‰ resultMap äº†ã€‚</p>
<p>è€Œåœ¨ä¹¦å†™ SQL æ—¶ï¼ŒåŠ¿å¿…ä¼šæœ‰ä¸€äº› SQL ä»£ç æ®µå‡ºç°äº†é‡å¤ï¼Œä¸ºäº†æ›´å¥½çš„å¤ç”¨å®ƒä»¬ï¼ŒMyBatis æä¾›äº† sql æ ‡ç­¾ã€‚</p>
<h2 id="å®šä¹‰-2">å®šä¹‰</h2>
<blockquote>
<p>resultMap æ ‡ç­¾ç”¨äºå°†æ•°æ®åº“æ•°æ®<code>æ˜ å°„</code>ä¸º Java å¯¹è±¡ï¼›sql æ ‡ç­¾åˆ™ç”¨æ¥å®šä¹‰<code>å¯é‡ç”¨</code>çš„ SQL ä»£ç æ®µã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-1">å®ä¾‹</h2>
<h3 id="resultmap-å®ä¾‹">resultMap å®ä¾‹</h3>
<h4 id="xml-å®ä¾‹-1">xml å®ä¾‹</h4>
<p>åœ¨ä¸‹é¢è¿™æ®µ select æ ‡ç­¾ä¸­ï¼ŒSQL è¯­å¥è¿”å›çš„æ˜¯ä¸€ä¸ªå¤æ‚å¯¹è±¡ï¼Œå³ resultType ä¸ŠæŒ‡å®šçš„ Userã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM user WHERE age = #{age} AND score = #{score}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMyBatis ä¼šè‡ªåŠ¨åˆ›å»º resultMap å¯¹è±¡è¿›è¡Œæ•°æ®çš„æ˜ å°„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç›´æ¥å®šä¹‰å‡º resultMapï¼Œé¿å… MyBatis æ¨æ–­å’Œæ˜ å°„å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;userMap&#34;</span> <span class="na">type=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;username&#34;</span> <span class="na">column=</span><span class="s">&#34;username&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;age&#34;</span> <span class="na">column=</span><span class="s">&#34;age&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;score&#34;</span> <span class="na">column=</span><span class="s">&#34;score&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/resultMap&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultMap=</span><span class="s">&#34;userMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM user WHERE age = #{age} AND score = #{score}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å®šä¹‰äº†åä¸º userMap çš„ resultMap ä¸”æŒ‡å®šå…¶å¯¹åº”çš„ Java ç±»å‹ä¸º Userï¼Œåœ¨æ ‡ç­¾çš„å†…éƒ¨ï¼Œæˆ‘ä»¬è¿˜éœ€æŒ‡å®šå­—æ®µä¹‹é—´çš„æ˜ å°„ï¼Œé™¤ id è¿™ä¸ªç‰¹æ®Šçš„å­—æ®µå¤–ï¼Œå…¶å®ƒå­—æ®µå‡ä½¿ç”¨ result æ ‡ç­¾æ¥æ˜ å°„ã€‚</p>
<p>å…¶ä¸­ property æ˜¯ Java å¯¹è±¡ä¸­çš„å­—æ®µåç§°ï¼Œcolumn æ˜¯æ•°æ®è¡¨ä¸ä¹‹å¯¹åº”çš„å­—æ®µåç§°ã€‚</p>
<p>resultMap å®šä¹‰å®Œæ¯•åï¼Œæˆ‘ä»¬åœ¨ select æ ‡ç­¾ä¸­é€šè¿‡ resultMap å±æ€§æ¥è®¾ç½®å¯¹åº”çš„ idã€‚</p>
<blockquote>
<p><strong>TIPSï¼š</strong> æ³¨æ„ï¼Œ resultMap å’Œ resultType ä¸èƒ½å…±å­˜ï¼Œåªèƒ½äºŒé€‰ä¸€ã€‚</p>
</blockquote>
<p>è¿™æ ·ï¼Œä¸€æ¬¡ç®€å•çš„ resultMap ä½¿ç”¨å°±å®Œæ¯•äº†ã€‚</p>
<h4 id="æ³¨è§£å®ä¾‹-1">æ³¨è§£å®ä¾‹</h4>
<p>é€šè¿‡æ³¨è§£ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®š Java æ¨¡å‹å¯¹è±¡ä¸æ•°æ®åº“å­—æ®µä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">id</span> <span class="o">=</span> <span class="kc">true</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;username&#34;</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;username&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;age&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;score&#34;</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;score&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;SELECT * FROM user WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="nf">selectUserById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Results æ³¨è§£ä¸ resultMap å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ª Result æ³¨è§£ï¼Œæ¯ä¸ª Result æ³¨è§£å¯¹åº”äº†ä¸€ä¸ªå­—æ®µæ˜ å°„å…³ç³»ã€‚</p>
<blockquote>
<p><strong>æç¤ºï¼š</strong> Results æ³¨è§£ä»¥åŠ ResultMap æ³¨è§£è™½ç„¶å­˜åœ¨ï¼Œä½†æ˜¯å¾ˆå°‘åœ¨å®é™…çš„å¼€å‘ä¸­ä½¿ç”¨ï¼Œåªéœ€äº†è§£å³å¯ã€‚</p>
</blockquote>
<h3 id="sql-å®ä¾‹">SQL å®ä¾‹</h3>
<p>æˆ‘ä»¬å°†ç›®å…‰æ”¾åˆ° selectUserByAgeAndScore è¯­å¥çš„å†…éƒ¨ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­åƒ<code>SELECT * FROM user</code>è¿™æ ·çš„ä»£ç æ®µå…¶å®éå¸¸å¸¸è§ï¼Œä¼šåœ¨å¤šä¸ª select æ ‡ç­¾ä¸­ç”¨åˆ°å®ƒã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶å®šä¹‰ä¸ºä¸€ä¸ª sql æ ‡ç­¾ï¼Œè¿™æ ·æ‰€æœ‰çš„ select æ ‡ç­¾éƒ½å¯ä»¥å¿«é€Ÿå¤ç”¨åˆ°è¿™æ®µä»£ç ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;selectUser&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM user
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/sql&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºè¿™ä¸ªä»£ç æ®µå®šä¹‰ä¸€ä¸ªå”¯ä¸€çš„ idï¼Œå®šä¹‰å¥½åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶å®ƒæ ‡ç­¾ä¸­ä½¿ç”¨äº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultMap=</span><span class="s">&#34;userMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;selectUser&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  WHERE age = #{age} AND score = #{score}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€ä¸ª include æ ‡ç­¾æ¥å°† SQL æ ‡ç­¾åŒ…å«è¿›æ¥ï¼Œå¹¶ä¸” refid å±æ€§å¿…é¡»æ˜¯è¯¥ SQL æ ‡ç­¾çš„ id å€¼ã€‚è¿™æ ·è¿™æ®µä»£ç ä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p>
<p>SQL æ ‡ç­¾æ²¡æœ‰å¯¹åº”æ³¨è§£ï¼Œ<code>åªèƒ½</code>åœ¨ xml ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="å®è·µ-1">å®è·µ</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®æ“å·©å›ºä¸€ä¸‹ã€‚</p>
<h3 id="ä¾‹1-æŸ¥è¯¢ç”¨æˆ·å§“åå’Œå¹´é¾„">ä¾‹1. æŸ¥è¯¢ç”¨æˆ·å§“åå’Œå¹´é¾„</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆåœ¨ user è¡¨ä¸­æŸ¥è¯¢ç”¨æˆ·ç®€ç•¥ä¿¡æ¯çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>å¾ˆå¤šåº”ç”¨éƒ½ä¼šæœ‰æŸ¥è¯¢ç”¨æˆ·ç®€ç•¥ä¿¡æ¯è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œæ¯”å¦‚æˆ‘ä»¬åªéœ€è·å–ç”¨æˆ·åå’Œå¹´é¾„ï¼Œè¿ç”¨æœ¬å°èŠ‚çš„çŸ¥è¯†æˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°å®ƒã€‚</p>
<p>å…ˆåœ¨å¯¹åº” UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ æŸ¥è¯¢ç”¨æˆ·ç®€ç•¥ä¿¡æ¯çš„ select æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªç”¨æˆ·ç®€ç•¥ä¿¡æ¯çš„æ¨¡å‹ UserShortCut.javaï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.model</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserShortCut</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// çœç•¥äº†é‡è¦çš„ getter å’Œ setter æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¹¶åœ¨ UserMapper.xml æ·»åŠ ä¸Š resultMap ã€sql å’Œ select æ ‡ç­¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!--  å¤ç”¨çš„ sql ä»£ç æ®µ   --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;selectUserShortcutMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT username,age FROM user
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/sql&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--  ç»“æœæ˜ å°„é›†   --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;userShortcutMap&#34;</span> <span class="na">type=</span><span class="s">&#34;com.ahao.mybatis.model.UserShortCut&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;username&#34;</span> <span class="na">column=</span><span class="s">&#34;username&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;age&#34;</span> <span class="na">column=</span><span class="s">&#34;age&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/resultMap&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--  æŸ¥è¯¢è¯­å¥   --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserShortcutById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;userShortcutMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;selectUserShortcutMap&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥ï¼Œç»™ UserMapper.java æ¥å£æ·»åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨ç¨‹åºä¸­è°ƒç”¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.UserShortCut</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">UserShortCut</span> <span class="nf">selectUserShortcutById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUserShortcutById æ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">UserShortCut</span> <span class="n">shortCut</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserShortcutById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">shortCut</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">UserShortCut<span class="o">{</span><span class="nv">username</span><span class="o">=</span><span class="s1">&#39;peter&#39;</span>, <span class="nv">age</span><span class="o">=</span>18<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-4">å°ç»“</h2>
<ul>
<li>SQL æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„æ ‡ç­¾ï¼Œèƒ½å¤Ÿå‡å°‘å¤§é‡é‡å¤çš„ SQL ä»£ç ä¹¦å†™ï¼Œä½†æ˜¯ä¹Ÿé™ä½ SQL çš„å¯è¯»æ€§ã€‚</li>
<li>MyBatis ä¼šè‡ªåŠ¨ç”Ÿæˆ resultMapï¼Œè¿™ä¼šä¸ºæˆ‘ä»¬èŠ‚çœäº†å¤§é‡çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å¯¹æ€§èƒ½ååˆ†ä¸¥è‹›ï¼Œé‚£ä¹ˆ resultType æ˜¯å¤Ÿç”¨çš„ã€‚</li>
</ul>
<h1 id="mybatis-insert">MyBatis insert</h1>
<h2 id="å‰è¨€-5">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis insertã€‚</p>
<p>åœ¨ MyBatis ä¸­ï¼Œinsert æ ‡ç­¾å¯¹åº”äº SQL è¯­å¥ä¸­çš„ insert æ’å…¥ï¼›ä¸ select ç›¸æ¯”ï¼Œinsert è¦ç®€å•è®¸å¤šï¼Œåªæœ‰å½“éœ€è¦è¿”å›ä¸»é”®æ—¶ï¼Œæ‰ä¼šéº»çƒ¦ä¸€äº›ï¼Œæˆ‘ä»¬å°†ä»ç®€å•åˆ°å¤æ‚æ¥ä¾æ¬¡ä»‹ç»ã€‚</p>
<h2 id="å®šä¹‰-3">å®šä¹‰</h2>
<blockquote>
<p>insert æ ‡ç­¾ç”¨äºæ˜ å°„ SQL ä¸­çš„<code>æ’å…¥</code>è¯­å¥</p>
</blockquote>
<h2 id="å®ä¾‹-2">å®ä¾‹</h2>
<h3 id="xml-å®ä¾‹-2">xml å®ä¾‹</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ insert æ ‡ç­¾ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO imooc_user(id,username,age,score) VALUES (#{id},#{username},#{age},#{score})
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒ select ä¸€æ ·ï¼Œæ¯ä¸€ä¸ª insert æ ‡ç­¾éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ id å’Œå¯é€‰çš„ parameterTypeã€‚æ ‡ç­¾é‡Œé¢åˆ™æ˜¯çœŸæ­£çš„ SQL è¯­å¥ï¼Œè¯¥è¯­å¥å…±æœ‰ 4 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«å¯¹åº” User ç±»çš„å››ä¸ªå±æ€§ã€‚</p>
<h3 id="æ³¨è§£å®ä¾‹-2">æ³¨è§£å®ä¾‹</h3>
<p>å¦‚æœä¸ä½¿ç”¨ xml çš„æ–¹å¼ï¼Œä½¿ç”¨æ³¨è§£ä¹Ÿå¯å–å¾—åŒæ ·çš„æ•ˆæœï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;INSERT INTO imooc_user(username,age,score) VALUES (#{username},#{age},#{score})&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">insertUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="insert-å±æ€§">insert å±æ€§</h2>
<p>insert æ ‡ç­¾ä¹Ÿæ”¯æŒè¯¸å¤šå±æ€§æ¥æ”¹å˜è¯­å¥çš„è¡Œä¸ºã€‚</p>
<p>å…¶ä¸­å¸¸è§ä¸”é‡è¦çš„å±æ€§å¦‚ä¸‹è¡¨ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">åœ¨å‘½åç©ºé—´ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">parameterType</td>
<td style="text-align:left">è¯­å¥çš„å‚æ•°ç±»å‹ï¼Œé»˜è®¤å¯é€‰ï¼ŒMyBatis ä¼šè‡ªåŠ¨æ¨æ–­</td>
</tr>
<tr>
<td style="text-align:left">flushCache</td>
<td style="text-align:left">è®¾ç½®ä¸º true åï¼Œåªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¢«æ¸…ç©ºï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td style="text-align:left">timeout</td>
<td style="text-align:left">è®¾ç½®è¶…æ—¶æ—¶é—´</td>
</tr>
<tr>
<td style="text-align:left">statementType</td>
<td style="text-align:left">STATEMENTï¼ŒPREPARED æˆ– CALLABLE ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤ä¸º PREPAREDï¼ˆé¢„å¤„ç†ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">useGeneratedKeys</td>
<td style="text-align:left">å–å‡ºç”±æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®ï¼Œä»…å¯¹æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®åº“æœ‰æ•ˆï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td style="text-align:left">keyProperty</td>
<td style="text-align:left">ä¸»é”®çš„åç§°ï¼Œå¿…é¡»ä¸useGeneratedKeys ä¸€èµ·ä½¿ç”¨ï¼Œé»˜è®¤æœªè®¾ç½®</td>
</tr>
</tbody>
</table></div>
<h2 id="è¿”å›ä¸»é”®">è¿”å›ä¸»é”®</h2>
<p>select æ ‡ç­¾åœ¨éœ€è¦è¿”å›è¢«æ·»åŠ è®°å½•çš„ä¸»é”®æ—¶ï¼Œä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚</p>
<h3 id="è‡ªå¢ä¸»é”®">è‡ªå¢ä¸»é”®</h3>
<h4 id="xml-æ–¹å¼-1">xml æ–¹å¼</h4>
<p>å¦‚æœä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¦‚ MySQLï¼ŒPostgreSQLï¼Œè¿™äº›æ•°æ®åº“æ”¯æŒè‡ªå¢ä¸»é”®ï¼Œé‚£ä¹ˆå¾—åˆ°è¿”å›çš„ä¸»é”®åªéœ€æ·»åŠ ä¸Š useGeneratedKeys å’Œ keyProperty ä¸¤ä¸ªå±æ€§å³å¯ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUserNoId&#34;</span> <span class="na">useGeneratedKeys=</span><span class="s">&#34;true&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;id&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO user(username,age,score) VALUES (#{username},#{age},#{score})
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ insertUserNoId ä¸­ï¼Œæˆ‘ä»¬å¹¶æœªæ·»åŠ ä¸Š id å‚æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨äº†æ•°æ®åº“è‡ªå¢ä¸»é”®çš„ç‰¹æ€§ï¼ŒkeyProperty å±æ€§å€¼å¯¹åº” id å­—æ®µçš„åç§°ï¼Œè¿™æ ·å½“è¯­å¥æ‰§è¡ŒæˆåŠŸåï¼Œå¯¹è±¡çš„ id å­—æ®µä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸ºè¿”å›çš„ id å€¼ã€‚</p>
<h4 id="æ³¨è§£æ–¹å¼-1">æ³¨è§£æ–¹å¼</h4>
<p>ä½¿ç”¨ä¸‹é¢çš„æ³¨è§£æ–¹å¼ï¼ŒåŒæ ·å¯ä»¥å®ç°åŒæ ·çš„æ•ˆæœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;INSERT INTO imooc_user(username,age,score) VALUES (#{username},#{age},#{score})&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Options</span><span class="o">(</span><span class="n">useGeneratedKeys</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">keyProperty</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">insertUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>MyBatis æä¾›äº† Options æ³¨è§£æ¥æŒ‡å®šæ–¹æ³•è°ƒç”¨çš„è¡Œä¸ºã€‚</p>
<h3 id="selectkey-æ ‡ç­¾">selectKey æ ‡ç­¾</h3>
<h4 id="xml-æ–¹å¼-2">xml æ–¹å¼</h4>
<p>å¦‚æœä½¿ç”¨çš„æ•°æ®åº“ä¸æ”¯æŒä¸»é”®è‡ªå¢ï¼Œå¦‚ Oracleï¼ŒMyBatis æä¾›äº† selectKey æ ‡ç­¾æ¥é€šè¿‡ SQL è¯­å¥è·å¾—ä¸»é”®ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUserNoId&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO imooc_user(username,age,score) VALUES (#{username},#{age},#{score})
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;selectKey</span> <span class="na">keyColumn=</span><span class="s">&#34;id&#34;</span> <span class="na">resultType=</span><span class="s">&#34;long&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;id&#34;</span> <span class="na">order=</span><span class="s">&#34;AFTER&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    SELECT LAST_INSERT_ID()
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/selectKey&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>selectKey æ ‡ç­¾å¿…é¡»åœ¨ insert æ ‡ç­¾é‡Œé¢ï¼ŒselectKey æœ‰ 4 ä¸ªå±æ€§ï¼Œå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹è¡¨ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">keyColumn</td>
<td style="text-align:left">æ•°æ®åº“å­—æ®µåï¼Œå¯¹åº”è¿”å›ç»“æœé›†ä¸­çš„åç§°</td>
</tr>
<tr>
<td style="text-align:left">keyProperty</td>
<td style="text-align:left">ç›®æ ‡å­—æ®µåç§°ï¼Œå¯¹åº”Java å¯¹è±¡çš„å­—æ®µå</td>
</tr>
<tr>
<td style="text-align:left">resultType</td>
<td style="text-align:left">idå­—æ®µçš„ç±»å‹</td>
</tr>
<tr>
<td style="text-align:left">order</td>
<td style="text-align:left">æ‰§è¡Œçš„é¡ºåºï¼Œåœ¨ insert ä¹‹å‰è°ƒç”¨ä¸º BEFOREï¼Œä¹‹åä¸º AFTER</td>
</tr>
</tbody>
</table></div>
<p>æ³¨æ„ï¼ŒselectKey ä¸­çš„è¯­å¥å…¶å®å°±æ˜¯ SQL è¯­å¥ï¼Œä¸åŒæ•°æ®åº“å¾—åˆ°ä¸»é”®çš„è¯­å¥å‡ä¸ä¸€æ ·ã€‚</p>
<h4 id="æ³¨è§£æ–¹å¼-2">æ³¨è§£æ–¹å¼</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;INSERT INTO imooc_user(username,age,score) VALUES (#{username},#{age},#{score})&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@SelectKey</span><span class="o">(</span><span class="n">statement</span> <span class="o">=</span> <span class="s">&#34;SELECT LAST_INSERT_ID()&#34;</span><span class="o">,</span> <span class="n">keyProperty</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">before</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">resultType</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">insertUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>selectKey ä¹Ÿæœ‰ç›¸åº”çš„æ³¨è§£ï¼Œä¸è¿‡é…ç½®å±æ€§ç•¥æœ‰ä¸åŒï¼Œstatement å±æ€§å¯¹åº”æ ‡ç­¾ä¸­çš„ SQL è¯­å¥ï¼Œè€Œ before å±æ€§åˆ™å¯¹åº”æ ‡ç­¾ä¸­çš„ order å±æ€§ï¼Œè‹¥ before ä¸º falseï¼Œåˆ™ order å¯¹åº”ä¸º AFTERã€‚</p>
<h2 id="å®è·µ-2">å®è·µ</h2>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®æ“å·©å›ºä¸€ä¸‹ã€‚</p>
<h3 id="ä¾‹1-æ’å…¥ç”¨æˆ·">ä¾‹1. æ’å…¥ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆåœ¨ imooc_user è¡¨ä¸­æ’å…¥ç”¨æˆ·çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨å¯¹åº” UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ æ’å…¥ç”¨æˆ·çš„ insert æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>ä½¿ç”¨ MyBatis å‘æ•°æ®åº“ä¸­æ’å…¥ç”¨æˆ·ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®åº“æ˜¯ MySQLï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨ useGeneratedKeys å¾—åˆ°è‡ªå¢ä¸»é”®ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„ insert æ ‡ç­¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUser&#34;</span> <span class="na">useGeneratedKeys=</span><span class="s">&#34;true&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;id&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO imooc_user(username,age,score) VALUES (#{username},#{age},#{score})
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">insertUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ insertUser æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;insert test&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">100000</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸€å®šè¦æäº¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>TIPS:</strong> æ³¨æ„ï¼Œè¿™é‡Œå¿…é¡»é€šè¿‡ commit æ–¹æ³•æäº¤ä¼šè¯ï¼Œè¯­å¥æ‰ä¼šç”Ÿæ•ˆã€‚</p>
</blockquote>
<h2 id="å°ç»“-5">å°ç»“</h2>
<ul>
<li>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¸ä¼šåœ¨æ’å…¥æ—¶æŒ‡å®š id çš„å€¼ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®åº“è‡ªåŠ¨å»ç”Ÿæˆã€‚</li>
<li>ä¸åŒæ•°æ®åº“è·å¾—ä¸»é”®çš„ SQL è¯­å¥ä¹Ÿä¸åŒï¼Œå¦‚æœé€šè¿‡ selectKey è·å¾—ä¸»é”®ï¼Œé‚£ä¹ˆä¸€å®šè¦æ³¨æ„æ•°æ®åº“å‚å•†ä¹‹é—´çš„å·®å¼‚æ€§ã€‚</li>
</ul>
<h1 id="mybatis-update">MyBatis update</h1>
<h2 id="å‰è¨€-6">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis updateã€‚</p>
<p>åœ¨ MyBatis ä¸­ï¼Œupdate æ ‡ç­¾å¯¹åº”äº SQL è¯­å¥ä¸­çš„ update æ›´æ–°ã€‚</p>
<h2 id="å®šä¹‰-4">å®šä¹‰</h2>
<blockquote>
<p>update æ ‡ç­¾ç”¨äºæ˜ å°„ SQL ä¸­çš„<code>æ›´æ–°</code>è¯­å¥ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-3">å®ä¾‹</h2>
<h3 id="xml-å®ä¾‹-3">xml å®ä¾‹</h3>
<p>å¦‚ä¸‹å°±æ˜¯ä¸€ä¸ªçœŸå®çš„ update æ ‡ç­¾å®ä¾‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUserAgeById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user SET age = #{age} WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯ä¸€ä¸ª update æ ‡ç­¾éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ id å±æ€§ï¼Œåœ¨ update æ ‡ç­¾å†…éƒ¨åˆ™æ˜¯ä¸€æ¡ SQL è¯­å¥ã€‚</p>
<h3 id="æ³¨è§£å®ä¾‹-3">æ³¨è§£å®ä¾‹</h3>
<p>ä½¿ç”¨å¦‚ä¸‹çš„æ³¨è§£æ–¹å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„åŠŸèƒ½ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Update</span><span class="o">(</span><span class="s">&#34;UPDATE imooc_user SET age = #{age} WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">updateUserAgeById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="update-å±æ€§">update å±æ€§</h2>
<p>update æ ‡ç­¾æ”¯æŒä¸€äº›å±æ€§æ¥æ”¹å˜æ›´æ–°è¯­å¥çš„è¡Œä¸ºã€‚</p>
<p>å…¶ä¸­å¸¸è§ä¸”é‡è¦çš„å±æ€§å¦‚ä¸‹è¡¨ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">åœ¨å‘½åç©ºé—´ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">parameterType</td>
<td style="text-align:left">è¯­å¥çš„å‚æ•°ç±»å‹ï¼Œé»˜è®¤å¯é€‰ï¼ŒMyBatis ä¼šè‡ªåŠ¨æ¨æ–­</td>
</tr>
<tr>
<td style="text-align:left">flushCache</td>
<td style="text-align:left">è®¾ç½®ä¸º true åï¼Œåªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¢«æ¸…ç©ºï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td style="text-align:left">timeout</td>
<td style="text-align:left">è®¾ç½®è¶…æ—¶æ—¶é—´</td>
</tr>
<tr>
<td style="text-align:left">statementType</td>
<td style="text-align:left">STATEMENTï¼ŒPREPARED æˆ– CALLABLE ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤ä¸º PREPAREDï¼ˆé¢„å¤„ç†ï¼‰</td>
</tr>
</tbody>
</table></div>
<h2 id="å®è·µ-3">å®è·µ</h2>
<h3 id="ä¾‹1-æ›´æ–°ç”¨æˆ·å¹´é¾„">ä¾‹1. æ›´æ–°ç”¨æˆ·å¹´é¾„</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨ä¸­ç”¨æˆ·å¹´é¾„æ›´æ–°çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨å¯¹åº” UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·å¹´é¾„æ›´æ–°çš„ update æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  update æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQL ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUserAgeById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user SET age = #{age} WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— age å’Œ id ä¸¤ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">updateUserAgeById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†<code>@Param</code>è¿™ä¸ªæ³¨è§£ï¼Œç”±äºåœ¨ update æ ‡ç­¾ä¸­æœ‰ä¸¤ä¸ªå‚æ•° age å’Œ idï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ @Param æ¥å‘Šè¯‰ MyBatis å‚æ•°çš„å¯¹åº”å…³ç³»ã€‚</p>
<p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ updateUserAgeById è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">updateUserAgeById</span><span class="o">(</span><span class="n">180</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸€å®šè¦æäº¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œid ä¸º 1 çš„ç”¨æˆ·å¹´é¾„å·²ç»è¢«æ›´æ–°ä¸º 180ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span><span class="line"><span class="cl">| id | username    | age | score  |
</span></span><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span><span class="line"><span class="cl">| 1  | peter       | 180 | 100    |
</span></span><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¾‹2-æ›´æ–°ç”¨æˆ·åç§°å’Œåˆ†æ•°">ä¾‹2. æ›´æ–°ç”¨æˆ·åç§°å’Œåˆ†æ•°</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨ä¸­ç”¨æˆ·åç§°å’Œåˆ†æ•°æ›´æ–°çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>åŒä¸Šã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ å¦ä¸€ä¸ª update æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQL ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUsernameAndScoreById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user SET username = #{username}, score = #{score} WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— usernameã€score å’Œ id ä¸‰ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">updateUsernameAndScoreById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;score&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">score</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ updateUsernameAndScoreById è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">updateUsernameAndScoreById</span><span class="o">(</span><span class="s">&#34;peter-gao&#34;</span><span class="o">,</span> <span class="n">1000</span><span class="o">,</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸€å®šè¦æäº¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œid ä¸º 1 çš„ç”¨æˆ·ä¿¡æ¯å·²è¢«æ›´æ”¹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span><span class="line"><span class="cl">| id | username    | age | score  |
</span></span><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span><span class="line"><span class="cl">| 1  | peter-gao   | 180 | 1000   |
</span></span><span class="line"><span class="cl">+----+-------------+-----+--------+
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-6">å°ç»“</h2>
<ul>
<li>update æ ‡ç­¾å¹¶æ— å¤ªå¤šçš„çŸ¥è¯†ç‚¹ï¼Œä¸»è¦çš„å·¥ä½œé‡åœ¨ä¹¦å†™ SQL ä¸Šï¼Œå› æ­¤è‰¯å¥½çš„ SQL åŠŸåº•å¯ä»¥å¸®åŠ©ä½ æ›´åŠ å¿«é€Ÿçš„ä¸Šæ‰‹ MyBatisã€‚</li>
</ul>
<h1 id="mybatis-delete">MyBatis delete</h1>
<h2 id="å‰è¨€-7">å‰è¨€</h2>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  MyBatis deleteã€‚</p>
<p>åœ¨ MyBatis ä¸­ï¼Œdelete æ ‡ç­¾å¯¹åº”äº SQL è¯­å¥ä¸­çš„ delete åˆ é™¤ã€‚</p>
<h2 id="å®šä¹‰-5">å®šä¹‰</h2>
<blockquote>
<p>delete æ ‡ç­¾ç”¨äºæ˜ å°„ SQL ä¸­çš„<code>åˆ é™¤</code>è¯­å¥ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-4">å®ä¾‹</h2>
<h3 id="xml-å®ä¾‹-4">xml å®ä¾‹</h3>
<p>å¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªçœŸå®çš„ delete æ ‡ç­¾å®ä¾‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUserById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  DELETE FROM imooc_user WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/delete&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯ä¸€ä¸ª delete æ ‡ç­¾éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ id å±æ€§ï¼Œåœ¨ delete æ ‡ç­¾å†…éƒ¨åˆ™æ˜¯ä¸€æ¡ SQL è¯­å¥ã€‚</p>
<h3 id="æ³¨è§£å®ä¾‹-4">æ³¨è§£å®ä¾‹</h3>
<p>ä¸Šé¢çš„ delete æ ‡ç­¾å¯¹åº”çš„æ³¨è§£å®ä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Delete</span><span class="o">(</span><span class="s">&#34;DELETE FROM imooc_user WHERE id = #{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">deleteUserById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="delete-å±æ€§">delete å±æ€§</h2>
<p>delete æ ‡ç­¾æ”¯æŒä¸€äº›å±æ€§æ¥æ”¹å˜æ›´æ–°è¯­å¥çš„è¡Œä¸ºã€‚</p>
<p>å…¶ä¸­å¸¸è§ä¸”é‡è¦çš„å±æ€§å¦‚ä¸‹è¡¨ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">åœ¨å‘½åç©ºé—´ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">parameterType</td>
<td style="text-align:left">è¯­å¥çš„å‚æ•°ç±»å‹ï¼Œé»˜è®¤å¯é€‰ï¼ŒMyBatis ä¼šè‡ªåŠ¨æ¨æ–­</td>
</tr>
<tr>
<td style="text-align:left">flushCache</td>
<td style="text-align:left">è®¾ç½®ä¸º true åï¼Œåªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¢«æ¸…ç©ºï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td style="text-align:left">timeout</td>
<td style="text-align:left">è®¾ç½®è¶…æ—¶æ—¶é—´</td>
</tr>
<tr>
<td style="text-align:left">statementType</td>
<td style="text-align:left">STATEMENTï¼ŒPREPARED æˆ– CALLABLE ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤ä¸º PREPAREDï¼ˆé¢„å¤„ç†ï¼‰</td>
</tr>
</tbody>
</table></div>
<h2 id="å®è·µ-4">å®è·µ</h2>
<h3 id="ä¾‹1-æ ¹æ®-id-åˆ é™¤ç”¨æˆ·">ä¾‹1. æ ¹æ® id åˆ é™¤ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨ä¸­é€šè¿‡ id åˆ é™¤ç”¨æˆ·çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨å¯¹åº” UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ æ ¹æ® id åˆ é™¤ç”¨æˆ·çš„ delete æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  delete æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQL ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUserById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  DELETE FROM imooc_user WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/delete&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— id ä¸€ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="nf">deleteUserById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ deleteUserById è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">deleteUserById</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸€å®šè¦æäº¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œid ä¸º 10 çš„ç”¨æˆ·å·²è¢«åˆ é™¤ã€‚</p>
<h3 id="ä¾‹2-æ ¹æ®ç”¨æˆ·ååˆ é™¤ç”¨æˆ·">ä¾‹2. æ ¹æ®ç”¨æˆ·ååˆ é™¤ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨ä¸­é€šè¿‡<code>ç”¨æˆ·å</code>åˆ é™¤ç”¨æˆ·çš„åŠŸèƒ½ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>åŒä¸Šã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  delete æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQL ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUserByName&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  DELETE FROM imooc_user WHERE username = #{username}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/delete&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— username ä¸€ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="nf">deleteUserByName</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ deleteUserByName è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">deleteUserByName</span><span class="o">(</span><span class="s">&#34;tom&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç”¨æˆ·åä¸º tom çš„ç”¨æˆ·å·²è¢«åˆ é™¤ã€‚</p>
<h2 id="å°ç»“-7">å°ç»“</h2>
<ul>
<li>delete æ ‡ç­¾å¹¶æ— å¤ªå¤šçš„çŸ¥è¯†ç‚¹ï¼Œä¸»è¦çš„å·¥ä½œé‡åœ¨ä¹¦å†™ SQL ä¸Šã€‚</li>
</ul>
<h1 id="ognl-è¡¨è¾¾å¼">OGNL è¡¨è¾¾å¼</h1>
<h2 id="å‰è¨€-8">å‰è¨€</h2>
<p>MyBatis çš„åŠ¨æ€ SQL å¹¿æ³›åº”ç”¨åˆ°äº†OGNL è¡¨è¾¾å¼ï¼ŒOGNL è¡¨è¾¾å¼å¯ä»¥çµæ´»çš„ç»„è£… SQL è¯­å¥ï¼Œä»è€Œå®Œæˆæ›´å¤šçš„åŠŸèƒ½ã€‚OGNL æ˜“å­¦æ˜“ç”¨ï¼Œä¸ Java ä»£ç å‡ ä¹ä¸€è‡´ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬å°†ç³»ç»Ÿçš„ä»‹ç» OGNL è¡¨è¾¾å¼åœ¨ MyBatis ä¸­çš„ä½¿ç”¨ã€‚</p>
<h2 id="å®šä¹‰-6">å®šä¹‰</h2>
<blockquote>
<p>OGNL å…¨ç§° Object-Graph Navigation Languageï¼Œæ˜¯ Java ä¸­çš„ä¸€ä¸ªå¼€æºçš„è¡¨è¾¾å¼è¯­è¨€ï¼Œç”¨äºè®¿é—®å¯¹è±¡æ•°æ®ã€‚</p>
</blockquote>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<h3 id="å®ä¾‹-5">å®ä¾‹</h3>
<p>OGNL æœ€å¸¸ç”¨äº if æ ‡ç­¾ä¸­ï¼Œç”¨äºåˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;age != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  AND age = #{age}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/if&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>if æ ‡ç­¾çš„ test å±æ€§å°±æ˜¯ä¸ªå…¸å‹çš„ OGNL è¡¨è¾¾å¼ã€‚<code>age != null</code>è¡¨ç¤ºå½“ age ä¸ä¸º null çš„æ—¶å€™ if æˆç«‹ï¼Œåˆ™åŠ¨æ€çš„å‘ SQL ä¸­æ’å…¥æ ‡ç­¾å†…çš„ SQL ä»£ç æ®µã€‚</p>
<h3 id="å¸¸è§çš„-ognl-è¡¨è¾¾å¼">å¸¸è§çš„ OGNL è¡¨è¾¾å¼</h3>
<p>åœ¨ MyBatis ä¸­å¸¸è§çš„ OGNL è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<ol>
<li>e1 or e2ï¼šæˆ–å…³ç³»</li>
<li>e1 and e2ï¼šä¸å…³ç³»</li>
<li>e1 == e2 æˆ–è€… e1 eq e2ï¼šç›¸ç­‰</li>
<li>e1 != e2 æˆ–è€… e1 neq e2ï¼šä¸ç­‰</li>
<li>e1 lt e2 ï¼›e1 &lt; e2ï¼›e1 gt e2ï¼›e1 &gt; e2ï¼›e1 lte e2ï¼›e1 &lt;= e2ï¼›e1 gte e2ï¼›e1 &gt;= e2ï¼šæ¯”è¾ƒå…³ç³»</li>
<li>e1 + e2ï¼›e1 - e2ï¼›e1 * e2ï¼›e1 / e2ï¼›e1 % e2ï¼šè¿ç®—å…³ç³»</li>
<li>!e æˆ–è€… not eï¼šéï¼Œå–å</li>
<li>e.method(args)ï¼šè°ƒç”¨å¯¹è±¡æ–¹æ³•</li>
<li>e.propertyï¼šè®¿é—®å±æ€§å€¼</li>
<li>e1[e2]ï¼šè®¿é—®æ•°ç»„ã€é“¾è¡¨ï¼ˆe2 ä¸ºåºå·ï¼‰æˆ–è€… Mapï¼ˆe2 ä¸ºé”®å€¼ï¼‰</li>
</ol>
<p>å…¶ä¸­ 1ï½4 ä»¥åŠ 9ï½10 éƒ½æ˜¯ç‰¹åˆ«å¸¸ç”¨çš„å‡ ç§æƒ…å†µï¼Œè€Œå…¶å®ƒçš„æƒ…å†µä¸åˆ©äº SQL çš„ç»´æŠ¤ï¼Œå› æ­¤å¹¶ä¸å¸¸è§ã€‚</p>
<blockquote>
<p><strong>TIPSï¼š</strong> æç¤ºï¼Œ å¦‚æœä½ ç†Ÿæ‚‰ Python çš„è¯ï¼Œä¼šå‘ç° OGNL è¡¨è¾¾å¼å®Œå…¨å°±æ˜¯åœ¨å†™ Pythonã€‚</p>
</blockquote>
<h2 id="å®è·µ-5">å®è·µ</h2>
<p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä»¥å®ä¾‹æ¥çœ‹ä¸€çœ‹ OGNL è¡¨è¾¾å¼ã€‚</p>
<p>æœ‰ä¸€ä¸ªåä¸º pedro çš„ User å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">User</span> <span class="n">pedro</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pedro</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;pedro&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">pedro</span><span class="o">.</span><span class="na">setTags</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;admin&#34;</span><span class="o">,</span> <span class="s">&#34;man&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="n">pedro</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">23</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è®¿é—®å±æ€§">è®¿é—®å±æ€§</h3>
<p>è®¿é—®ç”¨æˆ·çš„ username å±æ€§ï¼ŒOGNL è¡¨è¾¾å¼ä¸º<code>pedro.username</code>ï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pedro.username</span>
</span></span><span class="line"><span class="cl">pedro
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è®¿é—®åˆ—è¡¨">è®¿é—®åˆ—è¡¨</h3>
<p>è®¿é—®ç”¨æˆ·çš„ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼ŒOGNL è¡¨è¾¾å¼ä¸º<code>pedro.tags[0]</code>ï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pedro.tags[0]</span>
</span></span><span class="line"><span class="cl">admin
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ¯”è¾ƒ">æ¯”è¾ƒ</h3>
<p>æ¯”è¾ƒç”¨æˆ·æ ‡ç­¾é•¿åº¦æ˜¯å¦å¤§äº 1ï¼ŒOGNL è¡¨è¾¾å¼ä¸º<code>pedro.tags[0]</code>ï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pedro.tags.size &gt; 1</span>
</span></span><span class="line"><span class="cl"><span class="nb">true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¿ç®—">è¿ç®—</h3>
<p>ç”¨æˆ·å¹´é¾„åŠ ä¸Šä¸€ä¸ªæ•´æ•° 22ï¼ŒOGNL è¡¨è¾¾å¼ä¸º<code>pedro.age + 22</code>ï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pedro.age + 22</span>
</span></span><span class="line"><span class="cl"><span class="m">45</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ–¹æ³•è°ƒç”¨">æ–¹æ³•è°ƒç”¨</h3>
<p>å°†ç”¨æˆ·å¹´é¾„å…¨éƒ¨å¤§å†™ï¼ŒOGNL è¡¨è¾¾å¼ä¸º<code>pedro.username.toUpperCase</code>ï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pedro.username.toUpperCase</span>
</span></span><span class="line"><span class="cl">PEDRO
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-8">å°ç»“</h2>
<ul>
<li>OGNL è¡¨è¾¾å¼æ˜¯ MyBatis åŠ¨æ€ SQL çš„æ ¸å¿ƒï¼Œå°å·§ç²¾è‡´å´åŠŸèƒ½å¼ºå¤§ï¼Œæ˜“å­¦æ˜“ç”¨ã€‚</li>
</ul>
<h1 id="mybatis-if-å’Œå¤šæ•°æ®åº“æ”¯æŒ">MyBatis if å’Œå¤šæ•°æ®åº“æ”¯æŒ</h1>
<h2 id="å‰è¨€-9">å‰è¨€</h2>
<p>åŠ¨æ€ SQL æ˜¯ MyBatis æœ€æ ‡å¿—æ€§çš„ç‰¹æ€§ä¹‹ä¸€ã€‚åœ¨å…¶å®ƒæ¡†æ¶ä¸­ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ä¸åŒçš„æ¡ä»¶æ¥æ‹¼æ¥ SQLï¼Œè¾—è½¬åœ¨ç¬¦å·ä¸æ¡ä»¶çš„åˆ¤æ–­ä¸Šï¼Œå¤„ç†èµ·æ¥éº»çƒ¦è€Œä¸”æ˜“é”™ï¼Œè€Œ MyBatis çš„åŠ¨æ€ SQL å¯ä»¥è®©æˆ‘ä»¬æ‘†è„±è¿™ç§ç—›è‹¦ï¼Œç®€å•è€Œåˆé«˜æ•ˆçš„ä¹¦å†™ SQLã€‚</p>
<p>MyBatis åŠ¨æ€ SQL ç”± OGNL è¡¨è¾¾å¼å’Œæ¡ä»¶æ ‡ç­¾ä¸¤éƒ¨ åˆ†ç»„æˆï¼Œæˆ‘ä»¬å°†ä¼šåˆ†ä¸ºå¤šä¸ªå°èŠ‚è¿›è¡Œä»‹ç»ã€‚</p>
<p>OGNL è¡¨è¾¾å¼æ˜¯åŠ¨æ€ SQL çš„åŸºç¡€ï¼Œå¦‚æœä½ è¿˜ä¸äº†è§£ï¼Œè¯·åŠ¡å¿…ç‚¹å‡»å­¦ä¹ ä¸€ä¸‹ã€‚æ¡ä»¶æ ‡ç­¾éƒ¨åˆ†æˆ‘ä»¬å°†ä¼šåœ¨<code>å››ä¸ª</code>å°èŠ‚ä¸­åˆ†åˆ«ä»‹ç»ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯MyBatis if å’Œå¤šæ•°æ®åº“æ”¯æŒï¼ˆæœ¬å°èŠ‚ï¼‰ï¼ŒMyBatis chooseå’Œbindå°èŠ‚ï¼ŒMyBatis whereã€setã€trimå°èŠ‚å’ŒMyBatis foreachå°èŠ‚ã€‚</p>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ æœ€åŸºç¡€çš„æ¡ä»¶æ ‡ç­¾ ifï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ if æ¥è®© MyBatis æ¥æ”¯æŒå¤šæ•°æ®åº“ã€‚</p>
<h2 id="å®šä¹‰-7">å®šä¹‰</h2>
<blockquote>
<p><code>if</code> å¸¸ç”¨äº where è¯­å¥ä¸­ï¼Œé€šè¿‡åˆ¤æ–­å‚æ•°æ¥å†³å®šåœ¨ select è¯­å¥ä¸­æ˜¯å¦ä½¿ç”¨æŸä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œæˆ–è€…åœ¨ update è¯­å¥ä¸­åˆ¤æ–­æ˜¯å¦æ›´æ–°ä¸€ä¸ªå­—æ®µï¼Œè¿˜å¯ä»¥åœ¨ insert è¯­å¥ä¸­å†³å®šæ˜¯å¦æ’å…¥ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å€¼ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-6">å®ä¾‹</h2>
<p>æˆ‘ä»¬ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥çœ‹ä¸€ä¸‹ if æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByAgeAndScore&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;userMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE age = #{age}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;score != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    AND score = #{score}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ if æ ‡ç­¾ä¸­ï¼Œtest å±æ€§æ˜¯ OGNL çš„åˆ¤æ–­è¡¨è¾¾å¼ã€‚</p>
<p>selectUserByAgeAndScore çš„ä½œç”¨æ˜¯é€šè¿‡ç”¨æˆ·å¹´é¾„å’Œç§¯åˆ†æ¥æŸ¥è¯¢ç”¨æˆ·ï¼Œå½“ score å€¼ä¸º null æ—¶ï¼Œif åˆ¤æ–­ä¸æˆç«‹ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ SQL è¯­å¥ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">imooc_user</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è€Œå½“ if æˆç«‹æ—¶ï¼Œç”Ÿæˆçš„ SQL è¯­å¥ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">imooc_user</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡è¿™æ ·æ¡ä»¶åˆ¤æ–­æ–¹å¼ï¼ŒMyBatis èƒ½æ ¹æ®å®é™…æƒ…å†µæ¥åŠ¨æ€ç”Ÿæˆ SQL è¯­å¥ã€‚</p>
<h2 id="å®è·µ-6">å®è·µ</h2>
<h3 id="ä¾‹1åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·">ä¾‹1ã€åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·çš„åŠŸèƒ½ï¼Œ usernameä¸ºå¿…é¡»çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¹´é¾„å’Œç§¯åˆ†è‹¥ä¸º null åˆ™ä¸ä½¿ç”¨è¯¥å­—æ®µè¿›è¡Œè¿‡æ»¤ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨ UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·çš„ select æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­å¢åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  select æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ if æ¥åˆ¤æ–­å±æ€§å€¼æ˜¯å¦ä¸º nullï¼Œè‹¥ä¸º nullï¼Œåˆ™ä¸ä½¿ç”¨è¯¥å­—æ®µè¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByNameCondition&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE username = #{username}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;age != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    AND age = #{age}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;score != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    AND score = #{score}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ if å¯¹å±æ€§çš„åˆ¤æ–­ï¼ŒSQL çš„è¿‡æ»¤æ¡ä»¶å°±ä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ã€‚</p>
<p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— Userå¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="n">User</span> <span class="nf">selectUserByNameCondition</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUserByNameCondition è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">condition</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">condition</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;pedro&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">condition</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">200</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">pedro</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserByNameCondition</span><span class="o">(</span><span class="n">condition</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pedro</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>condition å¯¹è±¡ username å’Œ score å±æ€§å‡ä¸ä¸ºç©ºï¼Œè€Œ age å±æ€§ä¸ºç©ºï¼Œå› æ­¤æœ€åæ‰€æ‰§è¡Œçš„ SQL ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">imooc_user</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">User<span class="o">{</span><span class="nv">id</span><span class="o">=</span>2, <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;pedro&#39;</span>, <span class="nv">age</span><span class="o">=</span>24, <span class="nv">score</span><span class="o">=</span>200<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å¤šæ•°æ®åº“æ”¯æŒ">å¤šæ•°æ®åº“æ”¯æŒ</h2>
<p>MyBatis å¯ä»¥æ ¹æ®ä¸åŒçš„æ•°æ®åº“å‚å•†æ‰§è¡Œä¸åŒçš„è¯­å¥ï¼Œè¿™ç§å¤šå‚å•†çš„æ”¯æŒæ˜¯åŸºäºé…ç½®æ–‡ä»¶ä¸­çš„ databaseIdã€‚</p>
<h3 id="é…ç½®">é…ç½®</h3>
<p>é¦–å…ˆåœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;databaseIdProvider</span> <span class="na">type=</span><span class="s">&#34;DB_VENDOR&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ configuration ä¸­åŠ å…¥ databaseIdProvider åï¼Œè¿˜éœ€è¦åœ¨ databaseIdProvider æ ‡ç­¾ä¸­æ·»åŠ ä¸Šéœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®åº“åç§°ï¼Œå¦‚ï¼šSQL Serverã€‚æ¯ä¸€ä¸ª property å±æ€§éƒ½ä»£è¡¨äº†ä¸€ä¸ªæ•°æ®åº“ï¼Œname è¡¨ç¤ºæ•°æ®åº“å‚å•†åç§°ï¼Œvalue ç”¨æ¥è®¾ç½®åˆ«åã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;databaseIdProvider</span> <span class="na">type=</span><span class="s">&#34;DB_VENDOR&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;SQL Server&#34;</span> <span class="na">value=</span><span class="s">&#34;sqlserver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;MySQL&#34;</span> <span class="na">value=</span><span class="s">&#34;mysql&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;PostgreSQL&#34;</span> <span class="na">value=</span><span class="s">&#34;postgre&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/databaseIdProvider&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä½¿ç”¨">ä½¿ç”¨</h3>
<p>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ mapper xml æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ if æ¥åˆ¤æ–­å½“å‰çš„æ•°æ®åº“å‚å•†ï¼Œä»è€ŒåŠ¨æ€ç”Ÿæˆä¸åŒæ•°æ®åº“çš„ SQLã€‚</p>
<p>ä¾‹å¦‚ï¼ŒPostgreSQL æ”¯æŒä½¿ç”¨ <code>||</code>æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œè€Œ MySQL éœ€è¦ä½¿ç”¨ <code>concat</code>å‡½æ•°æ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœåœ¨æ¨¡ç³ŠæŸ¥è¯¢çš„æ—¶å€™ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†éœ€è¦ä¸åŒçš„ SQL è¯­å¥ï¼Œé€šè¿‡ if æ¥åˆ¤æ–­æ•°æ®åº“å‚å•†æ¥ç”Ÿæˆå¯¹äºçš„ SQL è¯­å¥ã€‚</p>
<p>å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByLikeName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE username LIKE
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;_databaseId == &#39;mysql&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    CONCAT(&#39;%&#39;,#{username},&#39;%&#39;)
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;_databaseId == &#39;postgre&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    &#39;%&#39; || #{username} || &#39;%&#39;
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œè¿™é‡Œ _databaseId å‚æ•°æ˜¯ç”± MyBatis æä¾›çš„å†…ç½®å‚æ•°ï¼Œå¯¹åº”äº databaseIdProvider ä¸­é…ç½®çš„æ•°æ®åº“åç§°ã€‚</p>
<p>é€šè¿‡ databaseIdProvider é…ç½®ï¼Œå³æ—¶æ•°æ®åº“å‚å•†ä¹‹é—´å­˜åœ¨å·®å¼‚ï¼Œä½†ä»ç„¶å¯ä»¥é€šè¿‡åŠ¨æ€ SQL çš„å½¢å¼æ¥æ”¯æŒå¤šæ•°æ®åº“ã€‚</p>
<h2 id="å°ç»“-9">å°ç»“</h2>
<ul>
<li>if ç®€å•ä¸”å¥½ç”¨ï¼Œæ˜¯åŠ¨æ€ SQL ä¸­çš„æœ€åŸºç¡€çš„æ ‡ç­¾ï¼Œä¸€çœ‹ä¾¿ä¼šã€‚</li>
<li>å¤šæ•°æ®åº“æ”¯æŒçš„åº”ç”¨åœºæ™¯å…¶å®è¾ƒå°‘ï¼Œä½†å¦‚æœçœŸçš„éœ€è¦ï¼Œä¹Ÿå¯é€šè¿‡ MyBatis æ¥æ–¹ä¾¿çš„å®ç°ã€‚</li>
</ul>
<h1 id="mybatis-choose-å’Œ-bind">MyBatis choose å’Œ bind</h1>
<h2 id="å‰è¨€-10">å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† MyBatis åŠ¨æ€ SQL ä¸­æœ€åŸºç¡€çš„æ ‡ç­¾â€”â€”if æ ‡ç­¾ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹  choose å’Œ bind æ ‡ç­¾ã€‚</p>
<p>choose æ ‡ç­¾æ˜¯ if æ ‡ç­¾çš„å¢å¼ºç‰ˆï¼Œé€‚ç”¨äºæ›´åŠ å¤æ‚çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘ï¼›è€Œbind æ ‡ç­¾åˆ™å¯ä»¥åœ¨ OGNL ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­æ–°ç»‘å®šä¸€ä¸ªå˜é‡ï¼Œä¾›åé¢çš„ SQL ä½¿ç”¨ã€‚</p>
<h2 id="å®šä¹‰-8">å®šä¹‰</h2>
<blockquote>
<p><code>choose</code> æ ‡ç­¾ç›¸å½“äºç¼–ç¨‹è¯­è¨€ ifâ€¦else è¯­å¥ï¼Œç”¨äºåŠ¨æ€ SQL ä¸­çš„å¤šæ¡ä»¶åˆ¤æ–­ï¼Œæ˜¯ if æ ‡ç­¾çš„å¢å¼ºç‰ˆã€‚</p>
<p><code>bind</code> æ ‡ç­¾å¯ä»¥åœ¨åŠ¨æ€ SQL ä¸­é€šè¿‡ OGNL è¡¨è¾¾å¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡ç»‘å®šåˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œä¾›åç»­çš„ SQL ä½¿ç”¨ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-7">å®ä¾‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªèåˆäº† choose å’Œ bind æ ‡ç­¾çš„å®ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByLikeName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE username LIKE
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;choose&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;_databaseId == &#39;mysql&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      CONCAT(&#39;%&#39;,#{username},&#39;%&#39;)
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;_databaseId == &#39;postgre&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      &#39;%&#39; || #{username} || &#39;%&#39;
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;otherwise&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&#34;usernameLike&#34;</span> <span class="na">value=</span><span class="s">&#34;&#39;%&#39; + username + &#39;%&#39;&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      #{usernameLike}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/otherwise&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/choose&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ choose æ ‡ç­¾æ¥åˆ¤æ–­å½“å‰çš„æ•°æ®åº“å‚å•†ï¼Œå¦‚æœæ˜¯ MySQL æ•°æ®åº“ï¼Œåˆ™è°ƒç”¨<code>CONCAT</code>å‡½æ•°æ¥æ‹¼æ¥ % å’Œ usernameï¼Œå¦‚æœæ˜¯ PostgreSQL æ•°æ®åº“ï¼Œåˆ™ä½¿ç”¨æ“ä½œç¬¦<code>||</code>æ¥æ‹¼æ¥ï¼Œå¦‚æœæ˜¯å…¶å®ƒç±»å‹çš„æ•°æ®åº“ï¼Œåˆ™ç›´æ¥é€šè¿‡ OGNL è¡¨è¾¾å¼æ¥ç»‘å®šä¸€ä¸ªæ–°çš„å˜é‡ usernameLikeã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œchoose æ˜¯ä¸€ä¸ªæ¡ä»¶é€‰æ‹©æ ‡ç­¾ï¼Œç¬¬ä¸€ä¸ª when ç›¸å½“äº if åˆ¤æ–­ï¼Œç¬¬äºŒä¸ª when ç›¸å½“äº else ifï¼Œæœ€åçš„ otherwise ç›¸å½“äº elseã€‚æ¯”èµ· if æ ‡ç­¾ï¼Œchoose æ ‡ç­¾æ— ç–‘æ›´ä¸ºæ˜“ç”¨ï¼Œé€‚ç”¨äºåŒä¸€æ¡ä»¶çš„å¤šæ¬¡åˆ¤æ–­é€»è¾‘ã€‚</p>
<h2 id="å®è·µ-7">å®è·µ</h2>
<h3 id="ä¾‹1-å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·çš„åŠŸèƒ½ï¼Œå¦‚æœ id ä¸ä¸ºç©ºåˆ™ç›´æ¥ä½¿ç”¨ id æŸ¥è¯¢ç”¨æˆ·ï¼Œå¦åˆ™ä½¿ç”¨ username æŸ¥è¯¢ç”¨æˆ·ï¼Œå¦‚æœ username ä¹Ÿä¸ºç©ºï¼Œåˆ™ç›´æ¥æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œéœ€å…ˆåœ¨ UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·çš„ select æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  select æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ choose ä¸­çš„ when æ ‡ç­¾æ¥ä¾æ¬¡åˆ¤æ–­ id å’Œ username æ˜¯å¦ä¸º nullï¼Œè‹¥å‡ä¸º nullï¼Œåˆ™åœ¨ otherwise ä¸­æ·»åŠ ä¸Šä¸€ä¸ªæ°¸å‡çš„å€¼ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByIdOrName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;choose&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      id = #{id}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      username = #{username}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;otherwise&gt;</span>
</span></span><span class="line"><span class="cl">      1 = 0
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/otherwise&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/choose&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œä½¿ç”¨äº†<code>1 = 0</code>ä½œä¸ºæ¡ä»¶åˆ¤æ–­çš„æ°¸å‡å€¼ã€‚</p>
<p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— id å’Œ username ä¸¤ä¸ªå‚æ•°ï¼Œéƒ½å¯ä¸ºç©ºã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="n">User</span> <span class="nf">selectUserByIdOrName</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUserByIdOrName è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">pedro</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserByIdOrName</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pedro</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>id å’Œ username ä¸¤ä¸ªå±æ€§å‡ä¸ºç©ºï¼Œå› æ­¤æ‰€æ‰§è¡Œçš„ SQL ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">imooc_user</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">null
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¾‹2-æŸ¥è¯¢å°å†™åç§°å®¢æˆ·">ä¾‹2. æŸ¥è¯¢å°å†™åç§°å®¢æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨æŸ¥è¯¢å°å†™åç§°å®¢æˆ·çš„åŠŸèƒ½ï¼Œå°†åç§°å°å†™åå†è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>åŒä¸Šã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  select æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ bind æ ‡ç­¾å°†å‚æ•°å°å†™åŒ–æˆä¸€ä¸ªæ–°çš„å˜é‡ lowercaseNameã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUsernameLowercase&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&#34;lowercaseName&#34;</span> <span class="na">value=</span><span class="s">&#34;username.toLowercase&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE username = #{lowercaseName}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— username ä¸€ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="n">User</span> <span class="nf">selectUsernameLowercase</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUsernameLowercase è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">pedro</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUsernameLowercase</span><span class="o">(</span><span class="s">&#34;PEDRO&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pedro</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">User<span class="o">{</span><span class="nv">id</span><span class="o">=</span>2, <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;pedro&#39;</span>, <span class="nv">age</span><span class="o">=</span>24, <span class="nv">score</span><span class="o">=</span>200<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-10">å°ç»“</h2>
<ul>
<li>bind æ ‡ç­¾è™½ç„¶å¯ä»¥é€šè¿‡ OGNL è¡¨è¾¾å¼åœ¨ä¸Šä¸‹æ–‡ä¸­ç»‘å®šä¸€ä¸ªæ–°çš„å˜é‡ï¼Œä½†åœ¨å®é™…åº”ç”¨æ‰€è§ä¸å¤šï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä»£ç å±‚é¢ä¸Šå¤„ç†å¥½å‚æ•°ï¼Œè¿™æ ·æ—¢æ–¹ä¾¿ç»´æŠ¤ï¼Œä¹Ÿæ›´æœ‰åˆ©äºè¿ç§»ã€‚</li>
<li>choose æ ‡ç­¾æ˜¯ä¸€ä¸ªå¢å¼ºç‰ˆçš„ if æ ‡ç­¾ï¼Œé€‚ç”¨äºæ›´åŠ å¤æ‚çš„é€»è¾‘åˆ¤æ–­åœºæ™¯ã€‚</li>
</ul>
<h1 id="mybatis-wheresettrim">MyBatis whereã€setã€trim</h1>
<h2 id="å‰è¨€-11">å‰è¨€</h2>
<p>åœ¨å‰é¢çš„å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº† if æ ‡ç­¾ï¼Œåœ¨é€šè¿‡ if åˆ¤æ–­åŠ¨æ€æ’å…¥æˆ–æŸ¥è¯¢çš„æ—¶å€™å®¹æ˜“äº§ç”Ÿå¤šä½™çš„å‰ç¼€ï¼ˆå¦‚ WHEREï¼‰æˆ–åç¼€ï¼ˆå¦‚ , ï¼‰ï¼Œä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ MyBatis æä¾›äº† whereã€setã€trim ä¸‰ä¸ªå®ç”¨çš„æ ‡ç­¾ã€‚</p>
<p>å…¶ä¸­ where å’Œ set æ ‡ç­¾éƒ½æ˜¯ trim æ ‡ç­¾çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä¸è¿‡ä½¿ç”¨é¢‘ç‡éå¸¸é«˜ï¼Œå› æ­¤è¢«å•ç‹¬å®šä¹‰æˆäº†æ ‡ç­¾ã€‚æœ¬å°èŠ‚æˆ‘ä»¬å°†ä¸€èµ·æ¥å­¦ä¹ å®ƒä»¬ã€‚</p>
<h2 id="å®šä¹‰-9">å®šä¹‰</h2>
<blockquote>
<p><code>where</code>ã€<code>set</code>ã€<code>trim</code> ä¸‰ä¸ªæ ‡ç­¾éƒ½æ˜¯ä¸ºäº†è§£å†³ MyBatis åœ¨åŠ¨æ€ç”Ÿæˆ SQL æ—¶ï¼Œäº§ç”Ÿäº†å¤šä½™çš„å‰ç¼€å’Œåç¼€çš„é—®é¢˜ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-8">å®ä¾‹</h2>
<h3 id="where-å®ä¾‹">where å®ä¾‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserByIdAndName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;where&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      id = #{id}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      AND username = #{username}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/where&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œid å’Œ username å‡éå›ºå®šçš„è¿‡æ»¤å‚æ•°ï¼Œåªæœ‰å½“å…¶ä¸ä¸º null æ—¶æ‰ä¼šåŠ å…¥åˆ° SQL è¯­å¥ä¸­ã€‚æ­¤å¤„ where æ ‡ç­¾çš„ä½œç”¨å¤§æ¦‚æœ‰å¦‚ä¸‹ 3 ä¸ªï¼š</p>
<ol>
<li>åœ¨ id å’Œ username éƒ½ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œwhere æ ‡ç­¾ä¸ä¼šäº§ç”Ÿä»»ä½• SQL ä»£ç æ®µï¼Œæœ€åçš„ SQL è¯­å¥ä¸ºï¼š<code>SELECT * FROM imooc_user</code>ï¼›</li>
<li>åœ¨ id ä¸ä¸ºç©ºï¼Œusername ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œæˆ–è€…åœ¨ id ä¸ä¸ºç©ºï¼Œusername ä¹Ÿä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œwhere æ ‡ç­¾ä¼šè‡ªåŠ¨ç»™ SQL ä»£ç æ®µæ·»åŠ ä¸Š WHERE å‰ç¼€ï¼›</li>
<li>åœ¨ id ä¸ºç©ºï¼Œusername ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œwhere æ ‡ç­¾ä¼šè‡ªå®šå»é™¤ AND å‰ç¼€ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ SQL è¯­å¥ä¸ºï¼š <code>SELECT * FROM imooc_user WHERE username = ?</code>ã€‚</li>
</ol>
<h3 id="set-å®ä¾‹">set å®ä¾‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUsernameAndScoreById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;set&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      username = #{username},
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    id = #{id}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/set&gt;</span>
</span></span><span class="line"><span class="cl">  WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>set æ ‡ç­¾ä¼šè‡ªåŠ¨åœ¨ SQL è¯­å¥ä¸­æ·»åŠ ä¸Šç›¸åº”çš„ SET å‰ç¼€ï¼Œå¹¶æ ¹æ®é‡Œé¢çš„æ¡ä»¶åŠ¨æ€åœ°æ·»åŠ ç›¸åº”çš„å­—æ®µã€‚</p>
<p>ç”±äº SQL update çš„è¯­æ³•é—®é¢˜ï¼Œè‹¥ set æ ‡ç­¾é‡Œé¢æ¡ä»¶å‡ä¸æ»¡è¶³ï¼Œæ­¤æ—¶ set æ ‡ç­¾ä¹Ÿä¸ä¼šæ·»åŠ ä¸Š SET å‰ç¼€ï¼Œä½†æ­¤æ—¶ SQL ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼Œæ‰€ä»¥ set æ ‡ç­¾ä¸­è¿˜æ˜¯å¾—æœ‰ä¸€ä¸ªå¿…ç„¶å­˜åœ¨çš„èµ‹å€¼ã€‚</p>
<h3 id="trim-å®ä¾‹">trim å®ä¾‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUsernameAndScoreById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&#34;SET&#34;</span> <span class="na">suffixOverrides=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      username = #{username},
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      id = #{id}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/trim&gt;</span>
</span></span><span class="line"><span class="cl">  WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„ trim å®ä¾‹å®ç°äº†ä¸ set å®ä¾‹åŒæ ·çš„åŠŸèƒ½ï¼Œset æ ‡ç­¾æ˜¯ trim æ ‡ç­¾çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚</p>
<p>trim æ ‡ç­¾å…±æœ‰ 4 ä¸ªå±æ€§ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>prefixï¼š</strong> å‰ç¼€å±æ€§ï¼Œè‹¥æ ‡ç­¾å†…ä¸ä¸ºç©ºåˆ™åœ¨ SQL ä¸­æ·»åŠ ä¸Šå‰ç¼€ï¼›</li>
<li><strong>prefixOverridesï¼š</strong> å‰ç¼€è¦†ç›–å±æ€§ï¼Œè‹¥æ ‡ç­¾ä¸­æœ‰å¤šä½™çš„å‰ç¼€ï¼Œå°†ä¼šè¢«è¦†ç›–ï¼ˆå…¶å®å°±æ˜¯ä¸¢å¼ƒè¯¥å‰ç¼€ï¼‰ï¼›</li>
<li><strong>suffixï¼š</strong> åç¼€å±æ€§ï¼Œè‹¥æ ‡ç­¾å†…ä¸ä¸ºç©ºåˆ™åœ¨ SQL ä¸­æ·»åŠ ä¸Šåç¼€ï¼›</li>
<li><strong>suffixOverridesï¼š</strong> åç¼€è¦†ç›–å±æ€§ï¼Œè‹¥æ ‡ç­¾ä¸­æœ‰å¤šä½™çš„åç¼€ï¼Œå°†ä¼šè¢«è¦†ç›–ï¼ˆå…¶å®å°±æ˜¯ä¸¢å¼ƒè¯¥åç¼€ï¼‰ã€‚</li>
</ul>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œtrim æ ‡ç­¾çš„å‰ç¼€ä¸º<code>SET</code>ï¼Œåç¼€è¦†ç›–å±æ€§ä¸º<code>,</code>ï¼Œæ‰€ä»¥åœ¨æ ‡ç­¾å†…ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ç»™ SQL è¯­å¥æ·»åŠ äº† SET å…³é”®å­—ï¼Œä¸”æ ‡ç­¾å†…è‹¥æœ‰å¤šä½™çš„<code>,</code>åç¼€ä¹Ÿä¼šè¢«ä¸¢å¼ƒã€‚</p>
<h2 id="å®è·µ-8">å®è·µ</h2>
<h3 id="ä¾‹1-åŠ¨æ€æ’å…¥ç”¨æˆ·">ä¾‹1. åŠ¨æ€æ’å…¥ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨åŠ¨æ€æ’å…¥ç”¨æˆ·çš„åŠŸèƒ½ï¼Œè‹¥ç”¨æˆ·å±æ€§å€¼ä¸ä¸º null åˆ™æ’å…¥è¯¥å­—æ®µï¼Œå¦åˆ™ä¸æ’å…¥å­—æ®µã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨ UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ åŠ¨æ€æ’å…¥ç”¨æˆ·çš„ insert æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  insert æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ trim æ ‡ç­¾æ¥åŠ¨æ€åˆ¤æ–­å±æ€§æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºåˆ™æ’å…¥è¯¥å­—æ®µã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUserDynamic&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO imooc_user
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&#34;(&#34;</span> <span class="na">suffix=</span><span class="s">&#34;)&#34;</span> <span class="na">suffixOverrides=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      username,
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;age != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      age,
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;score != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      score,
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/trim&gt;</span>
</span></span><span class="line"><span class="cl">  VALUES
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&#34;(&#34;</span> <span class="na">suffix=</span><span class="s">&#34;)&#34;</span> <span class="na">suffixOverrides=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;username != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      #{username},
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;age != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      #{age},
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;score != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      #{score},
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/trim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ª trim æ ‡ç­¾ï¼Œä¸€ä¸ªç”¨æ¥åŠ¨æ€å†™å…¥å­—æ®µåï¼Œå¦ä¸€ä¸ªç”¨æ¥åŠ¨æ€å†™å…¥å­—æ®µå€¼ï¼›trim æ ‡ç­¾çš„å‰ç¼€ä¸º<code>(</code>,åç¼€ä¸º<code>)</code>ï¼Œå½“å‡ºç°å¤šä½™çš„<code>,</code>æ—¶ï¼Œä¼šé€šè¿‡åç¼€è¦†ç›–å±æ€§æ¥ä¸¢å¼ƒã€‚</p>
<p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="nf">insertUserDynamic</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ insertUserDynamic è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;dynamic&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUserDynamic</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>TIPS:</strong> æ³¨æ„ï¼Œåœ¨ usernameã€score å’Œ age å‡ä¸º null æ—¶ï¼Œ insertUserDynamic ä¼šæŠ¥ SQL è¯­æ³•é”™è¯¯ï¼Œä½†ç†è®ºä¸Šè‹¥æ˜¯æ‰€æœ‰å±æ€§å‡ä¸ºç©ºï¼Œé‚£ä¹ˆä¹Ÿä¸åº”è¯¥æ’å…¥ã€‚</p>
</blockquote>
<h2 id="å°ç»“-11">å°ç»“</h2>
<ul>
<li>whereã€set ä»¥åŠ trim å°† MyBatis çš„åŠ¨æ€ SQL å‘æŒ¥åˆ°äº†æè‡´ï¼Œä¸ºå¼€å‘è€…èŠ‚çœäº†å¤§é‡çš„ç²¾åŠ›å’Œæ—¶é—´ã€‚</li>
<li>trim æ ‡ç­¾æ˜¯ MyBatis ä¸­æœ€ä¸ºå¼ºå¤§çš„ä¸€ä¸ªæ ‡ç­¾ï¼Œä½¿ç”¨å®ƒå¯ä»¥æ–¹ä¾¿çš„å®Œæˆ SQL åŠ¨æ€æ’å…¥å’ŒåŠ¨æ€æ›´æ–°ã€‚</li>
</ul>
<h1 id="mybatis-foreach">MyBatis foreach</h1>
<h2 id="å‰è¨€-12">å‰è¨€</h2>
<p>åœ¨ MyBatis ä¸­ï¼Œå¸¸å¸¸ä¼šé‡åˆ°é›†åˆç±»å‹çš„å‚æ•°ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ OGNL è¡¨è¾¾å¼æ¥è®¿é—®é›†åˆçš„æŸä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯ OGNL è¡¨è¾¾å¼æ— æ³•éå†é›†åˆã€‚foreach æ ‡ç­¾å°±æ˜¯ä¸“é—¨ç”¨æ¥è§£å†³è¿™ç±»é—®é¢˜çš„ï¼Œæœ¬å°èŠ‚æˆ‘ä»¬å°±æ¥ä¸€èµ·å­¦ä¹ å®ƒã€‚</p>
<h2 id="å®šä¹‰-10">å®šä¹‰</h2>
<blockquote>
<p><code>foreach</code> æ ‡ç­¾ç”¨æ¥éå†æ•°ç»„ã€åˆ—è¡¨å’Œ Map ç­‰é›†åˆå‚æ•°ï¼Œå¸¸ä¸ in å…³é”®å­—æ­é…ä½¿ç”¨ã€‚</p>
</blockquote>
<h2 id="å®ä¾‹-9">å®ä¾‹</h2>
<p>æˆ‘ä»¬ä»¥ 3 ä¸ªä¾‹å­æ¥çœ‹ä¸€çœ‹ foreach æ˜¯å¦‚ä½•éå†åˆ—è¡¨ã€æ•°ç»„å’Œ Map çš„ã€‚</p>
<h3 id="éå†åˆ—è¡¨">éå†åˆ—è¡¨</h3>
<p>xmlï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserInIds&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE id IN
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;list&#34;</span> <span class="na">open=</span><span class="s">&#34;(&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span> <span class="na">item=</span><span class="s">&#34;item&#34;</span> <span class="na">index=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    #{item}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Javaï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">selectUserInIds</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢æ˜¯ selectUserInIds æ–¹æ³•åœ¨ java å’Œ xml ä¸­å¯¹åº”çš„ä»£ç æ®µã€‚</p>
<p>foreach æ ‡ç­¾å…±æœ‰ 6 ä¸ªå±æ€§ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«ä¸ºï¼š</p>
<ul>
<li><strong>collectionï¼š</strong> è¢«éå†é›†åˆå‚æ•°çš„åç§°ï¼Œå¦‚ listï¼›</li>
<li><strong>openï¼š</strong> éå†å¼€å§‹æ—¶æ’å…¥åˆ° SQL ä¸­çš„å­—ç¬¦ä¸²ï¼Œå¦‚ ( ï¼›</li>
<li><strong>closeï¼š</strong> éå†ç»“æŸæ—¶æ’å…¥åˆ° SQL ä¸­çš„å­—ç¬¦ä¸²ï¼Œå¦‚ ) ï¼›</li>
<li><strong>separatorï¼š</strong> åˆ†å‰²ç¬¦ï¼Œåœ¨æ¯ä¸ªå…ƒç´ çš„åé¢éƒ½ä¼šæ’å…¥åˆ†å‰²ç¬¦ï¼›</li>
<li><strong>itemï¼š</strong> å…ƒç´ å€¼ï¼Œéå†é›†åˆæ—¶å…ƒç´ çš„å€¼ï¼›</li>
<li><strong>indexï¼š</strong> å…ƒç´ åºåˆ—ï¼Œéå†é›†åˆæ—¶å…ƒç´ çš„åºåˆ—ã€‚</li>
</ul>
<p>å½“ selectUserInIds æ–¹æ³•çš„å‚æ•° ids ä¸º<code>Arrays.asList(1, 2)</code>æ—¶ï¼Œç”Ÿæˆçš„ SQL è¯­å¥ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">SELECT * FROM imooc_user WHERE id IN ( 1 , 2 ) 
</span></span></code></pre></td></tr></table>
</div>
</div><p>foreach æ ‡ç­¾çš„ collection å±æ€§åœ¨æ¥å—å‚æ•°åæœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ã€åŒ¿åå‚æ•°ï¼Œå½“åœ¨ java æ–¹æ³•ä¸­æ²¡æœ‰é€šè¿‡ @Param æ³¨è§£æŒ‡å®šå‚æ•°åæ—¶ï¼Œåˆ—è¡¨ç±»å‹çš„ä½¿ç”¨é»˜è®¤å‚æ•°å listã€‚äºŒã€å…·åå‚æ•°ï¼Œjava æ–¹æ³•ä¸­ä½¿ç”¨äº†@Param æ³¨è§£æŒ‡å®šäº†å‚æ•°åç§°ï¼Œåˆ™ foreach ä¸­çš„ collection å±æ€§å¿…é¡»ä¸ºå‚æ•°åï¼Œå¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">selectUserInIds</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;ids&#34;</span><span class="o">)</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">foreach</span> <span class="n">collection</span><span class="o">=</span><span class="s">&#34;ids&#34;</span> <span class="n">open</span><span class="o">=</span><span class="s">&#34;(&#34;</span> <span class="n">close</span><span class="o">=</span><span class="s">&#34;)&#34;</span> <span class="n">separator</span><span class="o">=</span><span class="s">&#34;,&#34;</span> <span class="n">item</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="n">index</span><span class="o">=</span><span class="s">&#34;index&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="err">#</span><span class="o">{</span><span class="n">item</span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">foreach</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬æ¨èä½ ä¸ºåˆ—è¡¨ç±»å‹å‚æ•°ç”¨æ³¨è§£æŒ‡å®šä¸€ä¸ªåç§°ï¼Œè®©ä½¿ç”¨è¯¥åç§°æ¥éå†ï¼Œæ–¹ä¾¿ä»£ç ç»´æŠ¤å’Œé˜…è¯»ã€‚</p>
<h3 id="éå†æ•°ç»„">éå†æ•°ç»„</h3>
<p>å½“ Java æ–¹æ³•ä½¿ç”¨çš„å‚æ•°ç±»å‹ä¸ºæ•°ç»„æ—¶ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">selectUserInIds</span><span class="o">(</span><span class="n">Integer</span><span class="o">[]</span> <span class="n">ids</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœ ids å‚æ•°ä½¿ç”¨ @Param æ³¨è§£æŒ‡å®šäº†å‚æ•°åç§°ï¼Œåˆ™ foreach æ ‡ç­¾ä¸­çš„ collection å±æ€§å¿…é¡»ä¸ºè¯¥åç§°ï¼›ä½†è‹¥æœªæŒ‡å®šåç§°ï¼Œåˆ™åœ¨ foreach æ ‡ç­¾ä¸­ä½¿ç”¨é»˜è®¤æ•°ç»„åç§° arrayï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserInIds&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE id IN
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;array&#34;</span> <span class="na">open=</span><span class="s">&#34;(&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span> <span class="na">item=</span><span class="s">&#34;item&#34;</span> <span class="na">index=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    #{item}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="éå†-map">éå† Map</h3>
<p>å½“ Java æ–¹æ³•ä½¿ç”¨çš„å‚æ•°ç±»å‹ä¸º Map æ—¶ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">updateUserById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;params&#34;</span><span class="o">)</span> <span class="n">Map</span> <span class="n">map</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ foreach æ ‡ç­¾éå† Map æ—¶ï¼Œcollection å±æ€§å€¼ä¸ºæ³¨è§£æŒ‡å®šçš„å‚æ•°åï¼Œå³ paramsï¼Œä¸” item æ˜¯ Map çš„é”®å€¼ï¼Œindex æ˜¯é”®åã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUserById&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  UPDATE imooc_user
</span></span><span class="line"><span class="cl">  SET
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;params&#34;</span> <span class="na">item=</span><span class="s">&#34;val&#34;</span> <span class="na">index=</span><span class="s">&#34;key&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    ${key} = #{val}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl">  WHERE id = #{id}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ³¨æ„ï¼š</strong> ç”±äº key æ˜¯å­—æ®µåç§°ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨<code>#{}</code>ä½œä¸ºå ä½ç¬¦ï¼Œåªèƒ½ä½¿ç”¨<code>${}</code>åœ¨å­—ç¬¦ä¸²ä¸­æ›¿æ¢ã€‚</p>
<p>updateUserById ç”Ÿæˆçš„ SQL è¯­å¥å¤§è‡´å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">imooc_user</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å®è·µ-9">å®è·µ</h2>
<h3 id="ä¾‹1-ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çš„åŠŸèƒ½ï¼Œå‚æ•°ä¸ºä¸€ä¸ªåç§°åˆ—è¡¨ï¼Œä½¿ç”¨ in å…³é”®å­—è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>æŒ‰ç…§ MyBatis çš„å¼€å‘æ¨¡å¼ï¼Œå…ˆåœ¨ UserMapper.xml æ–‡ä»¶ä¸­æ·»åŠ ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çš„ select æ ‡ç­¾ï¼Œç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  select æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ foreach æ ‡ç­¾æ¥éå†åç§°åˆ—è¡¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserInNames&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.ahao.mybatis.model.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  SELECT * FROM imooc_user
</span></span><span class="line"><span class="cl">  WHERE username IN
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;names&#34;</span> <span class="na">open=</span><span class="s">&#34;(&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span> <span class="na">item=</span><span class="s">&#34;item&#34;</span> <span class="na">index=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    #{item}
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">selectUserInNames</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;names&#34;</span><span class="o">)</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUserInNames è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserInNames</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;pedro&#34;</span><span class="o">,</span> <span class="s">&#34;peter&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">users</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>User<span class="o">{</span><span class="nv">id</span><span class="o">=</span>1, <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;peter&#39;</span>, <span class="nv">age</span><span class="o">=</span>18, <span class="nv">score</span><span class="o">=</span>100<span class="o">}</span>, User<span class="o">{</span><span class="nv">id</span><span class="o">=</span>2, <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;pedro&#39;</span>, <span class="nv">age</span><span class="o">=</span>24, <span class="nv">score</span><span class="o">=</span>200<span class="o">}]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¾‹2-æ‰¹é‡æ’å…¥ç”¨æˆ·">ä¾‹2. æ‰¹é‡æ’å…¥ç”¨æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨æ‰¹é‡æ’å…¥ç”¨æˆ·çš„åŠŸèƒ½ï¼Œå‚æ•°ä¸ºä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>åŒä¸Šã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>é¦–å…ˆï¼Œåœ¨ UserMapper.xml ä¸­æ·»åŠ  insert æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾ä¸­å†™å…¥ SQLï¼Œä½¿ç”¨ foreach æ ‡ç­¾æ¥éå†ç”¨æˆ·åˆ—è¡¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertUsers&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  INSERT INTO imooc_user(username,age,score)
</span></span><span class="line"><span class="cl">  VALUES
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;users&#34;</span> <span class="na">item=</span><span class="s">&#34;user&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    (#{user.username}, #{user.age}, #{user.score})
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œè¿™é‡Œéå† users å¾—åˆ°çš„å•ä½æ˜¯ userï¼Œuser æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å¿…é¡»é€šè¿‡ OGNL è¡¨è¾¾å¼æ¥å– user çš„å±æ€§ã€‚</p>
<p>ç„¶ååœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="nf">insertUsers</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;users&#34;</span><span class="o">)</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ insertUsers è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">User</span> <span class="n">user1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">user1</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;user1&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user1</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user1</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">user2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">user2</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;user2&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user2</span><span class="o">.</span><span class="na">setScore</span><span class="o">(</span><span class="n">210</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">user2</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUsers</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">user1</span><span class="o">,</span> <span class="n">user2</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-12">å°ç»“</h2>
<ul>
<li>foreach æ ‡ç­¾æ˜¯ä½¿ç”¨éå¸¸å¹¿æ³›çš„ä¸€ä¸ªæ ‡ç­¾ï¼Œå½“ä½¿ç”¨ SQL è¿›è¡Œæ‰¹é‡æ’å…¥ã€æŸ¥è¯¢æ—¶éƒ½éœ€è¦ä½¿ç”¨åˆ°å®ƒã€‚</li>
<li>åˆ—è¡¨éå†çš„ä½¿ç”¨æœ€ä¸ºå¹¿æ³›ï¼Œæ•°ç»„å’Œ Map åˆ™ç›¸å¯¹è¾ƒå°‘ã€‚</li>
</ul>
<h1 id="mybatis-script">MyBatis script</h1>
<h2 id="å‰è¨€-13">å‰è¨€</h2>
<p>å‰é¢ä¸€ç³»åˆ—åŠ¨æ€ SQL å°èŠ‚çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨ xml ä¸­ä¹¦å†™ SQL çš„ã€‚æ³¨è§£æ— æ³•å‘æŒ¥ MyBatis åŠ¨æ€ SQL çš„çœŸæ­£å¨åŠ›ï¼Œä½†æ˜¯ ifã€chooseã€bindã€where ç­‰æ ‡ç­¾è¿˜æ˜¯å¯ä»¥åœ¨æ³¨è§£ä¸­ä½¿ç”¨çš„ã€‚</p>
<p>MyBatis å®˜æ–¹æ–‡æ¡£å¯¹äºæ­¤çš„ä»‹ç»åªæœ‰å¯¥å¯¥ä¸€å¥è¯å’Œä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ä¹Ÿå‡ ä¹æ²¡æœ‰äººè¿™æ ·å»åšï¼Œå› ä¸ºå®ƒç¡®å®ä¸å¤ªç¾è§‚ï¼Œä½†æ˜¯è€ƒè™‘åˆ°è¿™ä¸ªçŸ¥è¯†ç‚¹å¹¶ä¸å¤æ‚ï¼Œä¹Ÿææœ‰å¯èƒ½æˆä¸ºä¸€ä¸ªåˆé’»çš„é¢è¯•ç‚¹ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<h2 id="å®ä¾‹-10">å®ä¾‹</h2>
<p>åœ¨æ³¨è§£ä¸­ä½¿ç”¨åŠ¨æ€ SQL å…¶å®ååˆ†ç®€å•ï¼Œåªéœ€åœ¨åŠ¨æ€ SQL è¯­å¥çš„å¤–é¢åŒ…ä¸Šä¸€å±‚<code>script</code>æ ‡ç­¾å³å¯ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">({</span><span class="s">&#34;&lt;script&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;SELECT * FROM imooc_user&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;    WHERE&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;    &lt;choose&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;when test=&#39;id != null&#39;&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;        id = #{id}&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;/when&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;when test=&#39;username != null&#39;&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;        username = #{username}&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;/when&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;otherwise&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;        1 = 0&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;      &lt;/otherwise&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;    &lt;/choose&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;&lt;/script&gt;&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="nf">selectUserByIdOrName</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ Select æ³¨è§£ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥å†™å…¥ SQLï¼Œè€Œæ˜¯åœ¨æœ€å¤–å±‚å¥—ä¸Šä¸€ä¸ª script æ ‡ç­¾ï¼Œè¿™é‡Œè€ƒè™‘åˆ° SQL è¯­å¥çš„ç¾è§‚æ€§ï¼Œæˆ‘ä»¬æŠŠè¯­å¥åˆ†æˆäº†å­—ç¬¦ä¸²æ•°ç»„æ¥ä¹¦å†™ï¼ŒMyBatis ä¼šè‡ªåŠ¨å°†å…¶æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´çš„è¯­å¥ã€‚</p>
<h2 id="å®è·µ-10">å®è·µ</h2>
<h3 id="ä¾‹1-æŸ¥è¯¢å°å†™åç§°å®¢æˆ·">ä¾‹1. æŸ¥è¯¢å°å†™åç§°å®¢æˆ·</h3>
<p>è¯·ä½¿ç”¨ MyBatis å®Œæˆå¯¹ imooc_user è¡¨æŸ¥è¯¢å°å†™åç§°å®¢æˆ·çš„åŠŸèƒ½ï¼Œå°†åç§°å°å†™åå†è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>ä½¿ç”¨æœ¬å°èŠ‚æ‰€å­¦çš„çŸ¥è¯†ï¼Œç›´æ¥åœ¨ UserMapper.java æ¥å£ä¸Šæ·»åŠ æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ Select æ³¨è§£å³å¯ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>åœ¨ UserMapper.java ä¸­æ·»åŠ ä¸Šå¯¹åº”çš„æ¥å£æ–¹æ³•ï¼Œæ–¹æ³•æ¥å— username ä¸€ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.ahao.mybatis.mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.ahao.mybatis.model.User</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nd">@Select</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;&lt;script&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;&lt;bind name=\&#34;lowercaseName\&#34; value=\&#34;username.toLowercase\&#34;/&gt;&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;SELECT * FROM imooc_user&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;WHERE username = #{lowercaseName}&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;&lt;/script&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">})</span>
</span></span><span class="line"><span class="cl">  <span class="n">User</span> <span class="nf">selectUsernameLowercase</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç»“æœï¼š</strong></p>
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬è¿è¡Œ selectUsernameLowercase è¿™ä¸ªæ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span> <span class="n">pedro</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUsernameLowercase</span><span class="o">(</span><span class="s">&#34;PEDRO&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pedro</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆåŠŸåï¼Œç»“æœä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">User<span class="o">{</span><span class="nv">id</span><span class="o">=</span>2, <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;pedro&#39;</span>, <span class="nv">age</span><span class="o">=</span>24, <span class="nv">score</span><span class="o">=</span>200<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-13">å°ç»“</h2>
<ul>
<li>é€šè¿‡ scirpt æ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ³¨è§£ä¸­ä½¿ç”¨åŠ¨æ€ SQL çš„è¯¸å¤šæ ‡ç­¾ï¼Œæå¤§åœ°å¢å¼ºäº†æ³¨è§£çš„èƒ½åŠ›ï¼Œä½†ç›¸å¯¹äº xml è¿™ç§æ›´ä¸ºä¼˜é›…çš„æ–¹å¼ï¼Œæ— ç–‘æ˜¯åè€…æ›´ä½³ï¼Œå› æ­¤æˆ‘ä»¬æˆ‘ä»¬å¼ºåŠ›æ¨èä½ ä½¿ç”¨ xml çš„æ–¹å¼ã€‚</li>
</ul>
<h1 id="mybatis-é…ç½®ä»‹ç»">MyBatis é…ç½®ä»‹ç»</h1>
<h2 id="å‰è¨€-14">å‰è¨€</h2>
<p>MyBatis çš„é…ç½®ååˆ†é‡è¦ï¼Œå®ƒç›´æ¥å·¦å³ MyBatis çš„è¡Œä¸ºã€‚æˆ‘ä»¬å¯ä»¥å°† MyBatis é…ç½®åˆ†ä¸º<code>ä¸¤å¤§éƒ¨åˆ†</code>ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ mapperï¼Œä¹Ÿå°±æ˜¯å®¹çº³ SQL è¯­å¥çš„.xmlæ–‡ä»¶ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ configuration ï¼Œä¹Ÿå°±æ˜¯å‰é¢å°èŠ‚æåˆ°çš„ mybatis-config.xml æ–‡ä»¶ã€‚</p>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä»‹ç» configuration ä¸­å¸¸è§ä¸”æœ‰ç”¨çš„é…ç½®é¡¹ã€‚</p>
<h2 id="ç»“æ„">ç»“æ„</h2>
<p>MyBatis ä»¥ .xml ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œä¸”ä»¥ configuration ä½œä¸ºé…ç½®çš„æ ¹èŠ‚ç‚¹ã€‚åœ¨ configuration ä¸‹æœ‰è¯¸å¤šé…ç½®é¡¹ï¼Œå®ƒä»¬çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<p>configurationï¼ˆé…ç½®ï¼‰</p>
<ul>
<li>propertiesï¼ˆå±æ€§ï¼‰</li>
<li>settingsï¼ˆè®¾ç½®ï¼‰</li>
<li>typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</li>
<li>typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</li>
<li>objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</li>
<li>pluginsï¼ˆæ’ä»¶ï¼‰</li>
<li>environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰
<ul>
<li>environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰
<ul>
<li>transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</li>
<li>dataSourceï¼ˆæ•°æ®æºï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</li>
<li>mappersï¼ˆæ˜ å°„å™¨ï¼‰</li>
</ul>
<p>MyBatis configuration å…± 9 é¡¹ï¼Œå…¶ä¸­ä¸€äº›é…ç½®åœ¨å‰é¢çš„å°èŠ‚ä¸­å·²ç»ä»‹ç»åˆ°äº†ï¼Œä¸‹é¢æˆ‘ä»¬å°†åˆ†åˆ«ä»‹ç»æ¯ä¸€é¡¹é…ç½®ã€‚</p>
<h2 id="å±æ€§-properties">å±æ€§ properties</h2>
<p>é€šè¿‡ properties é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€äº›é‡è¦çš„é…ç½®å±æ€§<code>æŠ½ç¦»</code>åˆ°å…¶å®ƒçš„ .properties æ–‡ä»¶ã€‚</p>
<p>æ¯”å¦‚ï¼ŒdataSource ä¸­çš„æ•°æ®åº“ urlã€ç”¨æˆ·åå’Œå¯†ç ï¼Œæˆ‘ä»¬å¯ä»¥å•ç‹¬ä»¥ datasource.properties æ–‡ä»¶æ¥å­˜å‚¨ï¼Œç„¶ååœ¨ mybatis-config.xml æ–‡ä»¶ä¸­å¯¼å…¥ä½¿ç”¨ã€‚</p>
<p>åœ¨ resources ç›®å½•ä¸‹æ–°å»º datasource.properties æ–‡ä»¶ï¼Œå¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">url=jdbc:mysql://localhost:3306/imooc?useSSL=false
</span></span><span class="line"><span class="cl">username=root
</span></span><span class="line"><span class="cl">password=123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨ mybatis-config.xml æ–‡ä»¶ä¸­é€šè¿‡ properties é…ç½®æ¥å¼•å…¥ datasource.properties æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!--  å¼•å…¥datasource.properties  --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;datasource.properties&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--  å ä½ç¬¦åŠ¨æ€æ›¿æ¢é…ç½® --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ properties ä¸­çš„ resource å±æ€§å¼•å…¥ datasource.properties åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼å»åŠ¨æ€æ›¿æ¢é…ç½®ï¼Œå¦‚ <code>${url}</code>ï¼Œè¡¨ç¤ºä» datasource.properties æ–‡ä»¶ä¸­å–å‡º url é¡¹å¹¶å¡«å……åœ¨æ­¤å¤„ã€‚</p>
<p>å®ƒä»¬åœ¨ç›®å½•ä¸­çš„ä½ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">src/main/resources
</span></span><span class="line"><span class="cl">â”œâ”€â”€ datasource.properties
</span></span><span class="line"><span class="cl">â”œâ”€â”€ mybatis-config.xml
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è®¾ç½®-settings">è®¾ç½® settings</h2>
<p>MyBatis æä¾›äº† settings æ¥è®¾ç½®ä¸€äº›ä¸»è¦çš„å‚æ•°ï¼Œå®ƒä»¬ä¼šç›´æ¥çš„æ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</p>
<p>settings å…±æœ‰åå‡ é¡¹ï¼Œæˆ‘ä»¬ç½—åˆ—ä¸€äº›å¸¸ç”¨çš„ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">è®¾ç½®å</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">å¯é€‰å€¼</th>
<th style="text-align:left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">cacheEnabled</td>
<td style="text-align:left">å…¨å±€åœ°å¼€å¯æˆ–å…³é—­æ‰€æœ‰ mapper ä¸­çš„ç¼“å­˜</td>
<td style="text-align:left">true | false</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">lazyLoadingEnabled</td>
<td style="text-align:left">å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³ï¼Œå½“å¼€å¯æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå»¶è¿ŸåŠ è½½</td>
<td style="text-align:left">true | false</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">defaultStatementTimeout</td>
<td style="text-align:left">è®¾ç½®æ•°æ®åº“æŸ¥è¯¢è¶…æ—¶æ—¶é—´</td>
<td style="text-align:left">ä»»æ„æ­£æ•´æ•°</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">mapUnderscoreToCamelCase</td>
<td style="text-align:left">æ˜¯å¦å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™ï¼ˆcamel caseï¼‰æ˜ å°„</td>
<td style="text-align:left">true ï½œfalse</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">localCacheScope</td>
<td style="text-align:left">MyBatisä¼šé»˜è®¤ç¼“å­˜ä¼šè¯ä¸­çš„æŸ¥è¯¢ï¼Œå³ SESSIONï¼Œè‹¥æ— éœ€ç¼“å­˜åˆ™è®¾ç½®ä¸º STATEMENT</td>
<td style="text-align:left">SESSION ï½œ STATEMENT</td>
<td style="text-align:left">SESSION</td>
</tr>
<tr>
<td style="text-align:left">defaultEnumTypeHandler</td>
<td style="text-align:left">æŒ‡å®š Enum ä½¿ç”¨çš„é»˜è®¤ TypeHandler</td>
<td style="text-align:left">Java ç±»çš„å…¨è·¯å¾„</td>
<td style="text-align:left">org.apache.ibatis. type.EnumTypeHandler</td>
</tr>
<tr>
<td style="text-align:left">logPrefix</td>
<td style="text-align:left">æŒ‡å®š MyBatis æ—¥å¿—åç§°å‰ç¼€</td>
<td style="text-align:left">ä»»ä½•å­—ç¬¦ä¸²</td>
<td style="text-align:left">æœªè®¾ç½®</td>
</tr>
<tr>
<td style="text-align:left">logImpl</td>
<td style="text-align:left">æŒ‡å®š MyBatis æ—¥å¿—çš„å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾</td>
<td style="text-align:left">SLF4J ï½œ LOG4Jï½œLOG4J2ï½œJDK_LOGGINGï½œCOMMONS_LOGGINGï½œSTDOUT_LOGGINGï½œNO_LOGGING</td>
<td style="text-align:left">æœªè®¾ç½®</td>
</tr>
<tr>
<td style="text-align:left">proxyFactory</td>
<td style="text-align:left">æŒ‡å®š Mybatis åˆ›å»ºå…·æœ‰å»¶è¿ŸåŠ è½½èƒ½åŠ›çš„å¯¹è±¡æ‰€ç”¨åˆ°çš„ä»£ç†å·¥å…·</td>
<td style="text-align:left">CGLIB ï½œ JAVASSIST</td>
<td style="text-align:left">JAVASSIST</td>
</tr>
</tbody>
</table></div>
<p>å½“ä½¿ç”¨å®ƒä»¬æ—¶ï¼Œä½ åªéœ€è¦åœ¨ mybatis-config.xml é…ç½®æ–‡ä»¶ä¸­æ‰“å¼€ç›¸åº”çš„é…ç½®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¼€å¯äº†ä¸‹åˆ’çº¿è½¬é©¼å³°çš„é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/settings&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åˆ«å-typealiases">åˆ«å typeAliases</h2>
<p>MyBatis åœ¨æŒ‡å®š Java ç±»æ—¶éœ€è¦ä½¿ç”¨åˆ°ç±»çš„å…¨è·¯å¾„ï¼Œå¦‚ com.ahao.mybatis.model.Blogï¼ŒtypeAliases å¯ä»¥ä¸ºå…¨è·¯å¾„å®šä¹‰ä¸€ä¸ªåˆ«åï¼Œè¿™æ ·å°±èƒ½å‡å°‘ä¸€å®šçš„é‡å¤å·¥ä½œã€‚</p>
<p>ä¾‹å¦‚ï¼Œå°† com.ahao.mybatis.model.Blog çš„åˆ«åå®šä¹‰ä¸º Blogï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;typeAliases&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">&#34;com.ahao.mybatis.model.Blog&#34;</span> <span class="na">alias=</span><span class="s">&#34;Blog&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/typeAliases&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>MyBatis è¿˜æ”¯æŒä¸ºä¸€ä¸ªåŒ…ä¸‹æ‰€æœ‰ç±»å®šä¹‰åˆ«åï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;typeAliases&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.ahao.mybatis.model&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/typeAliases&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·åœ¨ com.ahao.mybatis.model åŒ…ä¸­çš„æ‰€æœ‰ç±»éƒ½æœ‰äº†åˆ«åï¼Œæ¯ä¸ªç±»çš„åˆ«åéƒ½æ˜¯å…¶ç±»çš„åç§°é¦–å­—æ¯å°å†™ï¼Œå¦‚ Author ç±»çš„åˆ«åä¸º authorã€‚</p>
<h2 id="ç±»å‹å¤„ç†å™¨-typehandlers">ç±»å‹å¤„ç†å™¨ typeHandlers</h2>
<p>ç±»å‹å¤„ç†å™¨æˆ‘ä»¬å°†åœ¨ç±»å‹å¤„ç†å™¨å°èŠ‚ä¸­å†è¯¦ç»†ä»‹ç»ã€‚</p>
<h2 id="å¯¹è±¡å·¥å‚-objectfactory">å¯¹è±¡å·¥å‚ objectFactory</h2>
<p>MyBatis æ¯æ¬¡åˆ›å»ºç»“æœå¯¹è±¡çš„æ–°å®ä¾‹æ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼ˆObjectFactoryï¼‰æ¥å®Œæˆã€‚MyBatis é»˜è®¤çš„å¯¹è±¡å·¥å‚ä»…ä»…åªæ˜¯å®ä¾‹åŒ–ç›®æ ‡ç±»ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¯¹è±¡å·¥å‚ç±»æ¥è¦†ç›–é»˜è®¤çš„å¯¹è±¡å·¥å‚ã€‚</p>
<p>é…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;objectFactory</span> <span class="na">type=</span><span class="s">&#34;org.mybatis.example.ExampleObjectFactory&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ“ä½œéƒ½æ˜¯æå…¶å±é™©çš„ï¼Œæ”¹å˜äº† MyBatis é»˜è®¤çš„å¯¹è±¡åˆ›å»ºè¡Œä¸ºå¯èƒ½ä¼šå¸¦æ¥ä¸€å®šçš„å…¼å®¹é”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åšè¿‡å¤šä»‹ç»ï¼Œå¦‚æœä½ ç¡®å®éœ€è¦å®ƒï¼Œå¯ä»¥æŸ¥é˜…ç›¸å…³çš„èµ„æ–™ã€‚</p>
<h2 id="æ’ä»¶-plugins">æ’ä»¶ plugins</h2>
<p>æ’ä»¶æˆ‘ä»¬å°†åœ¨æ’ä»¶å°èŠ‚ä¸­å†è¯¦ç»†ä»‹ç»ã€‚</p>
<h2 id="ç¯å¢ƒé…ç½®-environments">ç¯å¢ƒé…ç½® environments</h2>
<p>ç¯å¢ƒé…ç½®æ˜¯æœ€ä¸ºå¤æ‚çš„ä¸€é¡¹é…ç½®ï¼ŒMyBatis æä¾›äº†å¤šç¯å¢ƒé…ç½®æœºåˆ¶ï¼Œä¾‹å¦‚ï¼šå¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸Šçš„æ•°æ®åº“é…ç½®å°±å¤§æ¦‚ç‡ä¸ä¸€æ ·ã€‚</p>
<p>æ¯ä¸ª environment éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ id å­—æ®µï¼Œä¸” environments éœ€è¦æä¾›ä¸€ä¸ªé»˜è®¤ç¯å¢ƒï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/imooc?useSSL=false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨æ¯ä¸ª environment ä¸‹åˆæœ‰ä¸¤ä¸ªå­é…ç½®é¡¹ï¼Œå®ƒä»¬åˆ†åˆ«è´Ÿè´£ç®¡ç†äº‹åŠ¡å’Œæ•°æ®æºã€‚</p>
<h3 id="äº‹åŠ¡ç®¡ç†å™¨-transactionmanager">äº‹åŠ¡ç®¡ç†å™¨ transactionManager</h3>
<p>åœ¨ xml æ–‡ä»¶ä¸­å¯¹åº” <code>&lt;transactionManager type=&quot;JDBC&quot;/&gt;</code>ï¼Œå…¶ä¸­ type å±æ€§å¯¹åº”äº†äº‹åŠ¡ç®¡ç†å™¨çš„ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯JDBCå’ŒMANAGEDã€‚</p>
<ul>
<li>JDBC ï¼šç›´æ¥ä½¿ç”¨äº† JDBC çš„æäº¤å’Œå›æ»šæœºåˆ¶ã€‚</li>
<li>MANAGEDï¼šè®©å®¹å™¨æ¥ç®¡ç†äº‹åŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œä¾‹å¦‚ spring å®¹å™¨ã€‚</li>
</ul>
<blockquote>
<p><strong>æç¤ºï¼š</strong> å¦‚æœä½ ä½¿ç”¨ spring ä½œä¸ºå®¹å™¨ï¼Œé‚£ä¹ˆ transactionManager ä¼šè¢«è‡ªåŠ¨é…ç½®ä¸”å¯ç”¨ã€‚</p>
</blockquote>
<h3 id="æ•°æ®æº-datasource">æ•°æ®æº dataSource</h3>
<p>åœ¨ xml æ–‡ä»¶ä¸­å¯¹åº”<code>&lt;dataSource type=&quot;POOLED&quot;&gt;</code>ï¼Œå…¶ä¸­ type å±æ€§ä»£è¡¨äº†æ•°æ®æºçš„ç±»å‹ï¼Œå¯é€‰çš„æœ‰ä¸‰ç§ç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>UNPOOLEDï¼šéæ± åŒ–æ•°æ®æºï¼Œæ¯æ¬¡ä½¿ç”¨æ—¶æ‰“å¼€ï¼Œç»“æŸåå…³é—­ï¼Œä¸æ¨èã€‚</li>
<li>POOLEDï¼šæ± åŒ–æ•°æ®æºï¼Œè¿æ¥æ± ç®¡ç†è¿æ¥ï¼Œæ¨èã€‚</li>
<li>JNDIï¼šåœ¨ EJB è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨ï¼Œå‡ ä¹ä¸ç”¨ã€‚</li>
</ul>
<h2 id="æ•°æ®åº“å‚å•†æ ‡è¯†-databaseidprovider">æ•°æ®åº“å‚å•†æ ‡è¯† databaseIdProvider</h2>
<p>å¤šæ•°æ®æºæ”¯æŒæˆ‘ä»¬å°†åœ¨å¤šæ•°æ®æºæ”¯æŒå°èŠ‚ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<h2 id="æ˜ å°„å™¨-mappers">æ˜ å°„å™¨ mappers</h2>
<p>é€šè¿‡ mappers é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæ‰€å¯¹åº” SQL æ˜ å°„æ–‡ä»¶ï¼Œè¿™æ · MyBatis æ‰èƒ½æ‰¾åˆ°å¦ä¸€éƒ¨åˆ†çš„ SQL é…ç½®æ–‡ä»¶ã€‚</p>
<p>mappers å¯ä»¥åŒ…å«å¤šä¸ª mapperï¼Œmapper çš„åŠ è½½å…±æœ‰ <code>4</code> ç§æ–¹å¼ã€‚</p>
<h3 id="ç›¸å¯¹ç±»è·¯å¾„">ç›¸å¯¹ç±»è·¯å¾„</h3>
<p>é€šè¿‡ resource å±æ€§æŒ‡å®š mapper .xml æ–‡ä»¶æ‰€å¯¹åº”çš„ç±»è·¯å¾„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/imooc/mybatis/mapper/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="urlè·¯å¾„">URLè·¯å¾„</h3>
<p>é€šè¿‡ url å±æ€§æŒ‡å®š mapper .xml æ–‡ä»¶æ‰€å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;mapper</span> <span class="na">url=</span><span class="s">&#34;file:///mapper/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç±»è·¯å¾„">ç±»è·¯å¾„</h3>
<p>é€šè¿‡ class å±æ€§æŒ‡å®š mapper ç±»æ‰€å¯¹åº”çš„ç±»è·¯å¾„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.ahao.mybatis.mapper.UserMapper&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŒ…è·¯å¾„">åŒ…è·¯å¾„</h3>
<p>é€šè¿‡åˆ¶å®šåŒ…è·¯å¾„ï¼Œå°†åŒ…ä¸­çš„æ‰€æœ‰æ¥å£ç±»è‡ªåŠ¨æ‰«æä¸º mapperã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.ahao.mybatis.mapper&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°ç»“-14">å°ç»“</h2>
<ul>
<li>MyBatis çš„é…ç½®æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œæœ¬å°èŠ‚åˆ—ä¸¾äº†ä¸€äº›<code>å¸¸ç”¨ä¸”é‡è¦</code>çš„é…ç½®ï¼Œå¦‚æœä½ è¿˜ä¸æ»¡è¶³ï¼Œå¯ä»¥é˜…è¯»è¿™é‡Œçš„å®˜æ–¹<a class="link" href="https://mybatis.org/mybatis-3/zh/configuration.html#properties"  target="_blank" rel="noopener"
    >é…ç½®æ–‡æ¡£</a>ã€‚</li>
<li>MyBatis çš„å¦ä¸€éƒ¨åˆ† SQL é…ç½®è™½ç„¶åˆ†æ•£åœ¨äº†åŒ…ä¸­ï¼Œä½†é€šè¿‡ mappers è¿™ä¸ªä¸­é—´æ¡¥æ¢ï¼ŒäºŒè€…åˆç´§å¯†çš„ç»“åˆåœ¨ä¸€èµ·äº†ã€‚</li>
<li>åœ¨çœŸå®çš„å¼€å‘ä¸­ï¼Œä¼šæœ‰ä¸“é—¨çš„ç±»åº“æ¥æä¾›è¿™äº›é…ç½®ï¼Œä½†ä½ éœ€è¦äº†è§£å®ƒä»¬ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶è¿…é€Ÿä½œå‡ºååº”ã€‚</li>
</ul>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2022å¹´3æœˆ18æ—¥ 08:28 UTC
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-contents--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-contents">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/posts/mybatisplusspringboot%E7%89%88--2022/">
        
        
            <div class="article-image">
                
                    <img src="/1.jpg" loading="lazy" data-key="" data-hash="/1.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MyBatisPlus(SpringBootç‰ˆ)--2022</h2>
        </div>
    </a>
</article>
            
                
<article class="has-image">
    <a href="/posts/mybatis-%E5%AE%9E%E6%88%98%E7%AF%87/">
        
        
            <div class="article-image">
                
                    <img src="/20.jpg" loading="lazy" data-key="" data-hash="/20.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MyBatis å®æˆ˜ç¯‡</h2>
        </div>
    </a>
</article>
            
                
<article class="has-image">
    <a href="/posts/mybatis-%E9%AB%98%E7%BA%A7%E7%AF%87/">
        
        
            <div class="article-image">
                
                    <img src="/19.jpg" loading="lazy" data-key="" data-hash="/19.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MyBatis é«˜çº§ç¯‡</h2>
        </div>
    </a>
</article>
            
        </div>
    </div>
</aside>

     
    
        
    <script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
    .waline-container .vcount {
        color: var(--card-text-color-main);
    }
</style><script>
    
    new Waline({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tieba","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/alus"],"lang":"zh-CN","locale":{"admin":"Admin"},"requiredMeta":["name","email","url"],"serverURL":"https://blog-api-2w7xkqg6y-ahaomin.vercel.app/","visitor":true});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 ahao&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.10.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#æ–°å»ºé¡¹ç›®">æ–°å»ºé¡¹ç›®</a></li>
    <li><a href="#æ·»åŠ ä¾èµ–">æ·»åŠ ä¾èµ–</a></li>
    <li><a href="#æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</a></li>
    <li><a href="#å°ç»“">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-1">å‰è¨€</a></li>
    <li><a href="#ç¼–ç¨‹å¼ä½¿ç”¨">ç¼–ç¨‹å¼ä½¿ç”¨</a>
      <ol>
        <li><a href="#å¯åŠ¨-mybatis">å¯åŠ¨ MyBatis</a></li>
        <li><a href="#ä½¿ç”¨æµç¨‹">ä½¿ç”¨æµç¨‹</a></li>
      </ol>
    </li>
    <li><a href="#é…ç½®å¼ä½¿ç”¨">é…ç½®å¼ä½¿ç”¨</a>
      <ol>
        <li><a href="#é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</a></li>
        <li><a href="#å¯åŠ¨-mybatis-1">å¯åŠ¨ MyBatis</a></li>
        <li><a href="#ä½¿ç”¨æµç¨‹-1">ä½¿ç”¨æµç¨‹</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-1">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-2">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰">å®šä¹‰</a></li>
    <li><a href="#æ–°å»º-mapper">æ–°å»º mapper</a>
      <ol>
        <li><a href="#æ³¨è§£æ–¹å¼">æ³¨è§£æ–¹å¼</a></li>
        <li><a href="#xml-æ–¹å¼">XML æ–¹å¼</a></li>
      </ol>
    </li>
    <li><a href="#ä½¿ç”¨-mapper">ä½¿ç”¨ mapper</a>
      <ol>
        <li><a href="#mapper-é…ç½®">mapper é…ç½®</a></li>
        <li><a href="#ä»£ç è°ƒç”¨">ä»£ç è°ƒç”¨</a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-2">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-3">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-1">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹">å®ä¾‹</a>
      <ol>
        <li><a href="#xml-å®ä¾‹">xml å®ä¾‹</a></li>
        <li><a href="#å‚æ•°ç¬¦å·">å‚æ•°ç¬¦å·</a></li>
        <li><a href="#æ³¨è§£å®ä¾‹">æ³¨è§£å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#select-å±æ€§">select å±æ€§</a></li>
    <li><a href="#å‚æ•°">å‚æ•°</a>
      <ol>
        <li><a href="#å¯¹è±¡å‚æ•°">å¯¹è±¡å‚æ•°</a></li>
        <li><a href="#å‚æ•°é…ç½®">å‚æ•°é…ç½®</a></li>
      </ol>
    </li>
    <li><a href="#å®è·µ">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-é€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. é€šè¿‡å¹´é¾„å’Œåˆ†æ•°æŸ¥è¯¢ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-3">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-4">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-2">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-1">å®ä¾‹</a>
      <ol>
        <li><a href="#resultmap-å®ä¾‹">resultMap å®ä¾‹</a>
          <ol>
            <li><a href="#xml-å®ä¾‹-1">xml å®ä¾‹</a></li>
            <li><a href="#æ³¨è§£å®ä¾‹-1">æ³¨è§£å®ä¾‹</a></li>
          </ol>
        </li>
        <li><a href="#sql-å®ä¾‹">SQL å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#å®è·µ-1">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-æŸ¥è¯¢ç”¨æˆ·å§“åå’Œå¹´é¾„">ä¾‹1. æŸ¥è¯¢ç”¨æˆ·å§“åå’Œå¹´é¾„</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-4">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-5">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-3">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-2">å®ä¾‹</a>
      <ol>
        <li><a href="#xml-å®ä¾‹-2">xml å®ä¾‹</a></li>
        <li><a href="#æ³¨è§£å®ä¾‹-2">æ³¨è§£å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#insert-å±æ€§">insert å±æ€§</a></li>
    <li><a href="#è¿”å›ä¸»é”®">è¿”å›ä¸»é”®</a>
      <ol>
        <li><a href="#è‡ªå¢ä¸»é”®">è‡ªå¢ä¸»é”®</a>
          <ol>
            <li><a href="#xml-æ–¹å¼-1">xml æ–¹å¼</a></li>
            <li><a href="#æ³¨è§£æ–¹å¼-1">æ³¨è§£æ–¹å¼</a></li>
          </ol>
        </li>
        <li><a href="#selectkey-æ ‡ç­¾">selectKey æ ‡ç­¾</a>
          <ol>
            <li><a href="#xml-æ–¹å¼-2">xml æ–¹å¼</a></li>
            <li><a href="#æ³¨è§£æ–¹å¼-2">æ³¨è§£æ–¹å¼</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#å®è·µ-2">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-æ’å…¥ç”¨æˆ·">ä¾‹1. æ’å…¥ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-5">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-6">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-4">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-3">å®ä¾‹</a>
      <ol>
        <li><a href="#xml-å®ä¾‹-3">xml å®ä¾‹</a></li>
        <li><a href="#æ³¨è§£å®ä¾‹-3">æ³¨è§£å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#update-å±æ€§">update å±æ€§</a></li>
    <li><a href="#å®è·µ-3">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-æ›´æ–°ç”¨æˆ·å¹´é¾„">ä¾‹1. æ›´æ–°ç”¨æˆ·å¹´é¾„</a></li>
        <li><a href="#ä¾‹2-æ›´æ–°ç”¨æˆ·åç§°å’Œåˆ†æ•°">ä¾‹2. æ›´æ–°ç”¨æˆ·åç§°å’Œåˆ†æ•°</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-6">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-7">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-5">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-4">å®ä¾‹</a>
      <ol>
        <li><a href="#xml-å®ä¾‹-4">xml å®ä¾‹</a></li>
        <li><a href="#æ³¨è§£å®ä¾‹-4">æ³¨è§£å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#delete-å±æ€§">delete å±æ€§</a></li>
    <li><a href="#å®è·µ-4">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-æ ¹æ®-id-åˆ é™¤ç”¨æˆ·">ä¾‹1. æ ¹æ® id åˆ é™¤ç”¨æˆ·</a></li>
        <li><a href="#ä¾‹2-æ ¹æ®ç”¨æˆ·ååˆ é™¤ç”¨æˆ·">ä¾‹2. æ ¹æ®ç”¨æˆ·ååˆ é™¤ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-7">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-8">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-6">å®šä¹‰</a></li>
    <li><a href="#ä»‹ç»">ä»‹ç»</a>
      <ol>
        <li><a href="#å®ä¾‹-5">å®ä¾‹</a></li>
        <li><a href="#å¸¸è§çš„-ognl-è¡¨è¾¾å¼">å¸¸è§çš„ OGNL è¡¨è¾¾å¼</a></li>
      </ol>
    </li>
    <li><a href="#å®è·µ-5">å®è·µ</a>
      <ol>
        <li><a href="#è®¿é—®å±æ€§">è®¿é—®å±æ€§</a></li>
        <li><a href="#è®¿é—®åˆ—è¡¨">è®¿é—®åˆ—è¡¨</a></li>
        <li><a href="#æ¯”è¾ƒ">æ¯”è¾ƒ</a></li>
        <li><a href="#è¿ç®—">è¿ç®—</a></li>
        <li><a href="#æ–¹æ³•è°ƒç”¨">æ–¹æ³•è°ƒç”¨</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-8">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-9">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-7">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-6">å®ä¾‹</a></li>
    <li><a href="#å®è·µ-6">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·">ä¾‹1ã€åŠ¨æ€æŸ¥è¯¢ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å¤šæ•°æ®åº“æ”¯æŒ">å¤šæ•°æ®åº“æ”¯æŒ</a>
      <ol>
        <li><a href="#é…ç½®">é…ç½®</a></li>
        <li><a href="#ä½¿ç”¨">ä½¿ç”¨</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-9">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-10">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-8">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-7">å®ä¾‹</a></li>
    <li><a href="#å®è·µ-7">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·</a></li>
        <li><a href="#ä¾‹2-æŸ¥è¯¢å°å†™åç§°å®¢æˆ·">ä¾‹2. æŸ¥è¯¢å°å†™åç§°å®¢æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-10">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-11">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-9">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-8">å®ä¾‹</a>
      <ol>
        <li><a href="#where-å®ä¾‹">where å®ä¾‹</a></li>
        <li><a href="#set-å®ä¾‹">set å®ä¾‹</a></li>
        <li><a href="#trim-å®ä¾‹">trim å®ä¾‹</a></li>
      </ol>
    </li>
    <li><a href="#å®è·µ-8">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-åŠ¨æ€æ’å…¥ç”¨æˆ·">ä¾‹1. åŠ¨æ€æ’å…¥ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-11">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-12">å‰è¨€</a></li>
    <li><a href="#å®šä¹‰-10">å®šä¹‰</a></li>
    <li><a href="#å®ä¾‹-9">å®ä¾‹</a>
      <ol>
        <li><a href="#éå†åˆ—è¡¨">éå†åˆ—è¡¨</a></li>
        <li><a href="#éå†æ•°ç»„">éå†æ•°ç»„</a></li>
        <li><a href="#éå†-map">éå† Map</a></li>
      </ol>
    </li>
    <li><a href="#å®è·µ-9">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·">ä¾‹1. ä½¿ç”¨åç§°æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·</a></li>
        <li><a href="#ä¾‹2-æ‰¹é‡æ’å…¥ç”¨æˆ·">ä¾‹2. æ‰¹é‡æ’å…¥ç”¨æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-12">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-13">å‰è¨€</a></li>
    <li><a href="#å®ä¾‹-10">å®ä¾‹</a></li>
    <li><a href="#å®è·µ-10">å®è·µ</a>
      <ol>
        <li><a href="#ä¾‹1-æŸ¥è¯¢å°å†™åç§°å®¢æˆ·">ä¾‹1. æŸ¥è¯¢å°å†™åç§°å®¢æˆ·</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-13">å°ç»“</a></li>
  </ol>

  <ol>
    <li><a href="#å‰è¨€-14">å‰è¨€</a></li>
    <li><a href="#ç»“æ„">ç»“æ„</a></li>
    <li><a href="#å±æ€§-properties">å±æ€§ properties</a></li>
    <li><a href="#è®¾ç½®-settings">è®¾ç½® settings</a></li>
    <li><a href="#åˆ«å-typealiases">åˆ«å typeAliases</a></li>
    <li><a href="#ç±»å‹å¤„ç†å™¨-typehandlers">ç±»å‹å¤„ç†å™¨ typeHandlers</a></li>
    <li><a href="#å¯¹è±¡å·¥å‚-objectfactory">å¯¹è±¡å·¥å‚ objectFactory</a></li>
    <li><a href="#æ’ä»¶-plugins">æ’ä»¶ plugins</a></li>
    <li><a href="#ç¯å¢ƒé…ç½®-environments">ç¯å¢ƒé…ç½® environments</a>
      <ol>
        <li><a href="#äº‹åŠ¡ç®¡ç†å™¨-transactionmanager">äº‹åŠ¡ç®¡ç†å™¨ transactionManager</a></li>
        <li><a href="#æ•°æ®æº-datasource">æ•°æ®æº dataSource</a></li>
      </ol>
    </li>
    <li><a href="#æ•°æ®åº“å‚å•†æ ‡è¯†-databaseidprovider">æ•°æ®åº“å‚å•†æ ‡è¯† databaseIdProvider</a></li>
    <li><a href="#æ˜ å°„å™¨-mappers">æ˜ å°„å™¨ mappers</a>
      <ol>
        <li><a href="#ç›¸å¯¹ç±»è·¯å¾„">ç›¸å¯¹ç±»è·¯å¾„</a></li>
        <li><a href="#urlè·¯å¾„">URLè·¯å¾„</a></li>
        <li><a href="#ç±»è·¯å¾„">ç±»è·¯å¾„</a></li>
        <li><a href="#åŒ…è·¯å¾„">åŒ…è·¯å¾„</a></li>
      </ol>
    </li>
    <li><a href="#å°ç»“-14">å°ç»“</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
