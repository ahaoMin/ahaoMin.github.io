<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Redis ‰∏ª‰ªéÂêåÊ≠• ‰∏ª‰ªéÂêåÊ≠•Ôºà‰∏ª‰ªéÂ§çÂà∂ÔºâÊòØ Redis È´òÂèØÁî®ÊúçÂä°ÁöÑÂü∫Áü≥Ôºå‰πüÊòØÂ§öÊú∫ËøêË°å‰∏≠ÊúÄÂü∫Á°ÄÁöÑ‰∏Ä‰∏™„ÄÇÊàë‰ª¨Êää‰∏ªË¶ÅÂ≠òÂÇ®Êï∞ÊçÆÁöÑËäÇÁÇπÂè´ÂÅö‰∏ªËäÇÁÇπ (masterÔºâÔºåÊääÂÖ∂‰ªñÈÄöËøáÂ§çÂà∂‰∏ªËäÇÁÇπÊï∞ÊçÆÁöÑÂâØÊú¨ËäÇÁÇπÂè´ÂÅö‰ªéËäÇÁÇπ (slaveÔºâÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
Âú® Redis ‰∏≠‰∏Ä‰∏™‰∏ªËäÇÁÇπÂèØ‰ª•Êã•ÊúâÂ§ö‰∏™‰ªéËäÇÁÇπÔºå‰∏Ä‰∏™‰ªéËäÇÁÇπ‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñÊúçÂä°Âô®ÁöÑ‰∏ªËäÇÁÇπÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ ‰∏ª‰ªéÂêåÊ≠•ÂÖ∑Êúâ‰ª•‰∏ã‰∏â‰∏™‰ºòÁÇπÔºö
 ÊÄßËÉΩÊñπÈù¢ÔºöÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂèØ‰ª•ÊääÊü•ËØ¢‰ªªÂä°ÂàÜÈÖçÁªô‰ªéÊúçÂä°Âô®ÔºåÁî®‰∏ªÊúçÂä°Âô®Êù•ÊâßË°åÂÜôÊìç‰ΩúÔºåËøôÊ†∑ÊûÅÂ§ßÁöÑÊèêÈ´ò‰∫ÜÁ®ãÂ∫èËøêË°åÁöÑÊïàÁéáÔºåÊääÊâÄÊúâÂéãÂäõÂàÜÊëäÂà∞ÂêÑ‰∏™ÊúçÂä°Âô®‰∫ÜÔºõ È´òÂèØÁî®ÔºöÂΩìÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂΩì‰∏ªÊúçÂä°Âô®ËäÇÁÇπÂÆïÊú∫‰πãÂêéÔºåÂèØ‰ª•ÂæàËøÖÈÄüÁöÑÊää‰ªéËäÇÁÇπÊèêÂçá‰∏∫‰∏ªËäÇÁÇπÔºå‰∏∫ Redis ÊúçÂä°Âô®ÁöÑÂÆïÊú∫ÊÅ¢Â§çËäÇÁúÅ‰∫ÜÂÆùË¥µÁöÑÊó∂Èó¥Ôºõ Èò≤Ê≠¢Êï∞ÊçÆ‰∏¢Â§±ÔºöÂΩì‰∏ªÊúçÂä°Âô®Á£ÅÁõòÂùèÊéâ‰πãÂêéÔºåÂÖ∂‰ªñ‰ªéÊúçÂä°Âô®Ëøò‰øùÁïôÁùÄÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÔºå‰∏çËá≥‰∫éÊï∞ÊçÆÂÖ®ÈÉ®‰∏¢Â§±„ÄÇ  Êó¢ÁÑ∂‰∏ª‰ªéÂêåÊ≠•ÊúâËøô‰πàÂ§öÁöÑ‰ºòÁÇπÔºåÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨Êù•ÁúãÂ¶Ç‰ΩïÂºÄÂêØÂíå‰ΩøÁî®‰∏ª‰ªéÂêåÊ≠•ÂäüËÉΩ„ÄÇ
ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠• ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô® Âú® Redis ËøêË°åËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® replicaof host port ÂëΩ‰ª§ÔºåÊääËá™Â∑±ËÆæÁΩÆ‰∏∫ÁõÆÊ†á IP ÁöÑ‰ªéÊúçÂä°Âô®ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö
1 2  127.0.0.1:6379&amp;gt; replicaof 127.0.0.1 6380 OK   Â¶ÇÊûú‰∏ªÊúçÂä°ËÆæÁΩÆ‰∫ÜÂØÜÁ†ÅÔºåÈúÄË¶ÅÂú®‰ªéÊúçÂä°Âô®ËæìÂÖ•‰∏ªÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÔºå‰ΩøÁî® config set masterauth ‰∏ªÊúçÂä°ÂØÜÁ†Å ÂëΩ‰ª§ÁöÑÊñπÂºèÔºå‰æãÂ¶ÇÔºö
1 2  127.0.0.1:6377&amp;gt; config set masterauth pwd654321 OK   1. ÊâßË°åÊµÅÁ®ã
Âú®ÊâßË°åÂÆå replicaof ÂëΩ‰ª§‰πãÂêéÔºå‰ªéÊúçÂä°Âô®ÁöÑÊï∞ÊçÆ‰ºöË¢´Ê∏ÖÁ©∫Ôºå‰∏ªÊúçÂä°‰ºöÊääÂÆÉÁöÑÊï∞ÊçÆÂâØÊú¨ÂêåÊ≠•Áªô‰ªéÊúçÂä°Âô®„ÄÇ
2. ÊµãËØïÂêåÊ≠•ÂäüËÉΩ
‰∏ª‰ªéÊúçÂä°Âô®ËÆæÁΩÆÂÆåÂêåÊ≠•‰πãÂêéÔºåÊàë‰ª¨Êù•ÊµãËØï‰∏Ä‰∏ã‰∏ª‰ªéÊï∞ÊçÆÂêåÊ≠•ÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÖàÂú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°å‰øùÂ≠òÊï∞ÊçÆÊìç‰ΩúÔºåÂÜçÂéª‰ªéÊúçÂä°Âô®Êü•ËØ¢„ÄÇ
‰∏ªÊúçÂä°Âô®ÊâßË°åÂëΩ‰ª§Ôºö
1 2  127.'><title>Redis È´òÂèØÁî®ÊñπÂºè</title>

<link rel='canonical' href='https://ahao.ink/posts/redis-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E5%BC%8F/'>

<link rel="stylesheet" href="/scss/style.min.baba905ab2d1209de74a1930c487a8a663c37860af6aa1c26588d298bf620306.css"><meta property='og:title' content='Redis È´òÂèØÁî®ÊñπÂºè'>
<meta property='og:description' content='Redis ‰∏ª‰ªéÂêåÊ≠• ‰∏ª‰ªéÂêåÊ≠•Ôºà‰∏ª‰ªéÂ§çÂà∂ÔºâÊòØ Redis È´òÂèØÁî®ÊúçÂä°ÁöÑÂü∫Áü≥Ôºå‰πüÊòØÂ§öÊú∫ËøêË°å‰∏≠ÊúÄÂü∫Á°ÄÁöÑ‰∏Ä‰∏™„ÄÇÊàë‰ª¨Êää‰∏ªË¶ÅÂ≠òÂÇ®Êï∞ÊçÆÁöÑËäÇÁÇπÂè´ÂÅö‰∏ªËäÇÁÇπ (masterÔºâÔºåÊääÂÖ∂‰ªñÈÄöËøáÂ§çÂà∂‰∏ªËäÇÁÇπÊï∞ÊçÆÁöÑÂâØÊú¨ËäÇÁÇπÂè´ÂÅö‰ªéËäÇÁÇπ (slaveÔºâÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
Âú® Redis ‰∏≠‰∏Ä‰∏™‰∏ªËäÇÁÇπÂèØ‰ª•Êã•ÊúâÂ§ö‰∏™‰ªéËäÇÁÇπÔºå‰∏Ä‰∏™‰ªéËäÇÁÇπ‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñÊúçÂä°Âô®ÁöÑ‰∏ªËäÇÁÇπÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ ‰∏ª‰ªéÂêåÊ≠•ÂÖ∑Êúâ‰ª•‰∏ã‰∏â‰∏™‰ºòÁÇπÔºö
 ÊÄßËÉΩÊñπÈù¢ÔºöÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂèØ‰ª•ÊääÊü•ËØ¢‰ªªÂä°ÂàÜÈÖçÁªô‰ªéÊúçÂä°Âô®ÔºåÁî®‰∏ªÊúçÂä°Âô®Êù•ÊâßË°åÂÜôÊìç‰ΩúÔºåËøôÊ†∑ÊûÅÂ§ßÁöÑÊèêÈ´ò‰∫ÜÁ®ãÂ∫èËøêË°åÁöÑÊïàÁéáÔºåÊääÊâÄÊúâÂéãÂäõÂàÜÊëäÂà∞ÂêÑ‰∏™ÊúçÂä°Âô®‰∫ÜÔºõ È´òÂèØÁî®ÔºöÂΩìÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂΩì‰∏ªÊúçÂä°Âô®ËäÇÁÇπÂÆïÊú∫‰πãÂêéÔºåÂèØ‰ª•ÂæàËøÖÈÄüÁöÑÊää‰ªéËäÇÁÇπÊèêÂçá‰∏∫‰∏ªËäÇÁÇπÔºå‰∏∫ Redis ÊúçÂä°Âô®ÁöÑÂÆïÊú∫ÊÅ¢Â§çËäÇÁúÅ‰∫ÜÂÆùË¥µÁöÑÊó∂Èó¥Ôºõ Èò≤Ê≠¢Êï∞ÊçÆ‰∏¢Â§±ÔºöÂΩì‰∏ªÊúçÂä°Âô®Á£ÅÁõòÂùèÊéâ‰πãÂêéÔºåÂÖ∂‰ªñ‰ªéÊúçÂä°Âô®Ëøò‰øùÁïôÁùÄÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÔºå‰∏çËá≥‰∫éÊï∞ÊçÆÂÖ®ÈÉ®‰∏¢Â§±„ÄÇ  Êó¢ÁÑ∂‰∏ª‰ªéÂêåÊ≠•ÊúâËøô‰πàÂ§öÁöÑ‰ºòÁÇπÔºåÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨Êù•ÁúãÂ¶Ç‰ΩïÂºÄÂêØÂíå‰ΩøÁî®‰∏ª‰ªéÂêåÊ≠•ÂäüËÉΩ„ÄÇ
ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠• ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô® Âú® Redis ËøêË°åËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® replicaof host port ÂëΩ‰ª§ÔºåÊääËá™Â∑±ËÆæÁΩÆ‰∏∫ÁõÆÊ†á IP ÁöÑ‰ªéÊúçÂä°Âô®ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö
1 2  127.0.0.1:6379&amp;gt; replicaof 127.0.0.1 6380 OK   Â¶ÇÊûú‰∏ªÊúçÂä°ËÆæÁΩÆ‰∫ÜÂØÜÁ†ÅÔºåÈúÄË¶ÅÂú®‰ªéÊúçÂä°Âô®ËæìÂÖ•‰∏ªÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÔºå‰ΩøÁî® config set masterauth ‰∏ªÊúçÂä°ÂØÜÁ†Å ÂëΩ‰ª§ÁöÑÊñπÂºèÔºå‰æãÂ¶ÇÔºö
1 2  127.0.0.1:6377&amp;gt; config set masterauth pwd654321 OK   1. ÊâßË°åÊµÅÁ®ã
Âú®ÊâßË°åÂÆå replicaof ÂëΩ‰ª§‰πãÂêéÔºå‰ªéÊúçÂä°Âô®ÁöÑÊï∞ÊçÆ‰ºöË¢´Ê∏ÖÁ©∫Ôºå‰∏ªÊúçÂä°‰ºöÊääÂÆÉÁöÑÊï∞ÊçÆÂâØÊú¨ÂêåÊ≠•Áªô‰ªéÊúçÂä°Âô®„ÄÇ
2. ÊµãËØïÂêåÊ≠•ÂäüËÉΩ
‰∏ª‰ªéÊúçÂä°Âô®ËÆæÁΩÆÂÆåÂêåÊ≠•‰πãÂêéÔºåÊàë‰ª¨Êù•ÊµãËØï‰∏Ä‰∏ã‰∏ª‰ªéÊï∞ÊçÆÂêåÊ≠•ÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÖàÂú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°å‰øùÂ≠òÊï∞ÊçÆÊìç‰ΩúÔºåÂÜçÂéª‰ªéÊúçÂä°Âô®Êü•ËØ¢„ÄÇ
‰∏ªÊúçÂä°Âô®ÊâßË°åÂëΩ‰ª§Ôºö
1 2  127.'>
<meta property='og:url' content='https://ahao.ink/posts/redis-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E5%BC%8F/'>
<meta property='og:site_name' content='ahao&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-09-26T13:36:41&#43;00:00'/><meta property='article:modified_time' content='2022-03-18T08:26:29&#43;00:00'/><meta property='og:image' content='https://ahao.ink/24.jpg' />
<meta name="twitter:title" content="Redis È´òÂèØÁî®ÊñπÂºè">
<meta name="twitter:description" content="Redis ‰∏ª‰ªéÂêåÊ≠• ‰∏ª‰ªéÂêåÊ≠•Ôºà‰∏ª‰ªéÂ§çÂà∂ÔºâÊòØ Redis È´òÂèØÁî®ÊúçÂä°ÁöÑÂü∫Áü≥Ôºå‰πüÊòØÂ§öÊú∫ËøêË°å‰∏≠ÊúÄÂü∫Á°ÄÁöÑ‰∏Ä‰∏™„ÄÇÊàë‰ª¨Êää‰∏ªË¶ÅÂ≠òÂÇ®Êï∞ÊçÆÁöÑËäÇÁÇπÂè´ÂÅö‰∏ªËäÇÁÇπ (masterÔºâÔºåÊääÂÖ∂‰ªñÈÄöËøáÂ§çÂà∂‰∏ªËäÇÁÇπÊï∞ÊçÆÁöÑÂâØÊú¨ËäÇÁÇπÂè´ÂÅö‰ªéËäÇÁÇπ (slaveÔºâÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
Âú® Redis ‰∏≠‰∏Ä‰∏™‰∏ªËäÇÁÇπÂèØ‰ª•Êã•ÊúâÂ§ö‰∏™‰ªéËäÇÁÇπÔºå‰∏Ä‰∏™‰ªéËäÇÁÇπ‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñÊúçÂä°Âô®ÁöÑ‰∏ªËäÇÁÇπÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö
‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ ‰∏ª‰ªéÂêåÊ≠•ÂÖ∑Êúâ‰ª•‰∏ã‰∏â‰∏™‰ºòÁÇπÔºö
 ÊÄßËÉΩÊñπÈù¢ÔºöÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂèØ‰ª•ÊääÊü•ËØ¢‰ªªÂä°ÂàÜÈÖçÁªô‰ªéÊúçÂä°Âô®ÔºåÁî®‰∏ªÊúçÂä°Âô®Êù•ÊâßË°åÂÜôÊìç‰ΩúÔºåËøôÊ†∑ÊûÅÂ§ßÁöÑÊèêÈ´ò‰∫ÜÁ®ãÂ∫èËøêË°åÁöÑÊïàÁéáÔºåÊääÊâÄÊúâÂéãÂäõÂàÜÊëäÂà∞ÂêÑ‰∏™ÊúçÂä°Âô®‰∫ÜÔºõ È´òÂèØÁî®ÔºöÂΩìÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂΩì‰∏ªÊúçÂä°Âô®ËäÇÁÇπÂÆïÊú∫‰πãÂêéÔºåÂèØ‰ª•ÂæàËøÖÈÄüÁöÑÊää‰ªéËäÇÁÇπÊèêÂçá‰∏∫‰∏ªËäÇÁÇπÔºå‰∏∫ Redis ÊúçÂä°Âô®ÁöÑÂÆïÊú∫ÊÅ¢Â§çËäÇÁúÅ‰∫ÜÂÆùË¥µÁöÑÊó∂Èó¥Ôºõ Èò≤Ê≠¢Êï∞ÊçÆ‰∏¢Â§±ÔºöÂΩì‰∏ªÊúçÂä°Âô®Á£ÅÁõòÂùèÊéâ‰πãÂêéÔºåÂÖ∂‰ªñ‰ªéÊúçÂä°Âô®Ëøò‰øùÁïôÁùÄÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÔºå‰∏çËá≥‰∫éÊï∞ÊçÆÂÖ®ÈÉ®‰∏¢Â§±„ÄÇ  Êó¢ÁÑ∂‰∏ª‰ªéÂêåÊ≠•ÊúâËøô‰πàÂ§öÁöÑ‰ºòÁÇπÔºåÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨Êù•ÁúãÂ¶Ç‰ΩïÂºÄÂêØÂíå‰ΩøÁî®‰∏ª‰ªéÂêåÊ≠•ÂäüËÉΩ„ÄÇ
ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠• ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô® Âú® Redis ËøêË°åËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® replicaof host port ÂëΩ‰ª§ÔºåÊääËá™Â∑±ËÆæÁΩÆ‰∏∫ÁõÆÊ†á IP ÁöÑ‰ªéÊúçÂä°Âô®ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö
1 2  127.0.0.1:6379&amp;gt; replicaof 127.0.0.1 6380 OK   Â¶ÇÊûú‰∏ªÊúçÂä°ËÆæÁΩÆ‰∫ÜÂØÜÁ†ÅÔºåÈúÄË¶ÅÂú®‰ªéÊúçÂä°Âô®ËæìÂÖ•‰∏ªÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÔºå‰ΩøÁî® config set masterauth ‰∏ªÊúçÂä°ÂØÜÁ†Å ÂëΩ‰ª§ÁöÑÊñπÂºèÔºå‰æãÂ¶ÇÔºö
1 2  127.0.0.1:6377&amp;gt; config set masterauth pwd654321 OK   1. ÊâßË°åÊµÅÁ®ã
Âú®ÊâßË°åÂÆå replicaof ÂëΩ‰ª§‰πãÂêéÔºå‰ªéÊúçÂä°Âô®ÁöÑÊï∞ÊçÆ‰ºöË¢´Ê∏ÖÁ©∫Ôºå‰∏ªÊúçÂä°‰ºöÊääÂÆÉÁöÑÊï∞ÊçÆÂâØÊú¨ÂêåÊ≠•Áªô‰ªéÊúçÂä°Âô®„ÄÇ
2. ÊµãËØïÂêåÊ≠•ÂäüËÉΩ
‰∏ª‰ªéÊúçÂä°Âô®ËÆæÁΩÆÂÆåÂêåÊ≠•‰πãÂêéÔºåÊàë‰ª¨Êù•ÊµãËØï‰∏Ä‰∏ã‰∏ª‰ªéÊï∞ÊçÆÂêåÊ≠•ÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÖàÂú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°å‰øùÂ≠òÊï∞ÊçÆÊìç‰ΩúÔºåÂÜçÂéª‰ªéÊúçÂä°Âô®Êü•ËØ¢„ÄÇ
‰∏ªÊúçÂä°Âô®ÊâßË°åÂëΩ‰ª§Ôºö
1 2  127."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://ahao.ink/24.jpg' />
    <link rel="shortcut icon" href="img/avatar_hua8acc2063f8134c9d13980a8a63800c2_11114_300x0_resize_box_3.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hua8acc2063f8134c9d13980a8a63800c2_11114_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üê∑</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ahao&#39;s Blog</a></h1>
            <h2 class="site-description">ÈÅìÈòª‰∏îÈïøÔºåË°åÂàôÂ∞ÜËá≥</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/'
                        target="_blank"
                        title="GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ / Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£ / Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢ / Search</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é / About</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ÊöóËâ≤Ê®°Âºè</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/posts/redis-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E5%BC%8F/">
                
                    <img src="/24.jpg" loading="lazy" alt="Featured image of post Redis È´òÂèØÁî®ÊñπÂºè" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/redis/" >
                Redis
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/redis-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E5%BC%8F/">Redis È´òÂèØÁî®ÊñπÂºè</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2021Âπ¥9Êúà26Êó•</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 12 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h1 id="redis-‰∏ª‰ªéÂêåÊ≠•">Redis ‰∏ª‰ªéÂêåÊ≠•</h1>
<p>‰∏ª‰ªéÂêåÊ≠•Ôºà‰∏ª‰ªéÂ§çÂà∂ÔºâÊòØ Redis È´òÂèØÁî®ÊúçÂä°ÁöÑÂü∫Áü≥Ôºå‰πüÊòØÂ§öÊú∫ËøêË°å‰∏≠ÊúÄÂü∫Á°ÄÁöÑ‰∏Ä‰∏™„ÄÇÊàë‰ª¨Êää‰∏ªË¶ÅÂ≠òÂÇ®Êï∞ÊçÆÁöÑËäÇÁÇπÂè´ÂÅö‰∏ªËäÇÁÇπ (masterÔºâÔºåÊääÂÖ∂‰ªñÈÄöËøáÂ§çÂà∂‰∏ªËäÇÁÇπÊï∞ÊçÆÁöÑÂâØÊú¨ËäÇÁÇπÂè´ÂÅö‰ªéËäÇÁÇπ (slaveÔºâÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/PJNIuYQb3S7GBCt.png"
	
	
	
	loading="lazy"
	
		alt="‰∏ª‰ªéÂêåÊ≠•.png"
	
	
></p>
<p>Âú® Redis ‰∏≠‰∏Ä‰∏™‰∏ªËäÇÁÇπÂèØ‰ª•Êã•ÊúâÂ§ö‰∏™‰ªéËäÇÁÇπÔºå‰∏Ä‰∏™‰ªéËäÇÁÇπ‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñÊúçÂä°Âô®ÁöÑ‰∏ªËäÇÁÇπÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/bIfMaL4PTVvt5dB.png"
	
	
	
	loading="lazy"
	
		alt="‰∏ª‰ªéÂêåÊ≠•-‰ªé‰ªéÊ®°Âºè.png"
	
	
></p>
<h2 id="‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ">‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ</h2>
<p>‰∏ª‰ªéÂêåÊ≠•ÂÖ∑Êúâ‰ª•‰∏ã‰∏â‰∏™‰ºòÁÇπÔºö</p>
<ul>
<li>ÊÄßËÉΩÊñπÈù¢ÔºöÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂèØ‰ª•ÊääÊü•ËØ¢‰ªªÂä°ÂàÜÈÖçÁªô‰ªéÊúçÂä°Âô®ÔºåÁî®‰∏ªÊúçÂä°Âô®Êù•ÊâßË°åÂÜôÊìç‰ΩúÔºåËøôÊ†∑ÊûÅÂ§ßÁöÑÊèêÈ´ò‰∫ÜÁ®ãÂ∫èËøêË°åÁöÑÊïàÁéáÔºåÊääÊâÄÊúâÂéãÂäõÂàÜÊëäÂà∞ÂêÑ‰∏™ÊúçÂä°Âô®‰∫ÜÔºõ</li>
<li>È´òÂèØÁî®ÔºöÂΩìÊúâ‰∫Ü‰∏ª‰ªéÂêåÊ≠•‰πãÂêéÔºåÂΩì‰∏ªÊúçÂä°Âô®ËäÇÁÇπÂÆïÊú∫‰πãÂêéÔºåÂèØ‰ª•ÂæàËøÖÈÄüÁöÑÊää‰ªéËäÇÁÇπÊèêÂçá‰∏∫‰∏ªËäÇÁÇπÔºå‰∏∫ Redis ÊúçÂä°Âô®ÁöÑÂÆïÊú∫ÊÅ¢Â§çËäÇÁúÅ‰∫ÜÂÆùË¥µÁöÑÊó∂Èó¥Ôºõ</li>
<li>Èò≤Ê≠¢Êï∞ÊçÆ‰∏¢Â§±ÔºöÂΩì‰∏ªÊúçÂä°Âô®Á£ÅÁõòÂùèÊéâ‰πãÂêéÔºåÂÖ∂‰ªñ‰ªéÊúçÂä°Âô®Ëøò‰øùÁïôÁùÄÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÔºå‰∏çËá≥‰∫éÊï∞ÊçÆÂÖ®ÈÉ®‰∏¢Â§±„ÄÇ</li>
</ul>
<p>Êó¢ÁÑ∂‰∏ª‰ªéÂêåÊ≠•ÊúâËøô‰πàÂ§öÁöÑ‰ºòÁÇπÔºåÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨Êù•ÁúãÂ¶Ç‰ΩïÂºÄÂêØÂíå‰ΩøÁî®‰∏ª‰ªéÂêåÊ≠•ÂäüËÉΩ„ÄÇ</p>
<h2 id="ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠•">ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠•</h2>
<h3 id="ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô®"><strong>ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô®</strong></h3>
<p>Âú® Redis ËøêË°åËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® <code>replicaof host port</code> ÂëΩ‰ª§ÔºåÊääËá™Â∑±ËÆæÁΩÆ‰∏∫ÁõÆÊ†á IP ÁöÑ‰ªéÊúçÂä°Âô®ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; replicaof 127.0.0.1 <span class="m">6380</span>
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â¶ÇÊûú‰∏ªÊúçÂä°ËÆæÁΩÆ‰∫ÜÂØÜÁ†ÅÔºåÈúÄË¶ÅÂú®‰ªéÊúçÂä°Âô®ËæìÂÖ•‰∏ªÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÔºå‰ΩøÁî® <code>config set masterauth ‰∏ªÊúçÂä°ÂØÜÁ†Å</code> ÂëΩ‰ª§ÁöÑÊñπÂºèÔºå‰æãÂ¶ÇÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6377&gt; config <span class="nb">set</span> masterauth pwd654321
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>1. ÊâßË°åÊµÅÁ®ã</strong></p>
<p>Âú®ÊâßË°åÂÆå replicaof ÂëΩ‰ª§‰πãÂêéÔºå‰ªéÊúçÂä°Âô®ÁöÑÊï∞ÊçÆ‰ºöË¢´Ê∏ÖÁ©∫Ôºå‰∏ªÊúçÂä°‰ºöÊääÂÆÉÁöÑÊï∞ÊçÆÂâØÊú¨ÂêåÊ≠•Áªô‰ªéÊúçÂä°Âô®„ÄÇ</p>
<p><strong>2. ÊµãËØïÂêåÊ≠•ÂäüËÉΩ</strong></p>
<p>‰∏ª‰ªéÊúçÂä°Âô®ËÆæÁΩÆÂÆåÂêåÊ≠•‰πãÂêéÔºåÊàë‰ª¨Êù•ÊµãËØï‰∏Ä‰∏ã‰∏ª‰ªéÊï∞ÊçÆÂêåÊ≠•ÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÖàÂú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°å‰øùÂ≠òÊï∞ÊçÆÊìç‰ΩúÔºåÂÜçÂéª‰ªéÊúçÂä°Âô®Êü•ËØ¢„ÄÇ</p>
<p>‰∏ªÊúçÂä°Âô®ÊâßË°åÂëΩ‰ª§Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; <span class="nb">set</span> lang redis
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªéÊúçÂä°ÊâßË°åÊü•ËØ¢Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; get lang
</span></span><span class="line"><span class="cl"><span class="s2">&#34;redis&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫Êï∞ÊçÆÂ∑≤ÁªèË¢´Ê≠£Â∏∏ÂêåÊ≠•ËøáÊù•‰∫Ü„ÄÇ</p>
<h3 id="ÂêØÂä®Êó∂ËÆæÁΩÆ‰ªéÊúçÂä°Âô®"><strong>ÂêØÂä®Êó∂ËÆæÁΩÆ‰ªéÊúçÂä°Âô®</strong></h3>
<p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§ <code>redis-server --port 6380 --replicaof 127.0.0.1 6379</code> Â∞ÜËá™Â∑±ËÆæÁΩÆÊàêÁõÆÊ†áÊúçÂä°Âô®ÁöÑ‰ªéÊúçÂä°Âô®„ÄÇ</p>
<h2 id="Êï∞ÊçÆÂêåÊ≠•">Êï∞ÊçÆÂêåÊ≠•</h2>
<h3 id="ÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•"><strong>ÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•</strong></h3>
<p>ÂΩìÊúâÊñ∞ÁöÑ‰ªéÊúçÂä°Âô®ËøûÊé•Êó∂Ôºå‰∏∫‰∫Ü‰øùÈöúÂ§ö‰∏™Êï∞ÊçÆÂ∫ìÁöÑ‰∏ÄËá¥ÊÄßÔºå‰∏ªÊúçÂä°Âô®‰ºöÊâßË°å‰∏ÄÊ¨° bgsave ÂëΩ‰ª§ÁîüÊàê‰∏Ä‰∏™ RDB Êñá‰ª∂ÔºåÁÑ∂ÂêéÂÜç‰ª• Socket ÁöÑÊñπÂºèÂèëÈÄÅÁªô‰ªéÊúçÂä°Âô®Ôºå‰ªéÊúçÂä°Âô®Êî∂Âà∞ RDB Êñá‰ª∂‰πãÂêéÂÜçÊääÊâÄÊúâÁöÑÊï∞ÊçÆÂä†ËΩΩÂà∞Ëá™Â∑±ÁöÑÁ®ãÂ∫è‰∏≠ÔºåÂ∞±ÂÆåÊàê‰∫Ü‰∏ÄÊ¨°ÂÖ®ÈáèÁöÑÊï∞ÊçÆÂêåÊ≠•„ÄÇ</p>
<h3 id="ÈÉ®ÂàÜÊï∞ÊçÆÂêåÊ≠•"><strong>ÈÉ®ÂàÜÊï∞ÊçÆÂêåÊ≠•</strong></h3>
<p>Âú® Redis 2.8 ‰πãÂâçÊØèÊ¨°‰ªéÊúçÂä°Âô®Á¶ªÁ∫øÂÜçÈáçÊñ∞‰∏äÁ∫ø‰πãÂâçÔºå‰∏ªÊúçÂä°Âô®‰ºöËøõË°å‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑÊï∞ÊçÆÂêåÊ≠•ÔºåÁÑ∂ÂêéËøôÁßçÊÉÖÂÜµÂ¶ÇÊûúÂèëÁîüÂú®Á¶ªÁ∫øÊó∂Èó¥ÊØîËæÉÁü≠ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂè™ÊúâÂ∞ëÈáèÁöÑÊï∞ÊçÆ‰∏çÂêåÊ≠•Âç¥Ë¶ÅÂêåÊ≠•ÊâÄÊúâÁöÑÊï∞ÊçÆÊòØÈùûÂ∏∏Á¨®ÊãôÂíå‰∏çÂàíÁÆóÁöÑÔºåÂú® Redis 2.8 Ëøô‰∏™ÂäüËÉΩÂæóÂà∞‰∫Ü‰ºòÂåñ„ÄÇ</p>
<p>Redis 2.8 ÁöÑ‰ºòÂåñÊñπÊ≥ïÊòØÂΩì‰ªéÊúçÂä°Á¶ªÁ∫ø‰πãÂêéÔºå‰∏ªÊúçÂä°Âô®‰ºöÊääÁ¶ªÁ∫ø‰πãÂêéÁöÑÂÜôÂÖ•ÂëΩ‰ª§ÔºåÂ≠òÂÇ®Âú®‰∏Ä‰∏™ÁâπÂÆöÂ§ßÂ∞èÁöÑÈòüÂàó‰∏≠ÔºåÈòüÂàóÊòØÂèØ‰ª•‰øùËØÅÂÖàËøõÂÖàÂá∫ÁöÑÊâßË°åÈ°∫Â∫èÁöÑÔºåÂΩì‰ªéÊúçÂä°Âô®ÈáçÂÜôÊÅ¢Â§ç‰∏äÁ∫ø‰πãÂêéÔºå‰∏ªÊúçÂä°‰ºöÂà§Êñ≠Á¶ªÁ∫øËøôÊÆµÊó∂Èó¥ÂÜÖÁöÑÂëΩ‰ª§ÊòØÂê¶ËøòÂú®ÈòüÂàó‰∏≠ÔºåÂ¶ÇÊûúÂú®Â∞±Áõ¥Êé•ÊääÈòüÂàó‰∏≠ÁöÑÊï∞ÊçÆÂèëÈÄÅÁªô‰ªéÊúçÂä°Âô®ÔºåËøôÊ†∑Â∞±ÈÅøÂÖç‰∫ÜÂÆåÊï¥ÂêåÊ≠•ÁöÑËµÑÊ∫êÊµ™Ë¥π„ÄÇ</p>
<blockquote>
<p>Â∞èË¥¥Â£´ÔºöÂ≠òÂÇ®Á¶ªÁ∫øÂëΩ‰ª§ÁöÑÈòüÂàóÂ§ßÂ∞èÈªòËÆ§ÊòØ 1MBÔºå‰ΩøÁî®ËÄÖÂèØ‰ª•Ëá™Ë°å‰øÆÊîπÈòüÂàóÂ§ßÂ∞èÁöÑÈÖçÁΩÆÈ°π repl-backlog-size„ÄÇ</p>
</blockquote>
<h3 id="Êó†ÁõòÊï∞ÊçÆÂêåÊ≠•"><strong>Êó†ÁõòÊï∞ÊçÆÂêåÊ≠•</strong></h3>
<p>‰ªéÂâçÈù¢ÁöÑÂÜÖÂÆπÊàë‰ª¨ÂèØ‰ª•ÂæóÁü•ÔºåÂú®Á¨¨‰∏ÄÊ¨°‰∏ª‰ªéËøûÊé•ÁöÑÊó∂ÂÄôÔºå‰ºöÂÖà‰∫ßÁîü‰∏Ä‰∏™ RDB Êñá‰ª∂ÔºåÂÜçÊää RDB Êñá‰ª∂ÂèëÈÄÅÁªô‰ªéÊúçÂä°Âô®ÔºåÂ¶ÇÊûú‰∏ªÊúçÂä°Âô®ÊòØÈùûÂõ∫ÊÄÅÁ°¨ÁõòÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÁöÑ I/O Êìç‰ΩúÊòØÈùûÂ∏∏È´òÁöÑÔºå‰∏∫‰∫ÜÁºìËß£Ëøô‰∏™ÈóÆÈ¢òÔºåRedis 2.8.18 Êñ∞Â¢û‰∫ÜÊó†ÁõòÂ§çÂà∂ÂäüËÉΩÔºåÊó†ÁõòÂ§çÂà∂ÂäüËÉΩ‰∏ç‰ºöÂú®Êú¨Âú∞ÂàõÂª∫ RDB Êñá‰ª∂ÔºåËÄåÊòØ‰ºöÊ¥æÁîüÂá∫‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåÁÑ∂ÂêéÁî±Â≠êËøõÁ®ãÈÄöËøá Socket ÁöÑÊñπÂºèÔºåÁõ¥Êé•Â∞Ü RDB Êñá‰ª∂ÂÜôÂÖ•Âà∞‰ªéÊúçÂä°Âô®ÔºåËøôÊ†∑‰∏ªÊúçÂä°Âô®Â∞±ÂèØ‰ª•Âú®‰∏çÂàõÂª∫RDBÊñá‰ª∂ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÆåÊàê‰∏é‰ªéÊúçÂä°Âô®ÁöÑÊï∞ÊçÆÂêåÊ≠•„ÄÇ</p>
<p>Ë¶Å‰ΩøÁî®Êó†È°ªÂ§çÂà∂ÂäüËÉΩÔºåÂè™ÈúÄÊääÈÖçÁΩÆÈ°π repl-diskless-sync ÁöÑÂÄºËÆæÁΩÆ‰∏∫ yes Âç≥ÂèØÔºåÂÆÉÈªòËÆ§ÈÖçÁΩÆÂÄº‰∏∫ no„ÄÇ</p>
<h2 id="Êü•ËØ¢ÊúçÂä°Âô®ÁöÑËßíËâ≤">Êü•ËØ¢ÊúçÂä°Âô®ÁöÑËßíËâ≤</h2>
<p>Êàë‰ª¨‰ΩøÁî® role ÂëΩ‰ª§ÔºåÊù•Êü•ËØ¢ÂΩìÂâçÊúçÂä°Âô®ÁöÑ‰∏ª‰ªéËßíËâ≤‰ø°ÊÅØ„ÄÇ</p>
<h3 id="‰∏ªÊúçÂä°Êü•Áúã"><strong>‰∏ªÊúçÂä°Êü•Áúã</strong></h3>
<p>Âú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°å role ÁªìÊûúÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; role
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="s2">&#34;master&#34;</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">546</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">&#34;172.17.0.1&#34;</span>
</span></span><span class="line"><span class="cl">      2<span class="o">)</span> <span class="s2">&#34;6379&#34;</span>
</span></span><span class="line"><span class="cl">      3<span class="o">)</span> <span class="s2">&#34;546&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>master Ë°®Á§∫‰∏ªÊúçÂä°Âô®ÔºåÂ∫ï‰∏ãÊòØ‰ªéÊúçÂä°Âô®ÁöÑ IP„ÄÅÁ´ØÂè£ÂíåËøûÊé•Êó∂Èó¥„ÄÇ</p>
<h3 id="‰ªéÊúçÂä°Âô®Êü•Áúã"><strong>‰ªéÊúçÂä°Âô®Êü•Áúã</strong></h3>
<p>Âú®‰ªéÊúçÂä°Âô®ÊâßË°å role ÂëΩ‰ª§ÔºåÊâßË°åÁªìÊûúÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; role
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="s2">&#34;slave&#34;</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="s2">&#34;192.168.1.71&#34;</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">6380</span>
</span></span><span class="line"><span class="cl">4<span class="o">)</span> <span class="s2">&#34;connected&#34;</span>
</span></span><span class="line"><span class="cl">5<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">14</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>slave Ë°®Á§∫‰ªéÊúçÂä°Âô®ÔºåÂ∫ï‰∏ã‰∏ªÊúçÂä°Âô®ÁöÑ IP„ÄÅÁ´ØÂè£ÂíåËøûÊé•Êó∂Èó¥„ÄÇ</p>
<h2 id="ÂÖ≥Èó≠‰∏ª‰ªéÂêåÊ≠•">ÂÖ≥Èó≠‰∏ª‰ªéÂêåÊ≠•</h2>
<p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî® <code>replicaof no one</code> ÂëΩ‰ª§Êù•ÂÅúÊ≠¢‰ªéÊúçÂä°Âô®ÁöÑÂ§çÂà∂ÔºåÊìç‰ΩúÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; role <span class="c1">#Êü•ËØ¢ÂΩìÂâçËßíËâ≤</span>
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="s2">&#34;slave&#34;</span> <span class="c1">#‰ªéÊúçÂä°Âô®</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="s2">&#34;192.168.1.71&#34;</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">6380</span>
</span></span><span class="line"><span class="cl">4<span class="o">)</span> <span class="s2">&#34;connected&#34;</span>
</span></span><span class="line"><span class="cl">5<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">14</span>
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; replicaof no one <span class="c1">#ÂÖ≥Èó≠ÂêåÊ≠•</span>
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; role <span class="c1">#Êü•ËØ¢ÂΩìÂâçËßíËâ≤</span>
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="s2">&#34;master&#34;</span> <span class="c1">#‰∏ªÊúçÂä°Âô®</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1097</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> <span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫ÊâßË°å‰∫Ü <code>replicaof no one</code> ÂëΩ‰ª§‰πãÂêéÔºåËá™Â∑±Â∞±‰ªéÊúçÂä°Âô®ÂèòÊàê‰∏ªÊúçÂä°Âô®‰∫Ü„ÄÇ</p>
<blockquote>
<p>Â∞èË¥¥Â£´ÔºöÊúçÂä°Âô®Á±ªÂûãÁöÑËΩ¨Êç¢Âπ∂‰∏ç‰ºöÂΩ±ÂìçÊï∞ÊçÆÔºåËøôÂè∞ÊúçÂä°Âô®ÁöÑÊï∞ÊçÆÂ∞Ü‰ºöË¢´‰øùÁïô„ÄÇ</p>
</blockquote>
<h2 id="Ê≥®ÊÑè‰∫ãÈ°π">Ê≥®ÊÑè‰∫ãÈ°π</h2>
<p>‰∏ª‰ªéÂêåÊ≠•Êúâ‰∏Ä‰∫õÈúÄË¶ÅÊ≥®ÊÑèÁöÑÁÇπÔºåÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ã„ÄÇ</p>
<h3 id="Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò"><strong>Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò</strong></h3>
<p>ÂΩì‰ªéÊúçÂä°Âô®Â∑≤ÁªèÂÆåÊàêÂíå‰∏ªÊúçÂä°ÁöÑÊï∞ÊçÆÂêåÊ≠•‰πãÂêéÔºåÂÜçÊñ∞Â¢ûÁöÑÂëΩ‰ª§‰ºö‰ª•ÂºÇÊ≠•ÁöÑÊñπÂºèÂèëÈÄÅËá≥‰ªéÊúçÂä°Âô®ÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠‰∏ª‰ªéÂêåÊ≠•‰ºöÊúâÁü≠ÊöÇÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºåÂ¶ÇÂú®Ëøô‰∏™ÂºÇÊ≠•ÂêåÊ≠•ÂèëÁîü‰πãÂâç‰∏ªÊúçÂä°Âô®ÂÆïÊú∫‰∫ÜÔºå‰ºöÈÄ†ÊàêÊï∞ÊçÆ‰∏ç‰∏ÄËá¥„ÄÇ</p>
<h3 id="‰ªéÊúçÂä°Âô®Âè™ËØªÊÄß"><strong>‰ªéÊúçÂä°Âô®Âè™ËØªÊÄß</strong></h3>
<p>ÈªòËÆ§Âú®ÊÉÖÂÜµ‰∏ãÔºåÂ§Ñ‰∫éÂ§çÂà∂Ê®°ÂºèÁöÑ‰∏ªÊúçÂä°Âô®Êó¢ÂèØ‰ª•ÊâßË°åÂÜôÊìç‰Ωú‰πüÂèØ‰ª•ÊâßË°åËØªÊìç‰ΩúÔºåËÄå‰ªéÊúçÂä°Âô®ÂàôÂè™ËÉΩÊâßË°åËØªÊìç‰Ωú„ÄÇ</p>
<p>ÂèØ‰ª•Âú®‰ªéÊúçÂä°Âô®‰∏äÊâßË°å <code>config set replica-read-only no</code> ÂëΩ‰ª§Ôºå‰Ωø‰ªéÊúçÂä°Âô®ÂºÄÂêØÂÜôÊ®°ÂºèÔºå‰ΩÜÈúÄË¶ÅÊ≥®ÊÑè‰ª•‰∏ãÂá†ÁÇπÔºö</p>
<ul>
<li>Âú®‰ªéÊúçÂä°Âô®‰∏äÂÜôÁöÑÊï∞ÊçÆ‰∏ç‰ºöÂêåÊ≠•Âà∞‰∏ªÊúçÂä°Âô®Ôºõ</li>
<li>ÂΩìÈîÆÂÄºÁõ∏ÂêåÊó∂‰∏ªÊúçÂä°Âô®‰∏äÁöÑÊï∞ÊçÆÂèØ‰ª•Ë¶ÜÁõñ‰ªéÊúçÂä°Âô®Ôºõ</li>
<li>Âú®ËøõË°åÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•Êó∂Ôºå‰ªéÊúçÂä°Âô®Êï∞ÊçÆ‰ºöË¢´Ê∏ÖÁ©∫„ÄÇ</li>
</ul>
<h3 id="Â§çÂà∂ÂëΩ‰ª§ÁöÑÂèòÂåñ"><strong>Â§çÂà∂ÂëΩ‰ª§ÁöÑÂèòÂåñ</strong></h3>
<p>Redis 5.0 ‰πãÂâç‰ΩøÁî®ÁöÑÂ§çÂà∂ÂëΩ‰ª§ÊòØ slaveofÔºåÂú® Redis 5.0 ‰πãÂêéÂ§çÂà∂ÂëΩ‰ª§ÊâçË¢´Êîπ‰∏∫ replicaofÔºåÂú®È´òÁâàÊú¨ÔºàRedis 5+Ôºâ‰∏≠Êàë‰ª¨Â∫îËØ•Â∞ΩÈáè‰ΩøÁî® replicaofÔºåÂõ†‰∏∫ slaveof ÂëΩ‰ª§ÂèØËÉΩ‰ºöË¢´ÈöèÊó∂Â∫üÂºÉÊéâ„ÄÇ</p>
<h2 id="Â∞èÁªì">Â∞èÁªì</h2>
<p>Êú¨ÊñáÊàë‰ª¨‰∫ÜËß£‰∫Ü Redis Â§öÊú∫ËøêË°åÁöÑÂü∫Á°ÄÂäüËÉΩ‰∏ª‰ªéÂêåÊ≠•Ôºå‰∏ª‰ªéÂêåÊ≠•ÂèØ‰ª•ÈÄöËøá <code>replicaof host port</code> ÂëΩ‰ª§ÂºÄÂêØÔºåÁü•ÈÅì‰∫ÜÂêåÊ≠•ÁöÑ‰∏âÁßçÊñπÂºèÔºöÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•ÔºàÁ¨¨‰∏ÄÊ¨°ÂÖ®Èáè RDB ÂêåÊ≠•ÔºâÔºåÈÉ®ÂàÜÊï∞ÊçÆÂêåÊ≠•ÔºàRedis 2.8 ÂØπ‰∫éÁü≠Êó∂Èó¥Á¶ªÁ∫øÁöÑÂêåÊ≠•ÂäüËÉΩ‰ºòÂåñÔºâÔºåÊó†ÁõòÂêåÊ≠•ÔºàÈùû RDB ÁîüÊàêÁöÑÊñπÂºèÂêåÊ≠•Êï∞ÊçÆÔºâÔºåÊàë‰ª¨‰πüÂèØ‰ª•‰ΩøÁî® <code>replicaof no one</code> ÂëΩ‰ª§Êù•ÂÅúÊ≠¢‰ªéÊúçÂä°Âô®ÁöÑÂ§çÂà∂ÂäüËÉΩ„ÄÇ</p>
<h1 id="redis-Âì®ÂÖµÊ®°Âºè">Redis Âì®ÂÖµÊ®°Âºè</h1>
<p>‰∏ª‰ªéÂ§çÂà∂Ê®°ÂºèÔºåÂÆÉÊòØÂ±û‰∫é Redis Â§öÊú∫ËøêË°åÁöÑÂü∫Á°ÄÔºå‰ΩÜËøôÁßçÊ®°ÂºèÊú¨Ë∫´Â≠òÂú®‰∏Ä‰∏™Ëá¥ÂëΩÁöÑÈóÆÈ¢òÔºåÂΩì‰∏ªËäÇÁÇπÂ•îÊ∫É‰πãÂêéÔºåÈúÄË¶Å‰∫∫Â∑•Âπ≤È¢ÑÊâçËÉΩÊÅ¢Â§ç Redis ÁöÑÊ≠£Â∏∏‰ΩøÁî®„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåÊàë‰ª¨Êúâ 3 Âè∞ÊúçÂä°Âô®ÂÅö‰∫Ü‰∏ª‰ªéÂ§çÂà∂Ôºå‰∏Ä‰∏™‰∏ªÊúçÂä°Âô® A Âíå‰∏§‰∏™‰ªéÊúçÂä°Âô® B„ÄÅCÔºåÂΩì A ÂèëÁîüÊïÖÈöú‰πãÂêéÔºåÈúÄË¶Å‰∫∫Â∑•Êää B ÊúçÂä°Âô®ËÆæÁΩÆ‰∏∫‰∏ªÊúçÂä°Âô®ÔºåÂêåÊó∂ÂÜçÂéª C ÊúçÂä°Âô®ËÆæÁΩÆÊàê‰ªéÊúçÂä°Âô®Âπ∂‰∏î‰ªé‰∏ªÊúçÂä°Âô® B ÂêåÊ≠•Êï∞ÊçÆÔºåÂ¶ÇÊûúÊòØÂèëÁîüÂú®Êôö‰∏äÊàñËÄÖ‰ªéÊúçÂä°Âô®ËäÇÁÇπÂæàÂ§öÁöÑÊÉÖÂÜµ‰∏ãÔºåÂØπ‰∫é‰∫∫Â∑•Êù•ËØ¥ÊÉ≥Ë¶ÅÁ´ãÂç≥ÂÆûÁé∞ÊÅ¢Â§çÁöÑÈöæÂ∫¶ÂæàÂ§öÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™Ëá™Âä®ÁöÑÂ∑•ÂÖ∑‚Äî‚ÄîRedis SentinelÔºàÂì®ÂÖµÊ®°ÂºèÔºâÊù•ÊääÊâãÂä®ÁöÑËøáÁ®ãÂèòÊàêËá™Âä®ÁöÑÔºåËÆ© Redis Êã•ÊúâËá™Âä®ÂÆπÁÅæÊÅ¢Â§çÔºàfailoverÔºâÁöÑËÉΩÂäõ„ÄÇ</p>
<p>Âì®ÂÖµÊ®°ÂºèÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/PQnbiIoKjm3dwgl.png"
	
	
	
	loading="lazy"
	
		alt="Âì®ÂÖµÊ®°Âºè.png"
	
	
></p>
<blockquote>
<p>Â∞èË¥¥Â£´ÔºöRedis Sentinel ÁöÑÊúÄÂ∞èÂàÜÈÖçÂçï‰ΩçÊòØ‰∏Ä‰∏ª‰∏Ä‰ªé„ÄÇ</p>
</blockquote>
<h2 id="redis-sentinel-Êê≠Âª∫">Redis Sentinel Êê≠Âª∫</h2>
<p>Redis ÂÆòÊñπÊèê‰æõ‰∫Ü Redis Sentinel ÁöÑÂäüËÉΩÔºåÂÆÉÁöÑËøêË°åÁ®ãÂ∫è‰øùÂ≠òÂú® src ÁõÆÂΩï‰∏ãÔºåÂ¶ÇÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/WQhNEynwb1RUClv.png"
	
	
	
	loading="lazy"
	
		alt="image.png"
	
	
></p>
<p>Êàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ÂëΩ‰ª§ <code>./src/redis-sentinel sentinel.conf</code> Êù•ÂêØÂä® SentinelÔºåÂèØ‰ª•ÁúãÂá∫Êàë‰ª¨Âú®ÂêØÂä®ÂÆÉÊó∂ÂøÖÈ°ªËÆæÁΩÆ‰∏Ä‰∏™ sentinel.conf Êñá‰ª∂ÔºåËøô‰∏™ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂøÖÈ°ªÂåÖÂê´ÁõëÂê¨ÁöÑ‰∏ªËäÇÁÇπ‰ø°ÊÅØÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sentinel monitor master-name ip port quorum
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰æãÂ¶ÇÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sentinel monitor mymaster 127.0.0.1 6379 1
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÖ∂‰∏≠Ôºö</p>
<ul>
<li>master-name Ë°®Á§∫ÁªôÁõëËßÜÁöÑ‰∏ªËäÇÁÇπËµ∑‰∏Ä‰∏™ÂêçÁß∞Ôºõ</li>
<li>ip Ë°®Á§∫‰∏ªËäÇÁÇπÁöÑ IPÔºõ</li>
<li>port Ë°®Á§∫‰∏ªËäÇÁÇπÁöÑÁ´ØÂè£Ôºõ</li>
<li>quorum Ë°®Á§∫Á°ÆËÆ§‰∏ªËäÇÁÇπ‰∏ãÁ∫øÁöÑ Sentinel Êï∞ÈáèÔºåÂ¶ÇÊûú quorum ËÆæÁΩÆ‰∏∫ 1 Ë°®Á§∫Âè™Ë¶ÅÊúâ‰∏ÄÂè∞ Sentinel Âà§Êñ≠ÂÆÉ‰∏ãÁ∫ø‰∫ÜÔºåÂ∞±ÂèØ‰ª•Á°ÆËÆ§ÂÆÉÁúüÁöÑ‰∏ãÁ∫ø‰∫Ü„ÄÇ</li>
</ul>
<p>Ê≥®ÊÑèÔºöÂ¶ÇÊûú‰∏ªËäÇÁÇπ Redis ÊúçÂä°Âô®ÊúâÂØÜÁ†ÅÔºåËøòÂøÖÈ°ªÂú® sentinel.conf ‰∏≠Ê∑ªÂä†‰∏ªËäÇÁÇπÁöÑÂØÜÁ†ÅÔºå‰∏çÁÑ∂‰ºöÂØºËá¥ Sentinel ‰∏çËÉΩËá™Âä®ÁõëÂê¨Âà∞‰∏ªËäÇÁÇπ‰∏ãÈù¢ÁöÑ‰ªéËäÇÁÇπ„ÄÇ</p>
<p>ÊâÄ‰ª•Â¶ÇÊûú Redis ÊúâÂØÜÁ†ÅÔºåsentinel.conf ÂøÖÈ°ªÂåÖÂê´‰ª•‰∏ãÂÜÖÂÆπÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sentinel monitor mymaster 127.0.0.1 6379 1
</span></span><span class="line"><span class="cl">sentinel auth-pass mymaster pwd654321
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂΩìÊàë‰ª¨ÈÖçÁΩÆÂ•Ω sentinel.conf Âπ∂ÊâßË°åÂêØÂä®ÂëΩ‰ª§ <code>./src/redis-sentinel sentinel.conf</code> ‰πãÂêéÔºåRedis Sentinel Â∞±‰ºöË¢´ÂêØÂä®ÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/otjm7MZLJu94USV.png"
	
	
	
	loading="lazy"
	
		alt="3.png"
	
	
></p>
<p>‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂá∫ Sentinel Âè™ÈúÄÈÖçÁΩÆÁõëÂê¨‰∏ªËäÇÁÇπÁöÑ‰ø°ÊÅØÔºåÂÆÉ‰ºöËá™Âä®ÁõëÂê¨ÂØπÂ∫îÁöÑ‰ªéËäÇÁÇπ„ÄÇ</p>
<h2 id="ÂêØÂä®-sentinel-ÈõÜÁæ§">ÂêØÂä® Sentinel ÈõÜÁæ§</h2>
<p>‰∏äÈù¢Êàë‰ª¨ÊºîÁ§∫‰∫ÜÂçï‰∏™ Sentinel ÁöÑÂêØÂä®Ôºå‰ΩÜÁîü‰∫ßÁéØÂ¢ÉÊàë‰ª¨‰∏ç‰ºöÂè™ÂêØÂä®‰∏ÄÂè∞ SentinelÔºåÂõ†‰∏∫Â¶ÇÊûúÂêØÂä®‰∏ÄÂè∞ Sentinel ÂÅáÂ¶ÇÂÆÉ‰∏çÂπ∏ÂÆïÊú∫ÁöÑËØùÔºåÂ∞±‰∏çËÉΩÊèê‰æõËá™Âä®ÂÆπÁÅæÁöÑÊúçÂä°‰∫ÜÔºå‰∏çÁ¨¶ÂêàÊàë‰ª¨È´òÂèØÁî®ÁöÑÂÆóÊó®ÔºåÊâÄ‰ª•Êàë‰ª¨‰ºöÂú®‰∏çÂêåÁöÑÁâ©ÁêÜÊú∫‰∏äÂêØÂä®Â§ö‰∏™ Sentinel Êù•ÁªÑÊàê Sentinel ÈõÜÁæ§ÔºåÊù•‰øùËØÅ Redis ÊúçÂä°ÁöÑÈ´òÂèØÁî®„ÄÇ</p>
<p>ÂêØÂä® Sentinel ÈõÜÁæ§ÁöÑÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂíå‰∏äÈù¢ÂêØÂä®ÂçïÂè∞ÁöÑÊñπÂºè‰∏ÄÊ†∑ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÊääÂ§ö‰∏™ Sentinel ÁõëÂê¨Âà∞‰∏Ä‰∏™‰∏ªÊúçÂä°Âô®ËäÇÁÇπÔºåÈÇ£‰πàÂ§ö‰∏™ Sentinel Â∞±‰ºöËá™Âä®ÂèëÁé∞ÂΩºÊ≠§ÔºåÂπ∂ÁªÑÊàê‰∏Ä‰∏™ Sentinel ÈõÜÁæ§„ÄÇ</p>
<p>Êàë‰ª¨ÂêØÂä®Á¨¨‰∫å‰∏™ Sentinel Êù•ËØï‰∏Ä‰∏ãÔºåÊâßË°åÁªìÊûúÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>@iZ2ze0nc5n41zomzyqtksmZ:redis2<span class="o">]</span>$ ./src/redis-sentinel sentinel.conf
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.047 <span class="c1"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.047 <span class="c1"># Redis version=5.0.5, bits=64, commit=00000000, modified=0, pid=5547, just started</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.047 <span class="c1"># Configuration loaded</span>
</span></span><span class="line"><span class="cl">                _._                                                  
</span></span><span class="line"><span class="cl">           _.-<span class="sb">``</span>__ <span class="s1">&#39;&#39;</span>-._                                             
</span></span><span class="line"><span class="cl">      _.-<span class="sb">``</span>    <span class="sb">`</span>.  <span class="sb">`</span>_.  <span class="s1">&#39;&#39;</span>-._           Redis 5.0.5 <span class="o">(</span>00000000/0<span class="o">)</span> <span class="m">64</span> bit
</span></span><span class="line"><span class="cl">  .-<span class="sb">``</span> .-<span class="sb">```</span>.  <span class="sb">```</span><span class="se">\/</span>    _.,_ <span class="s1">&#39;&#39;</span>-._                                   
</span></span><span class="line"><span class="cl"> <span class="o">(</span>    <span class="s1">&#39;      ,       .-`  | `,    )     Running in sentinel mode
</span></span></span><span class="line"><span class="cl"><span class="s1"> |`-._`-...-` __...-.``-._|&#39;</span><span class="sb">`</span> _.-<span class="s1">&#39;|     Port: 26377
</span></span></span><span class="line"><span class="cl"><span class="s1"> |    `-._   `._    /     _.-&#39;</span>    <span class="p">|</span>     PID: <span class="m">5547</span>
</span></span><span class="line"><span class="cl">  <span class="sb">`</span>-._    <span class="sb">`</span>-._  <span class="sb">`</span>-./  _.-<span class="s1">&#39;    _.-&#39;</span>                                   
</span></span><span class="line"><span class="cl"> <span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|                                  
</span></span></span><span class="line"><span class="cl"><span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |           http://redis.io        
</span></span></span><span class="line"><span class="cl"><span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>                                   
</span></span><span class="line"><span class="cl"> <span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|                                  
</span></span></span><span class="line"><span class="cl"><span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |                                  
</span></span></span><span class="line"><span class="cl"><span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>                                   
</span></span><span class="line"><span class="cl">      <span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>                                       
</span></span><span class="line"><span class="cl">          <span class="sb">`</span>-._        _.-<span class="s1">&#39;                                           
</span></span></span><span class="line"><span class="cl"><span class="s1">              `-.__.-&#39;</span>                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.049 <span class="c1"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.049 <span class="c1"># Sentinel ID is 6455f2f74614a71ce0a63398b2e48d6cd1cf0d06</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.049 <span class="c1"># +monitor master mymaster 127.0.0.1 6379 quorum 1</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.049 * +slave slave 127.0.0.1:6377 127.0.0.1 <span class="m">6377</span> @ mymaster 127.0.0.1 <span class="m">6379</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.052 * +slave slave 127.0.0.1:6378 127.0.0.1 <span class="m">6378</span> @ mymaster 127.0.0.1 <span class="m">6379</span>
</span></span><span class="line"><span class="cl">5547:X <span class="m">19</span> Feb <span class="m">2020</span> 20:29:30.345 * +sentinel sentinel 6455f2f74614a71ce0a63398b2e48d6cd1cf0d08 127.0.0.1 <span class="m">26379</span> @ mymaster 127.0.0.1 <span class="m">6379</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰ª•‰∏äÂêØÂä®ÂëΩ‰ª§ÂèØ‰ª•ÁúãÂá∫ÔºåÊØîÂçïÊú∫Ê®°ÂºèÂ§ö‰∫ÜÊúÄÂêé‰∏ÄË°åÂèëÁé∞ÂÖ∂‰ªñ Sentinel ÊúçÂä°Âô®ÁöÑÂëΩ‰ª§ÔºåËØ¥ÊòéËøô‰∏§‰∏™ Sentinel Â∑≤ÁªèÁªÑÊàê‰∏Ä‰∏™ÈõÜÁæ§‰∫Ü„ÄÇ</p>
<p>Sentinel ÈõÜÁæ§Á§∫ÊÑèÂõæÂ¶Ç‰∏ãÔºö</p>
<p><img src="https://s2.loli.net/2021/12/14/YeOVNwt14UCMkT5.png"
	
	
	
	loading="lazy"
	
		alt="Âì®ÂÖµÊ®°Âºè-Â§öÂì®ÂÖµ.png"
	
	
></p>
<p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã Sentinel ÈõÜÁæ§ÁöÑÊï∞ÈáèÂèñÂ§ß‰∫é 1 ÁöÑÂ•áÊï∞Ôºå‰æãÂ¶Ç 3„ÄÅ5„ÄÅ7„ÄÅ9ÔºåËÄå quorum ÁöÑÈÖçÁΩÆË¶ÅÊ†πÊçÆ Sentinel ÁöÑÊï∞ÈáèÊù•ÂèëÁîüÂèòÂåñÔºå‰æãÂ¶Ç Sentinel ÊòØ 3 Âè∞ÔºåÈÇ£‰πàÂØπÂ∫îÁöÑ quorum ÊúÄÂ•ΩÊòØ 2ÔºåÂ¶ÇÊûú Sentinel ÊòØ 5 Âè∞ÔºåÈÇ£‰πà quorum ÊúÄÂ•ΩÊòØ 3ÔºåÂÆÉË°®Á§∫ÂΩìÊúâ 3 Âè∞ Sentinel ÈÉΩÁ°ÆËÆ§‰∏ªËäÇÁÇπ‰∏ãÁ∫ø‰∫ÜÔºåÂ∞±ÂèØ‰ª•Á°ÆÂÆö‰∏ªËäÇÁÇπÁúüÁöÑ‰∏ãÁ∫ø‰∫Ü„ÄÇ</p>
<p>‰∏é quorum ÂèÇÊï∞Áõ∏ÂÖ≥ÁöÑÊúâ‰∏§‰∏™Ê¶ÇÂøµÔºö‰∏ªËßÇ‰∏ãÁ∫øÂíåÂÆ¢ËßÇ‰∏ãÁ∫ø„ÄÇ</p>
<p>ÂΩì Sentinel ÈõÜÁæ§‰∏≠ÔºåÊúâ‰∏Ä‰∏™ Sentinel ËÆ§‰∏∫‰∏ªÊúçÂä°Âô®Â∑≤Áªè‰∏ãÁ∫øÊó∂ÔºåÂÆÉ‰ºöÂ∞ÜËøô‰∏™‰∏ªÊúçÂä°Âô®Ê†áËÆ∞‰∏∫‰∏ªËßÇ‰∏ãÁ∫øÔºàSubjectively DownÔºåSDOWNÔºâÔºåÁÑ∂ÂêéËØ¢ÈóÆÈõÜÁæ§‰∏≠ÁöÑÂÖ∂‰ªñ SentinelÔºåÊòØÂê¶‰πüËÆ§‰∏∫ËØ•ÊúçÂä°Âô®Â∑≤‰∏ãÁ∫øÔºåÂΩìÂêåÊÑè‰∏ªÊúçÂä°Âô®Â∑≤‰∏ãÁ∫øÁöÑ Sentinel Êï∞ÈáèËææÂà∞ quorum ÂèÇÊï∞ÊâÄÊåáÂÆöÁöÑÊï∞ÈáèÊó∂ÔºåSentinel Â∞±‰ºöÂ∞ÜÁõ∏Â∫îÁöÑ‰∏ªÊúçÂä°Âô®Ê†áËÆ∞‰∏∫ÂÆ¢ËßÇ‰∏ãÁ∫øÔºàObjectively downÔºåODOWNÔºâÔºåÁÑ∂ÂêéÂºÄÂßãÂØπÂÖ∂ËøõË°åÊïÖÈöúËΩ¨Áßª„ÄÇ</p>
<h2 id="Ëá™Âä®ÂÆπÁÅæÊµãËØï">Ëá™Âä®ÂÆπÁÅæÊµãËØï</h2>
<p>ÂâçÈù¢Êàë‰ª¨Â∑≤ÁªèÊê≠Âª∫‰∫Ü Redis SentinelÔºåÊé•‰∏ãÊù•Êàë‰ª¨Â∞±Â∞ùËØï‰∏Ä‰∏ãËá™Âä®ÂÆπÁÅæÁöÑÂäüËÉΩÔºå‰∏∫‰∫ÜÊ®°ÊãüÊïÖÈöúÊàë‰ª¨ÂÖàÊää‰∏ªËäÇÁÇπÊâãÂä® kill ÊéâÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>@iZ2ze0nc5n41zomzyqtksmZ:~<span class="o">]</span>$ ps -ef<span class="p">|</span>grep redis <span class="c1">#ÊâæÂà∞‰∏ªËäÇÁÇπÁöÑËøõÁ®ãid</span>
</span></span><span class="line"><span class="cl">root      <span class="m">5186</span>     <span class="m">1</span>  <span class="m">0</span> 16:54 ?        00:00:23 ./src/redis-server *:6377
</span></span><span class="line"><span class="cl">root      <span class="m">5200</span>     <span class="m">1</span>  <span class="m">0</span> 16:56 ?        00:00:22 ./src/redis-server *:6378
</span></span><span class="line"><span class="cl">root      <span class="m">5304</span>  <span class="m">5287</span>  <span class="m">0</span> 17:31 pts/2    00:00:00 redis-cli -a pwd654321
</span></span><span class="line"><span class="cl">root      <span class="m">5395</span>  <span class="m">5255</span>  <span class="m">0</span> 18:26 pts/1    00:00:19 ./src/redis-sentinel *:26379 <span class="o">[</span>sentinel<span class="o">]</span>
</span></span><span class="line"><span class="cl">root      <span class="m">5547</span>  <span class="m">5478</span>  <span class="m">0</span> 20:29 pts/4    00:00:02 ./src/redis-sentinel *:26377 <span class="o">[</span>sentinel<span class="o">]</span>
</span></span><span class="line"><span class="cl">root      <span class="m">5551</span>  <span class="m">5517</span>  <span class="m">0</span> 20:29 pts/5    00:00:00 redis-cli -h 127.0.0.1 -p <span class="m">26377</span> -a pwd654321
</span></span><span class="line"><span class="cl">root      <span class="m">5568</span>  <span class="m">5371</span>  <span class="m">0</span> 20:48 pts/0    00:00:00 grep --color<span class="o">=</span>auto redis
</span></span><span class="line"><span class="cl">root     <span class="m">28517</span>     <span class="m">1</span>  <span class="m">0</span> Feb13 ?        00:15:33 ./src/redis-server *:6379
</span></span><span class="line"><span class="cl"><span class="o">[</span>@iZ2ze0nc5n41zomzyqtksmZ:~<span class="o">]</span>$ <span class="nb">kill</span> -9 <span class="m">28517</span> <span class="c1">#ÂÖ≥Èó≠‰∏ªËäÇÁÇπÊúçÂä°</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëøô‰∏™Êó∂ÂÄôÊàë‰ª¨Âú®ËøûÊé•‰∏äÂè¶‰∏ÄÂè∞ Redis ÊúçÂä°Âô®ÔºåÊü•ÁúãÂΩìÂâç‰∏ª‰ªéÊúçÂä°Âô®‰ø°ÊÅØÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>@iZ2ze0nc5n41zomzyqtksmZ:~<span class="o">]</span>$ redis-cli -h 127.0.0.1 -p <span class="m">6377</span> -a pwd654321 2&gt;/dev/null
</span></span><span class="line"><span class="cl">127.0.0.1:6377&gt; role
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="s2">&#34;master&#34;</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">770389</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">&#34;127.0.0.1&#34;</span>
</span></span><span class="line"><span class="cl">      2<span class="o">)</span> <span class="s2">&#34;6378&#34;</span>
</span></span><span class="line"><span class="cl">      3<span class="o">)</span> <span class="s2">&#34;770389&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫‰πãÂâçÁöÑ‰ªéÊúçÂä° 6377 Ë¢´ÊèêÂçá‰∏∫‰∏ªÊúçÂä°Âô®‰∫ÜÔºåËøòÂâ©‰∏ã‰∏ÄÂè∞‰ªéÊúçÂä° 6378ÔºåËÄå‰πãÂâçÁöÑ‰∏ªÊúçÂä°Âô® 6379 Ë¢´Êàë‰ª¨ÊâãÂä®‰∏ãÁ∫ø‰∫ÜÔºåÂèØ‰ª•ÁúãÂá∫ Sentinel Â∑≤ÁªèÂÆåÁæéÁöÑÂÆåÊàêÁöÑÂÆÉÁöÑÊïÖÈöúËá™Âä®ËΩ¨ÁßªÁöÑ‰ªªÂä°„ÄÇ</p>
<h2 id="‰∏ªÊúçÂä°Á´ûÈÄâËßÑÂàô">‰∏ªÊúçÂä°Á´ûÈÄâËßÑÂàô</h2>
<p>‰∏äÈù¢Êàë‰ª¨Ê®°Êãü‰∫Ü Redis Sentinel Ëá™Âä®ÂÆπÁÅæÊÅ¢Â§çÔºåÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ãÔºå‰∏ªÊúçÂä°Âô®Á´ûÈÄâÁöÑËßÑÂàôÂíåÁõ∏ÂÖ≥ËÆæÁΩÆÈ°π„ÄÇ</p>
<h3 id="Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâ‰ºòÂÖàÁ∫ßËÆæÁΩÆ"><strong>Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâ‰ºòÂÖàÁ∫ßËÆæÁΩÆ</strong></h3>
<p>Êàë‰ª¨ÂèØ‰ª• redis.conf ‰∏≠ÁöÑ replica-priority ÈÄâÈ°πÊù•ËÆæÁΩÆÁ´ûÈÄâÊñ∞‰∏ªËäÇÁÇπÁöÑ‰ºòÂÖàÁ∫ßÔºåÂÆÉÁöÑÈªòËÆ§ÂÄºÊòØ 100ÔºåÂÆÉÁöÑÊúÄÂ§ßÂÄº‰πüÊòØ 100ÔºåËøô‰∏™ÂÄºË∂äÂ∞èÂÆÉÁöÑÊùÉÈáçÂ∞±Ë∂äÈ´òÔºå‰æãÂ¶Ç‰ªéËäÇÁÇπ A ÁöÑ replica-priority ÂÄº‰∏∫ 100Ôºå‰ªéËäÇÁÇπ B ÁöÑÂÄº‰∏∫ 50Ôºå‰ªéËäÇÁÇπ C ÁöÑÂÄº‰∏∫ 5ÔºåÈÇ£‰πàÂú®Á´ûÈÄâÊó∂‰ªéËäÇÁÇπ C ‰ºö‰Ωú‰∏∫Êñ∞ÁöÑ‰∏ªËäÇÁÇπ„ÄÇ</p>
<h3 id="Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâËßÑÂàô"><strong>Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâËßÑÂàô</strong></h3>
<p>Êñ∞‰∏ªËäÇÁÇπÁöÑÁ´ûÈÄâ‰ºöÊéíÈô§‰∏çÁ¨¶ÂêàÊù°‰ª∂ÁöÑ‰ªéËäÇÁÇπÔºåÁÑ∂ÂêéÂÜçÂâ©‰ΩôÁöÑ‰ªéËäÇÁÇπÊåâÁÖß‰ºòÂÖàÁ∫ßÊù•ÊåëÈÄâ„ÄÇÈ¶ñÂÖàÊù•ËØ¥ÔºåÂ≠òÂú®‰ª•‰∏ãÊù°‰ª∂ÁöÑ‰ªéËäÇÁÇπ‰ºöË¢´ÊéíÈô§Ôºö</p>
<ol>
<li>ÊéíÈô§ÊâÄÊúâÂ∑≤Áªè‰∏ãÁ∫ø‰ª•ÂèäÈïøÊó∂Èó¥Ê≤°ÊúâÂõûÂ§çÂøÉË∑≥Ê£ÄÊµãÁöÑÁñë‰ººÂ∑≤‰∏ãÁ∫ø‰ªéÊúçÂä°Âô®Ôºõ</li>
<li>ÊéíÈô§ÊâÄÊúâÈïøÊó∂Èó¥Ê≤°Êúâ‰∏é‰∏ªÊúçÂä°Âô®ÈÄö‰ø°ÔºåÊï∞ÊçÆÁä∂ÊÄÅËøáÊó∂ÁöÑ‰ªéÊúçÂä°Âô®Ôºõ</li>
<li>ÊéíÈô§ÊâÄÊúâ‰ºòÂÖàÁ∫ßÔºàreplica-priorityÔºâ‰∏∫ 0 ÁöÑÊúçÂä°Âô®„ÄÇ</li>
</ol>
<p>Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰ªéËäÇÁÇπÁ´ûÈÄâÈ°∫Â∫èÔºö</p>
<ol>
<li>‰ºòÂÖàÁ∫ßÊúÄÈ´òÁöÑ‰ªéËäÇÁÇπÂ∞Ü‰ºö‰Ωú‰∏∫Êñ∞‰∏ªËäÇÁÇπÔºõ</li>
<li>‰ºòÂÖàÁ∫ßÁõ∏Á≠âÂàôÂà§Êñ≠Â§çÂà∂ÂÅèÁßªÈáèÔºåÂÅèÁßªÈáèÊúÄÂ§ßÁöÑ‰ªéËäÇÁÇπËé∑ËÉúÔºõ</li>
<li>Â¶ÇÊûú‰ª•‰∏ä‰∏§‰∏™Êù°‰ª∂ÈÉΩÁõ∏ÂêåÔºåÈÄâÊã© Redis ËøêË°åÊó∂ÈöèÊú∫ÁîüÊàê ID ÊúÄÂ∞èÈÇ£‰∏™‰∏∫Êñ∞ÁöÑ‰∏ªÊúçÂä°Âô®„ÄÇ</li>
</ol>
<h3 id="Êóß‰∏ªËäÇÁÇπÊÅ¢Â§ç‰∏äÁ∫ø"><strong>Êóß‰∏ªËäÇÁÇπÊÅ¢Â§ç‰∏äÁ∫ø</strong></h3>
<p>Â¶ÇÊûú‰πãÂâçÁöÑÊóß‰∏ªËäÇÁÇπÊÅ¢Â§ç‰∏äÁ∫øÔºå‰ºö‰Ωú‰∏∫‰ªéËäÇÁÇπËøêË°åÂú®‰∏ª‰ªéÊúçÂä°Âô®Ê®°Âºè‰∏≠„ÄÇ</p>
<h2 id="Âì®ÂÖµÂ∑•‰ΩúÂéüÁêÜ">Âì®ÂÖµÂ∑•‰ΩúÂéüÁêÜ</h2>
<p>Âì®ÂÖµÁöÑÂ∑•‰ΩúÂéüÁêÜÊòØËøôÊ†∑ÁöÑÔºåÈ¶ñÂÖàÊØè‰∏™ Sentinel ‰ºö‰ª•ÊØèÁßíÈíü 1 Ê¨°ÁöÑÈ¢ëÁéáÔºåÂêëÂ∑≤Áü•ÁöÑ‰∏ªÊúçÂä°Âô®„ÄÅ‰ªéÊúçÂä°Âô®Âíå‰ª•ÂèäÂÖ∂‰ªñ Sentinel ÂÆû‰æãÔºåÂèëÈÄÅ‰∏Ä‰∏™ PING ÂëΩ‰ª§„ÄÇ</p>
<p>Â¶ÇÊûúÊúÄÂêé‰∏ÄÊ¨°ÊúâÊïàÂõûÂ§ç PING ÂëΩ‰ª§ÁöÑÊó∂Èó¥Ë∂ÖËøá down-after-milliseconds ÊâÄÈÖçÁΩÆÁöÑÂÄºÔºàÈªòËÆ§ 30sÔºâÔºåÈÇ£‰πàËøô‰∏™ÂÆû‰æã‰ºöË¢´ Sentinel Ê†áËÆ∞‰∏∫‰∏ªËßÇ‰∏ãÁ∫ø„ÄÇ</p>
<p>Â¶ÇÊûú‰∏Ä‰∏™‰∏ªÊúçÂä°Âô®Ë¢´Ê†áËÆ∞‰∏∫‰∏ªËßÇ‰∏ãÁ∫øÔºåÈÇ£‰πàÊ≠£Âú®ÁõëËßÜËøô‰∏™‰∏ªÊúçÂä°Âô®ÁöÑÊâÄÊúâ Sentinel ËäÇÁÇπÔºåË¶Å‰ª•ÊØèÁßí 1 Ê¨°ÁöÑÈ¢ëÁéáÁ°ÆËÆ§ ‰∏ªÊúçÂä°Âô®ÁöÑÁ°ÆËøõÂÖ•‰∫Ü‰∏ªËßÇ‰∏ãÁ∫øÁä∂ÊÄÅ„ÄÇ</p>
<p>Â¶ÇÊûúÊúâË∂≥Â§üÊï∞ÈáèÔºàquorum ÈÖçÁΩÆÂÄºÔºâÁöÑ Sentinel Âú®ÊåáÂÆöÁöÑÊó∂Èó¥ËåÉÂõ¥ÂÜÖÂêåÊÑèËøô‰∏ÄÂà§Êñ≠ÔºåÈÇ£‰πàËøô‰∏™‰∏ªÊúçÂä°Âô®Ë¢´Ê†áËÆ∞‰∏∫ÂÆ¢ËßÇ‰∏ãÁ∫ø„ÄÇÊ≠§Êó∂ÊâÄÊúâÁöÑ Sentinel ‰ºöÊåâÁÖßËßÑÂàôÂçèÂïÜËá™Âä®ÈÄâÂá∫Êñ∞ÁöÑ‰∏ªËäÇÁÇπ„ÄÇ</p>
<blockquote>
<p>Ê≥®ÊÑèÔºö‰∏Ä‰∏™ÊúâÊïàÁöÑ PING ÂõûÂ§çÂèØ‰ª•ÊòØÔºö+PONG„ÄÅ-LOADING ÊàñËÄÖ -MASTERDOWN„ÄÇÂ¶ÇÊûúËøîÂõûÂÄºÈùû‰ª•‰∏ä‰∏âÁßçÂõûÂ§çÔºåÊàñËÄÖÂú®ÊåáÂÆöÊó∂Èó¥ÂÜÖÊ≤°ÊúâÂõûÂ§ç PING ÂëΩ‰ª§Ôºå ÈÇ£‰πà Sentinel ËÆ§‰∏∫ÊúçÂä°Âô®ËøîÂõûÁöÑÂõûÂ§çÊó†ÊïàÔºànon-valid)„ÄÇ</p>
</blockquote>
<h2 id="Â∞èÁªì-1">Â∞èÁªì</h2>
<p>Êú¨ÊñáÊàë‰ª¨ËÆ≤‰∫Ü‰∏ª‰ªéÊ®°ÂºèÁöÑÊ≠•È™§ÔºåÈúÄË¶ÅÊâãÂä®ÂàáÊç¢ÊïÖÈöúÊúçÂä°Âô®ÁöÑÂºäÁ´ØÔºåÂºïÂá∫‰∫Ü Sentinel Ê®°ÂºèÔºåÂèØ‰ª•ÂÆûÁé∞ÁõëÊéßÂíåËá™Âä®ÂÆπÁÅæÔºåÊàë‰ª¨ÈÄöËøá Redis Êèê‰æõÁöÑ Redis-Sentinel Êù•ÂêØÂä®Âì®ÂÖµÊ®°ÂºèÔºåÂΩìÊàë‰ª¨ÂêØÂä®Â§ö‰∏™Âì®ÂÖµÊ®°ÂºèÁõëËßÜÂêå‰∏Ä‰∏™‰∏ªËäÇÁÇπÊó∂ÔºåÂÆÉ‰ª¨Â∞±‰ºöÂΩºÊ≠§ÂèëÁé∞ÂΩ¢Êàê‰∏Ä‰∏™Êñ∞ÁöÑÈ´òÂèØÁî®ÁöÑ Sentinel ÁΩëÁªú„ÄÇÂêåÊó∂Êàë‰ª¨ËÆ≤‰∫Ü Sentinel ÁöÑÂ∑•‰ΩúÂéüÁêÜÊòØÈÄöËøá PING ÂëΩ‰ª§Êù•Ê£ÄÊü•ËäÇÁÇπÊòØÂê¶Â≠òÊ¥ªÁöÑÔºåÂπ∂ÈÄöËøáÈÖçÁΩÆÈ°πÂíåÂ§çÂà∂ÂÅèÁßªÈáè ID Êù•Á°ÆÂÆöÊñ∞‰∏ªËäÇÁÇπ„ÄÇ</p>
<h1 id="redis-ÈõÜÁæ§Ê®°Âºè">Redis ÈõÜÁæ§Ê®°Âºè</h1>
<p>Redis Cluster ÊòØ Redis 3.0 ÁâàÊú¨Êé®Âá∫ÁöÑ Redis ÈõÜÁæ§ÊñπÊ°àÔºåÂÆÉÂ∞ÜÊï∞ÊçÆÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑÊúçÂä°Âå∫‰∏äÔºå‰ª•Ê≠§Êù•Èôç‰ΩéÁ≥ªÁªüÂØπÂçï‰∏ªËäÇÁÇπÁöÑ‰æùËµñÔºåÂπ∂‰∏îÂèØ‰ª•Â§ßÂ§ßÁöÑÊèêÈ´ò Redis ÊúçÂä°ÁöÑËØªÂÜôÊÄßËÉΩ„ÄÇ</p>
<p>Redis Â∞ÜÊâÄÊúâÁöÑÊï∞ÊçÆÂàÜ‰∏∫ 16384 ‰∏™ slotsÔºàÊßΩÔºâÔºåÊØè‰∏™ËäÇÁÇπË¥üË¥£ÂÖ∂‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÊßΩ‰ΩçÔºåÂΩìÊúâ Redis ÂÆ¢Êà∑Á´ØËøûÊé•ÈõÜÁæ§Êó∂Ôºå‰ºöÂæóÂà∞‰∏Ä‰ªΩÈõÜÁæ§ÁöÑÊßΩ‰ΩçÈÖçÁΩÆ‰ø°ÊÅØÔºåËøôÊ†∑ÂÆÉÂ∞±ÂèØ‰ª•Áõ¥Êé•ÊääËØ∑Ê±ÇÂëΩ‰ª§ÂèëÈÄÅÁªôÂØπÂ∫îÁöÑËäÇÁÇπËøõË°åÂ§ÑÁêÜ„ÄÇ</p>
<p>Redis Cluster ÊòØÊó†‰ª£ÁêÜÊ®°ÂºèÂéª‰∏≠ÂøÉÂåñÁöÑËøêË°åÊ®°ÂºèÔºåÂÆ¢Êà∑Á´ØÂèëÈÄÅÁöÑÁªùÂ§ßÊï∞ÂëΩ‰ª§‰ºöÁõ¥Êé•‰∫§ÁªôÁõ∏ÂÖ≥ËäÇÁÇπÊâßË°åÔºåËøôÊ†∑Â§ßÈÉ®ÂàÜÊÉÖÂÜµËØ∑Ê±ÇÂëΩ‰ª§Êó†ÈúÄËΩ¨ÂèëÔºåÊàñ‰ªÖËΩ¨Âèë‰∏ÄÊ¨°ÁöÑÊÉÖÂÜµ‰∏ãÂ∞±ËÉΩÂÆåÊàêËØ∑Ê±Ç‰∏éÂìçÂ∫îÔºåÊâÄ‰ª•ÈõÜÁæ§Âçï‰∏™ËäÇÁÇπÁöÑÊÄßËÉΩ‰∏éÂçïÊú∫ Redis ÊúçÂä°Âô®ÁöÑÊÄßËÉΩÊòØÈùûÂ∏∏Êé•ËøëÁöÑÔºåÂõ†Ê≠§Âú®ÁêÜËÆ∫ÊÉÖÂÜµ‰∏ãÔºåÂΩìÊ∞¥Âπ≥Êâ©Â±ï‰∏ÄÂÄçÁöÑ‰∏ªËäÇÁÇπÂ∞±Áõ∏ÂΩì‰∫éËØ∑Ê±ÇÂ§ÑÁêÜÁöÑÊÄßËÉΩ‰πüÊèêÈ´ò‰∫Ü‰∏ÄÂÄçÔºåÊâÄ‰ª• Redis Cluster ÁöÑÊÄßËÉΩÊòØÈùûÂ∏∏È´òÁöÑ„ÄÇ</p>
<p>Redis Cluster Êû∂ÊûÑÂõæÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/WyctFV8RAj7J1Tm.png"
	
	
	
	loading="lazy"
	
		alt="1.png"
	
	
></p>
<h2 id="Êê≠Âª∫-redis-cluster">Êê≠Âª∫ Redis Cluster</h2>
<p>Redis Cluster ÁöÑÊê≠Âª∫ÊñπÂºèÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØ‰ΩøÁî® Redis Ê∫êÁ†Å‰∏≠Êèê‰æõÁöÑ create-cluster Â∑•ÂÖ∑Âø´ÈÄüÁöÑÊê≠Âª∫ Redis ÈõÜÁæ§ÁéØÂ¢ÉÔºåÂè¶‰∏ÄÁßçÊòØÈÖçÁΩÆÊñá‰ª∂ÁöÑÊñπÂºèÊâãÂä®ÂàõÂª∫ Redis ÈõÜÁæ§ÁéØÂ¢É„ÄÇ</p>
<h3 id="Âø´ÈÄüÊê≠Âª∫-redis-cluster"><strong>Âø´ÈÄüÊê≠Âª∫ Redis Cluster</strong></h3>
<p>create-cluster Â∑•ÂÖ∑Âú® utils/create-cluster ÁõÆÂΩï‰∏ãÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/OsN9qHtJiSyhR8j.png"
	
	
	
	loading="lazy"
	
		alt="2.png"
	
	
></p>
<p>‰ΩøÁî®ÂëΩ‰ª§ <code>./create-cluster start</code> Â∞±ÂèØ‰ª•ÊÄ•ÈÄüÂàõÂª∫‰∏Ä‰∏™ Redis ÈõÜÁæ§ÔºåÊâßË°åÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ ./create-cluster start <span class="c1"># ÂàõÂª∫ÈõÜÁæ§</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30001</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30002</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30003</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30004</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30005</span>
</span></span><span class="line"><span class="cl">Starting <span class="m">30006</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êé•‰∏ãÊù•Êàë‰ª¨ÈúÄË¶ÅÊää‰ª•‰∏äÂàõÂª∫ÁöÑ 6 ‰∏™ËäÇÁÇπÈÄöËøá create ÂëΩ‰ª§ÁªÑÊàê‰∏Ä‰∏™ÈõÜÁæ§ÔºåÊâßË°åÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>@iZ2ze0nc5n41zomzyqtksmZ:create-cluster<span class="o">]</span>$ ./create-cluster create <span class="c1"># ÁªÑÂª∫ÈõÜÁæ§</span>
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Performing <span class="nb">hash</span> slots allocation on <span class="m">6</span> nodes...
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>0<span class="o">]</span> -&gt; Slots <span class="m">0</span> - <span class="m">5460</span>
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>1<span class="o">]</span> -&gt; Slots <span class="m">5461</span> - <span class="m">10922</span>
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>2<span class="o">]</span> -&gt; Slots <span class="m">10923</span> - <span class="m">16383</span>
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30005 to 127.0.0.1:30001
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30006 to 127.0.0.1:30002
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30004 to 127.0.0.1:30003
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Trying to optimize slaves allocation <span class="k">for</span> anti-affinity
</span></span><span class="line"><span class="cl"><span class="o">[</span>WARNING<span class="o">]</span> Some slaves are in the same host as their master
</span></span><span class="line"><span class="cl">M: 445f2a86fe36d397613839d8cc1ae6702c976593 127.0.0.1:30001
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>0-5460<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: 63bb14023c0bf58926738cbf857ea304bff8eb50 127.0.0.1:30002
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>5461-10922<span class="o">]</span> <span class="o">(</span><span class="m">5462</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: 864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc 127.0.0.1:30003
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>10923-16383<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">S: 64828ab44566fc5ad656e831fd33de87be1387a0 127.0.0.1:30004
</span></span><span class="line"><span class="cl">   replicates 445f2a86fe36d397613839d8cc1ae6702c976593
</span></span><span class="line"><span class="cl">S: 0b17b00542706343583aa73149ec5ff63419f140 127.0.0.1:30005
</span></span><span class="line"><span class="cl">   replicates 63bb14023c0bf58926738cbf857ea304bff8eb50
</span></span><span class="line"><span class="cl">S: e35f06ca9b700073472d72001a39ea4dfcb541cd 127.0.0.1:30006
</span></span><span class="line"><span class="cl">   replicates 864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc
</span></span><span class="line"><span class="cl">Can I <span class="nb">set</span> the above configuration? <span class="o">(</span><span class="nb">type</span> <span class="s1">&#39;yes&#39;</span> to accept<span class="o">)</span>: yes
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Nodes configuration updated
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Assign a different config epoch to each node
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster
</span></span><span class="line"><span class="cl">Waiting <span class="k">for</span> the cluster to join
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Performing Cluster Check <span class="o">(</span>using node 127.0.0.1:30001<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: 445f2a86fe36d397613839d8cc1ae6702c976593 127.0.0.1:30001
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>0-5460<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: 864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc 127.0.0.1:30003
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>10923-16383<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">S: e35f06ca9b700073472d72001a39ea4dfcb541cd 127.0.0.1:30006
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc
</span></span><span class="line"><span class="cl">S: 0b17b00542706343583aa73149ec5ff63419f140 127.0.0.1:30005
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 63bb14023c0bf58926738cbf857ea304bff8eb50
</span></span><span class="line"><span class="cl">M: 63bb14023c0bf58926738cbf857ea304bff8eb50 127.0.0.1:30002
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>5461-10922<span class="o">]</span> <span class="o">(</span><span class="m">5462</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">S: 64828ab44566fc5ad656e831fd33de87be1387a0 127.0.0.1:30004
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 445f2a86fe36d397613839d8cc1ae6702c976593
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All nodes agree about slots configuration.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check <span class="k">for</span> open slots...
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check slots coverage...
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All <span class="m">16384</span> slots covered.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âú®ÊâßË°åÁöÑËøáÁ®ã‰∏≠‰ºöËØ¢ÈóÆ‰Ω†ÊòØÂê¶ÈÄöËøáÊää 30001„ÄÅ30002„ÄÅ30003 ‰Ωú‰∏∫‰∏ªËäÇÁÇπÔºåÊää 30004„ÄÅ30005„ÄÅ30006 ‰Ωú‰∏∫ÂÆÉ‰ª¨ÁöÑ‰ªéËäÇÁÇπÔºåËæìÂÖ• <code>yes</code> Âêé‰ºöÊâßË°åÂÆåÊàê„ÄÇ</p>
<p>Êàë‰ª¨ÂèØ‰ª•ÂÖà‰ΩøÁî® redis-cli ËøûÊé•Âà∞ÈõÜÁæ§ÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ redis-cli -c -p <span class="m">30001</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âú®‰ΩøÁî® nodes ÂëΩ‰ª§Êù•Êü•ÁúãÈõÜÁæ§ÁöÑËäÇÁÇπ‰ø°ÊÅØÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster nodes
</span></span><span class="line"><span class="cl">864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc 127.0.0.1:30003@40003 master - <span class="m">0</span> <span class="m">1585125835078</span> <span class="m">3</span> connected 10923-16383
</span></span><span class="line"><span class="cl">e35f06ca9b700073472d72001a39ea4dfcb541cd 127.0.0.1:30006@40006 slave 864d4dfe32e3e0b81a64cec8b393bbd26a65cbcc <span class="m">0</span> <span class="m">1585125835078</span> <span class="m">6</span> connected
</span></span><span class="line"><span class="cl">0b17b00542706343583aa73149ec5ff63419f140 127.0.0.1:30005@40005 slave 63bb14023c0bf58926738cbf857ea304bff8eb50 <span class="m">0</span> <span class="m">1585125835078</span> <span class="m">5</span> connected
</span></span><span class="line"><span class="cl">63bb14023c0bf58926738cbf857ea304bff8eb50 127.0.0.1:30002@40002 master - <span class="m">0</span> <span class="m">1585125834175</span> <span class="m">2</span> connected 5461-10922
</span></span><span class="line"><span class="cl">445f2a86fe36d397613839d8cc1ae6702c976593 127.0.0.1:30001@40001 myself,master - <span class="m">0</span> <span class="m">1585125835000</span> <span class="m">1</span> connected 0-5460
</span></span><span class="line"><span class="cl">64828ab44566fc5ad656e831fd33de87be1387a0 127.0.0.1:30004@40004 slave 445f2a86fe36d397613839d8cc1ae6702c976593 <span class="m">0</span> <span class="m">1585125835000</span> <span class="m">4</span> connected
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫ 30001„ÄÅ30002„ÄÅ30003 ÈÉΩ‰∏∫‰∏ªËäÇÁÇπÔºå30001 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 0~5460Ôºå30002 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 5461~10922Ôºå30003 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 10923~16383ÔºåÊÄªÂÖ±ÊúâÊßΩ‰Ωç 16384 ‰∏™Ôºà0~16383Ôºâ„ÄÇ</p>
<p>create-cluster Êê≠Âª∫ÁöÑÊñπÂºèËôΩÁÑ∂ÈÄüÂ∫¶ÂæàÂø´Ôºå‰ΩÜÊòØËØ•ÊñπÂºèÊê≠Âª∫ÁöÑÈõÜÁæ§‰∏ª‰ªéËäÇÁÇπÊï∞ÈáèÂõ∫ÂÆö‰ª•ÂèäÊßΩ‰ΩçÂàÜÈÖçÊ®°ÂºèÂõ∫ÂÆöÔºåÂπ∂‰∏îÂÆâË£ÖÂú®Âêå‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÔºåÊâÄ‰ª•Âè™ËÉΩÁî®‰∫éÊµãËØïÁéØÂ¢É„ÄÇ</p>
<p>Êàë‰ª¨ÊµãËØïÂÆåÊàê‰πãÂêéÔºåÂèØ‰ª•<strong>‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ÔºåÂÖ≥Èó≠Âπ∂Ê∏ÖÁêÜÈõÜÁæ§</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ ./create-cluster stop <span class="c1"># ÂÖ≥Èó≠ÈõÜÁæ§</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30001</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30002</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30003</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30004</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30005</span>
</span></span><span class="line"><span class="cl">Stopping <span class="m">30006</span>
</span></span><span class="line"><span class="cl">$ ./create-cluster clean <span class="c1"># Ê∏ÖÁêÜÈõÜÁæ§</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊâãÂä®Êê≠Âª∫-redis-cluster"><strong>ÊâãÂä®Êê≠Âª∫ Redis Cluster</strong></h3>
<p>Áî±‰∫é create-cluster Êú¨Ë∫´ÁöÑÈôêÂà∂ÔºåÂú®ÂÆûÈôÖÁîü‰∫ßÁéØÂ¢É‰∏≠Êàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ÊâãÂä®Ê∑ªÂä†ÈÖçÁΩÆÁöÑÊñπÂºèÊê≠Âª∫ Redis ÈõÜÁæ§Ôºå‰∏∫Ê≠§Êàë‰ª¨ÂÖàË¶ÅÊää Redis ÂÆâË£ÖÂåÖÂ§çÂà∂Âà∞ node1 Âà∞ node6 Êñá‰ª∂‰∏≠ÔºåÂõ†‰∏∫Êàë‰ª¨Ë¶ÅÂÆâË£Ö 6 ‰∏™ËäÇÁÇπÔºå3 ‰∏ª 3 ‰ªéÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/VrMS3qYoKy5Uzl1.png"
	
	
	
	loading="lazy"
	
		alt="3.png"
	
	
></p>
<p><img src="https://s2.loli.net/2021/12/14/NdKM7VyTYcZevJC.png"
	
	
	
	loading="lazy"
	
		alt="4.png"
	
	
></p>
<p>Êé•‰∏ãÊù•Êàë‰ª¨ËøõË°åÈÖçÁΩÆÂπ∂ÂêØÂä® Redis ÈõÜÁæ§„ÄÇ</p>
<p><strong>1. ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂</strong></p>
<p>Êàë‰ª¨ÈúÄË¶Å‰øÆÊîπÊØè‰∏™ËäÇÁÇπÂÜÖÁöÑ redis.conf Êñá‰ª∂ÔºåËÆæÁΩÆ <code>cluster-enabled yes</code> Ë°®Á§∫ÂºÄÂêØÈõÜÁæ§Ê®°ÂºèÔºåÂπ∂‰∏î‰øÆÊîπÂêÑËá™ÁöÑÁ´ØÂè£ÔºåÊàë‰ª¨ÁªßÁª≠‰ΩøÁî® 30001 Âà∞ 30006ÔºåÈÄöËøá <code>port 3000X</code> ËÆæÁΩÆ„ÄÇ</p>
<p><strong>2. ÂêØÂä®ÂêÑ‰∏™ËäÇÁÇπ</strong></p>
<p>redis.conf ÈÖçÁΩÆÂ•Ω‰πãÂêéÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÂêØÂä®ÊâÄÊúâÁöÑËäÇÁÇπ‰∫ÜÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/soft/mycluster/node1 
</span></span><span class="line"><span class="cl">./src/redis-server redis.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>3. ÂàõÂª∫ÈõÜÁæ§Âπ∂ÂàÜÈÖçÊßΩ‰Ωç</strong></p>
<p>‰πãÂâçÊàë‰ª¨Â∑≤ÁªèÂêØÂä®‰∫Ü 6 ‰∏™ËäÇÁÇπÔºå‰ΩÜËøô‰∫õËäÇÁÇπÈÉΩÂú®ÂêÑËá™ÁöÑÈõÜÁæ§‰πãÂÜÖÂπ∂Êú™‰∫íËÅî‰∫íÈÄöÔºåÂõ†Ê≠§Êé•‰∏ãÊù•Êàë‰ª¨ÈúÄË¶ÅÊääËøô‰∫õËäÇÁÇπ‰∏≤ËøûÊàê‰∏Ä‰∏™ÈõÜÁæ§ÔºåÂπ∂‰∏∫ÂÆÉ‰ª¨ÊåáÂÆöÂØπÂ∫îÁöÑÊßΩ‰ΩçÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">redis-cli --cluster create 127.0.0.1:30001 127.0.0.1:30002 127.0.0.1:30003 127.0.0.1:30004 127.0.0.1:30005 127.0.0.1:30006 --cluster-replicas <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÖ∂‰∏≠ create ÂêéÈù¢Ë∑üÂ§ö‰∏™ËäÇÁÇπÔºåË°®Á§∫ÊääËøô‰∫õËäÇÁÇπ‰Ωú‰∏∫Êï¥‰∏™ÈõÜÁæ§ÁöÑËäÇÁÇπÔºåËÄå cluster-replicas Ë°®Á§∫ÁªôÈõÜÁæ§‰∏≠ÁöÑ‰∏ªËäÇÁÇπÊåáÂÆö‰ªéËäÇÁÇπÁöÑÊï∞ÈáèÔºå1 Ë°®Á§∫‰∏∫ÊØè‰∏™‰∏ªËäÇÁÇπËÆæÁΩÆ‰∏Ä‰∏™‰ªéËäÇÁÇπ„ÄÇ</p>
<p>Âú®ÊâßË°å‰∫Ü create ÂëΩ‰ª§‰πãÂêéÔºåÁ≥ªÁªü‰ºö‰∏∫Êàë‰ª¨ÊåáÂÆöËäÇÁÇπÁöÑËßíËâ≤ÂíåÊßΩ‰ΩçÂàÜÈÖçËÆ°ÂàíÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt;&gt;&gt; Performing <span class="nb">hash</span> slots allocation on <span class="m">6</span> nodes...
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>0<span class="o">]</span> -&gt; Slots <span class="m">0</span> - <span class="m">5460</span>
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>1<span class="o">]</span> -&gt; Slots <span class="m">5461</span> - <span class="m">10922</span>
</span></span><span class="line"><span class="cl">Master<span class="o">[</span>2<span class="o">]</span> -&gt; Slots <span class="m">10923</span> - <span class="m">16383</span>
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30005 to 127.0.0.1:30001
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30006 to 127.0.0.1:30002
</span></span><span class="line"><span class="cl">Adding replica 127.0.0.1:30004 to 127.0.0.1:30003
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Trying to optimize slaves allocation <span class="k">for</span> anti-affinity
</span></span><span class="line"><span class="cl"><span class="o">[</span>WARNING<span class="o">]</span> Some slaves are in the same host as their master
</span></span><span class="line"><span class="cl">M: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30001
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>0-5460<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30002
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>5461-10922<span class="o">]</span> <span class="o">(</span><span class="m">5462</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30003
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>10923-16383<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">S: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30004
</span></span><span class="line"><span class="cl">   replicates bdd1c913f87eacbdfeabc71befd0d06c913c891c
</span></span><span class="line"><span class="cl">S: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30005
</span></span><span class="line"><span class="cl">   replicates bdd1c913f87eacbdfeabc71befd0d06c913c891c
</span></span><span class="line"><span class="cl">S: bdd1c913f87eacbdfeabc71befd0d06c913c891c 127.0.0.1:30006
</span></span><span class="line"><span class="cl">   replicates bdd1c913f87eacbdfeabc71befd0d06c913c891c
</span></span><span class="line"><span class="cl">Can I <span class="nb">set</span> the above configuration? <span class="o">(</span><span class="nb">type</span> <span class="s1">&#39;yes&#39;</span> to accept<span class="o">)</span>: 
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰ª•‰∏ä‰ø°ÊÅØÂèØ‰ª•ÁúãÂá∫ÔºåRedis ÊâìÁÆóÊää 30001„ÄÅ30002„ÄÅ30003 ËÆæÁΩÆ‰∏∫‰∏ªËäÇÁÇπÔºåÂπ∂‰∏∫‰ªñ‰ª¨ÂàÜÈÖçÁöÑÊßΩ‰ΩçÔºå30001 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 0~5460Ôºå30002 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 5461~10922Ôºå30003 ÂØπÂ∫îÁöÑÊßΩ‰ΩçÊòØ 10923~16383ÔºåÂπ∂‰∏îÊää 30005 ËÆæÁΩÆ‰∏∫ 30001 ÁöÑ‰ªéËäÇÁÇπ„ÄÅ30006 ËÆæÁΩÆ‰∏∫ 30002 ÁöÑ‰ªéËäÇÁÇπ„ÄÅ30004 ËÆæÁΩÆ‰∏∫ 30003 ÁöÑ‰ªéËäÇÁÇπÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅËæìÂÖ• <code>yes</code> Âç≥ÂèØÁ°ÆËÆ§Âπ∂ÊâßË°åÂàÜÈÖçÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Can I <span class="nb">set</span> the above configuration? <span class="o">(</span><span class="nb">type</span> <span class="s1">&#39;yes&#39;</span> to accept<span class="o">)</span>: yes
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Nodes configuration updated
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Assign a different config epoch to each node
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster
</span></span><span class="line"><span class="cl">Waiting <span class="k">for</span> the cluster to join
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Performing Cluster Check <span class="o">(</span>using node 127.0.0.1:30001<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: 887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>0-5460<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">S: abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 887397e6fefe8ad19ea7569e99f5eb8a803e3785
</span></span><span class="line"><span class="cl">S: 1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates f5958382af41d4e1f5b0217c1413fe19f390b55f
</span></span><span class="line"><span class="cl">S: dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 3da35c40c43b457a113b539259f17e7ed616d13d
</span></span><span class="line"><span class="cl">M: 3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>5461-10922<span class="o">]</span> <span class="o">(</span><span class="m">5462</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>10923-16383<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All nodes agree about slots configuration.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check <span class="k">for</span> open slots...
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check slots coverage...
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All <span class="m">16384</span> slots covered.
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊòæÁ§∫ OK Ë°®Á§∫Êï¥‰∏™ÈõÜÁæ§Â∞±Â∑≤ÁªèÊàêÂäüÂêØÂä®‰∫Ü„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨‰ΩøÁî® redis-cli ËøûÊé•Âπ∂ÊµãËØï‰∏Ä‰∏ãÈõÜÁæ§ÁöÑËøêË°åÁä∂ÊÄÅÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ redis-cli -c -p <span class="m">30001</span> <span class="c1"># ËøûÊé•Âà∞ÈõÜÁæ§</span>
</span></span><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster info <span class="c1"># Êü•ÁúãÈõÜÁæ§‰ø°ÊÅØ</span>
</span></span><span class="line"><span class="cl">cluster_state:ok <span class="c1"># Áä∂ÊÄÅÊ≠£Â∏∏</span>
</span></span><span class="line"><span class="cl">cluster_slots_assigned:16384 <span class="c1"># ÊßΩ‰ΩçÊï∞</span>
</span></span><span class="line"><span class="cl">cluster_slots_ok:16384 <span class="c1"># Ê≠£Â∏∏ÁöÑÊßΩ‰ΩçÊï∞</span>
</span></span><span class="line"><span class="cl">cluster_slots_pfail:0 
</span></span><span class="line"><span class="cl">cluster_slots_fail:0
</span></span><span class="line"><span class="cl">cluster_known_nodes:6 <span class="c1"># ÈõÜÁæ§ÁöÑËäÇÁÇπÊï∞</span>
</span></span><span class="line"><span class="cl">cluster_size:3 <span class="c1"># ÈõÜÁæ§‰∏ªËäÇÁÇπÊï∞</span>
</span></span><span class="line"><span class="cl">cluster_current_epoch:6
</span></span><span class="line"><span class="cl">cluster_my_epoch:1
</span></span><span class="line"><span class="cl">cluster_stats_messages_ping_sent:130
</span></span><span class="line"><span class="cl">cluster_stats_messages_pong_sent:127
</span></span><span class="line"><span class="cl">cluster_stats_messages_sent:257
</span></span><span class="line"><span class="cl">cluster_stats_messages_ping_received:122
</span></span><span class="line"><span class="cl">cluster_stats_messages_pong_received:130
</span></span><span class="line"><span class="cl">cluster_stats_messages_meet_received:5
</span></span><span class="line"><span class="cl">cluster_stats_messages_received:257
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ∏ÂÖ≥Â≠óÊÆµÁöÑËØ¥ÊòéÂ∑≤ÁªèÊ†áËØÜÂú®‰∏äËø∞ÁöÑ‰ª£Á†Å‰∏≠‰∫ÜÔºåËøôÈáåÂ∞±‰∏çÂÜçËµòËø∞„ÄÇ</p>
<h2 id="Âä®ÊÄÅÂ¢ûÂà†ËäÇÁÇπ">Âä®ÊÄÅÂ¢ûÂà†ËäÇÁÇπ</h2>
<p>Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÂÆûÈôÖÁöÑ‰∏öÂä°ÊÉÖÂÜµÔºåÂØπÂ∑≤ÁªèÂú®ËøêË°åÁöÑÈõÜÁæ§ËøõË°åÂä®ÊÄÅÁöÑÊ∑ªÂä†ÊàñÂà†Èô§ËäÇÁÇπÔºåÈÇ£Êàë‰ª¨Â∞±ÈúÄË¶ÅËøõË°å‰ª•‰∏ãÊìç‰Ωú„ÄÇ</p>
<h3 id="Â¢ûÂä†‰∏ªËäÇÁÇπ"><strong>Â¢ûÂä†‰∏ªËäÇÁÇπ</strong></h3>
<p><strong>Ê∑ªÂä†ÊñπÂºè‰∏ÄÔºöcluster meet</strong></p>
<p>‰ΩøÁî® <code>cluster meet ip:port</code> ÂëΩ‰ª§Â∞±ÂèØ‰ª•Êää‰∏Ä‰∏™ËäÇÁÇπÂä†ÂÖ•Âà∞ÈõÜÁæ§‰∏≠ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster meet 127.0.0.1 <span class="m">30007</span>
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster nodes
</span></span><span class="line"><span class="cl">dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006@40006 slave 3da35c40c43b457a113b539259f17e7ed616d13d <span class="m">0</span> <span class="m">1585142916000</span> <span class="m">6</span> connected
</span></span><span class="line"><span class="cl">df0190853a53d8e078205d0e2fa56046f20362a7 127.0.0.1:30007@40007 master - <span class="m">0</span> <span class="m">1585142917740</span> <span class="m">0</span> connected
</span></span><span class="line"><span class="cl">f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003@40003 master - <span class="m">0</span> <span class="m">1585142916738</span> <span class="m">3</span> connected 10923-16383
</span></span><span class="line"><span class="cl">3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002@40002 master - <span class="m">0</span> <span class="m">1585142913000</span> <span class="m">2</span> connected 5461-10922
</span></span><span class="line"><span class="cl">abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005@40005 slave 887397e6fefe8ad19ea7569e99f5eb8a803e3785 <span class="m">0</span> <span class="m">1585142917000</span> <span class="m">5</span> connected
</span></span><span class="line"><span class="cl">887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001@40001 myself,master - <span class="m">0</span> <span class="m">1585142915000</span> <span class="m">1</span> connected 0-5460
</span></span><span class="line"><span class="cl">1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004@40004 slave f5958382af41d4e1f5b0217c1413fe19f390b55f <span class="m">0</span> <span class="m">1585142916000</span> <span class="m">4</span> connected
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫Á´ØÂè£‰∏∫ 30007 ÁöÑËäÇÁÇπÂπ∂Âä†ÂÖ•Âà∞ÈõÜÁæ§‰∏≠ÔºåÂπ∂ËÆæÁΩÆÊàê‰∫Ü‰∏ªËäÇÁÇπ„ÄÇ</p>
<p><strong>Ê∑ªÂä†ÊñπÂºè‰∫åÔºöadd-node</strong></p>
<p>‰ΩøÁî® <code>redis-cli --cluster add-node Ê∑ªÂä†ËäÇÁÇπip:port ÈõÜÁæ§ÊüêËäÇÁÇπip:port</code> ‰πüÂèØ‰ª•Êää‰∏Ä‰∏™ËäÇÁÇπÊ∑ªÂä†Âà∞ÈõÜÁæ§‰∏≠ÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ redis-cli --cluster add-node 127.0.0.1:30008 127.0.0.1:30001
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Adding node 127.0.0.1:30008 to cluster 127.0.0.1:30001
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Performing Cluster Check <span class="o">(</span>using node 127.0.0.1:30001<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: 887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>0-5460<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">S: dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 3da35c40c43b457a113b539259f17e7ed616d13d
</span></span><span class="line"><span class="cl">M: df0190853a53d8e078205d0e2fa56046f20362a7 127.0.0.1:30007
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>10923-16383<span class="o">]</span> <span class="o">(</span><span class="m">5461</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">M: 1d09d26fd755298709efe60278457eaa09cefc26 127.0.0.1:30008
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">M: 3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002
</span></span><span class="line"><span class="cl">   slots:<span class="o">[</span>5461-10922<span class="o">]</span> <span class="o">(</span><span class="m">5462</span> slots<span class="o">)</span> master
</span></span><span class="line"><span class="cl">   <span class="m">1</span> additional replica<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">S: abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates 887397e6fefe8ad19ea7569e99f5eb8a803e3785
</span></span><span class="line"><span class="cl">S: 1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004
</span></span><span class="line"><span class="cl">   slots: <span class="o">(</span><span class="m">0</span> slots<span class="o">)</span> slave
</span></span><span class="line"><span class="cl">   replicates f5958382af41d4e1f5b0217c1413fe19f390b55f
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All nodes agree about slots configuration.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check <span class="k">for</span> open slots...
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; Check slots coverage...
</span></span><span class="line"><span class="cl"><span class="o">[</span>OK<span class="o">]</span> All <span class="m">16384</span> slots covered.
</span></span><span class="line"><span class="cl"><span class="o">[</span>ERR<span class="o">]</span> Node 127.0.0.1:30008 is not empty. Either the node already knows other nodes <span class="o">(</span>check with CLUSTER NODES<span class="o">)</span> or contains some key in database 0.
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰ª•‰∏äÁªìÊûúÂèØ‰ª•ÁúãÂá∫ 30008 ËäÇÁÇπ‰πüË¢´ËÆæÁΩÆÊàê‰∫Ü‰∏ªËäÇÁÇπ„ÄÇ</p>
<h3 id="Ê∑ªÂä†‰ªéËäÇÁÇπ"><strong>Ê∑ªÂä†‰ªéËäÇÁÇπ</strong></h3>
<p>‰ΩøÁî® <code>cluster replicate nodeId</code> ÂëΩ‰ª§Â∞±ÂèØ‰ª•ÊääÂΩìÂâçËäÇÁÇπËÆæÁΩÆ‰∏∫ÁõÆÊ†áËäÇÁÇπÁöÑ‰ªéËäÇÁÇπÔºåÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:30008&gt; cluster replicate df0190853a53d8e078205d0e2fa56046f20362a7
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:30008&gt; cluster nodes
</span></span><span class="line"><span class="cl">df0190853a53d8e078205d0e2fa56046f20362a7 127.0.0.1:30007@40007 master - <span class="m">0</span> <span class="m">1585147827000</span> <span class="m">0</span> connected
</span></span><span class="line"><span class="cl">abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005@40005 slave 887397e6fefe8ad19ea7569e99f5eb8a803e3785 <span class="m">0</span> <span class="m">1585147827000</span> <span class="m">1</span> connected
</span></span><span class="line"><span class="cl">1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004@40004 slave f5958382af41d4e1f5b0217c1413fe19f390b55f <span class="m">0</span> <span class="m">1585147823000</span> <span class="m">3</span> connected
</span></span><span class="line"><span class="cl">887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001@40001 master - <span class="m">0</span> <span class="m">1585147826000</span> <span class="m">1</span> connected 0-5460
</span></span><span class="line"><span class="cl">dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006@40006 slave 3da35c40c43b457a113b539259f17e7ed616d13d <span class="m">0</span> <span class="m">1585147826930</span> <span class="m">2</span> connected
</span></span><span class="line"><span class="cl">f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003@40003 master - <span class="m">0</span> <span class="m">1585147826000</span> <span class="m">3</span> connected 10923-16383
</span></span><span class="line"><span class="cl">1d09d26fd755298709efe60278457eaa09cefc26 127.0.0.1:30008@40008 myself,slave df0190853a53d8e078205d0e2fa56046f20362a7 <span class="m">0</span> <span class="m">1585147823000</span> <span class="m">7</span> connected
</span></span><span class="line"><span class="cl">3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002@40002 master - <span class="m">0</span> <span class="m">1585147827933</span> <span class="m">2</span> connected 5461-10922
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫ 30008 Â∑≤ÁªèÂèò‰∏∫ 30007 ÁöÑ‰ªéËäÇÁÇπ‰∫Ü„ÄÇ</p>
<h3 id="Âà†Èô§ËäÇÁÇπ"><strong>Âà†Èô§ËäÇÁÇπ</strong></h3>
<p>‰ΩøÁî® <code>cluster forget nodeId</code> ÂëΩ‰ª§Â∞±ÂèØ‰ª•Êää‰∏Ä‰∏™ËäÇÁÇπ‰ªéÈõÜÁæ§‰∏≠ÁßªÈô§„ÄÇ</p>
<p>Ê≠§ÂëΩ‰ª§Âíå meet ÂëΩ‰ª§‰∏çÂêåÁöÑÊó∂ÔºåÂà†Èô§ËäÇÁÇπÈúÄË¶ÅÊää‰ΩøÁî®ËäÇÁÇπÁöÑ Id ËøõË°åÂà†Èô§ÔºåÂèØ‰ª•ÈÄöËøá <code>cluster nodes</code> ÂëΩ‰ª§Êü•ÁúãÊâÄÊúâËäÇÁÇπÁöÑ Id ‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÊØè‰∏ÄË°åÁöÑÊúÄÂâçÈù¢ÁöÑ 40 ‰ΩçÂ≠óÊØçÂíåÊï∞ÁªÑÁöÑÁªÑÂêàÂ∞±ÊòØËØ•ËäÇÁÇπÁöÑ IdÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://s2.loli.net/2021/12/14/GD2fygCYZIJx9sW.png"
	
	
	
	loading="lazy"
	
		alt="5.png"
	
	
></p>
<p>ÊâßË°åÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster forget df0190853a53d8e078205d0e2fa56046f20362a7
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≠§Êó∂Êàë‰ª¨‰ΩøÁî® <code>cluster nodes</code> ÂëΩ‰ª§Êü•ÁúãÈõÜÁæ§ÁöÑÊâÄÊúâËäÇÁÇπ‰ø°ÊÅØÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:30001&gt; cluster nodes
</span></span><span class="line"><span class="cl">dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006@40006 slave 3da35c40c43b457a113b539259f17e7ed616d13d <span class="m">0</span> <span class="m">1585143789940</span> <span class="m">6</span> connected
</span></span><span class="line"><span class="cl">f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003@40003 master - <span class="m">0</span> <span class="m">1585143791000</span> <span class="m">3</span> connected 10923-16383
</span></span><span class="line"><span class="cl">3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002@40002 master - <span class="m">0</span> <span class="m">1585143789000</span> <span class="m">2</span> connected 5461-10922
</span></span><span class="line"><span class="cl">abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005@40005 slave 887397e6fefe8ad19ea7569e99f5eb8a803e3785 <span class="m">0</span> <span class="m">1585143789000</span> <span class="m">5</span> connected
</span></span><span class="line"><span class="cl">887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001@40001 myself,master - <span class="m">0</span> <span class="m">1585143786000</span> <span class="m">1</span> connected 0-5460
</span></span><span class="line"><span class="cl">1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004@40004 slave f5958382af41d4e1f5b0217c1413fe19f390b55f <span class="m">0</span> <span class="m">1585143791945</span> <span class="m">4</span> connected
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂá∫‰πãÂâçÁöÑÁ´ØÂè£‰∏∫ 30007 ÁöÑËäÇÁÇπÂ∑≤ÁªèË¢´Êàë‰ª¨ÊàêÂäüÁöÑÁßªÈô§‰∫Ü„ÄÇ</p>
<h2 id="Â∞èÁªì-2">Â∞èÁªì</h2>
<p>Êú¨ÊñáËÆ≤‰∫Ü Redis ÈõÜÁæ§ÁöÑ‰∏§ÁßçÊê≠Âª∫ÊñπÂºèÔºöcreate-cluster start Âíå cluster createÔºåÂâç‰∏ÄÁßçÊñπÂºèËôΩÁÑ∂ÈÄüÂ∫¶ÊØîËæÉÂø´Ôºå‰ΩÜÂÆÉÂè™ËÉΩÂàõÂª∫Êï∞ÈáèÂõ∫ÂÆöÁöÑ‰∏ª‰ªéËäÇÁÇπÔºåÂπ∂‰∏îÊâÄÊúâËäÇÁÇπÈÉΩÂú®Âêå‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÔºåÂõ†Ê≠§Âè™ËÉΩÁî®‰∫éÊµãËØïÁéØÂ¢É„ÄÇÊàë‰ª¨ËøòËÆ≤‰∫Ü Redis ÈõÜÁæ§Âä®ÊÄÅÊ∑ªÂä†‰∏ª„ÄÅ‰ªéËäÇÁÇπÂíåÂà†Èô§‰ªªÊÑèËäÇÁÇπÁöÑÂäüËÉΩ„ÄÇ</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            ÊúÄÂêéÊõ¥Êñ∞‰∫é 2022Âπ¥3Êúà18Êó• 08:26 UTC
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-contents--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-contents">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/posts/redis%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">
        
        
            <div class="article-image">
                
                    <img src="/23.jpg" loading="lazy" data-key="" data-hash="/23.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">RedisÂ∏∏Áî®Êï∞ÊçÆÁ±ªÂûã</h2>
        </div>
    </a>
</article>
            
                
<article class="has-image">
    <a href="/posts/redis%E6%8C%81%E4%B9%85%E5%8C%96/">
        
        
            <div class="article-image">
                
                    <img src="/26.jpg" loading="lazy" data-key="" data-hash="/26.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">RedisÊåÅ‰πÖÂåñ</h2>
        </div>
    </a>
</article>
            
                
<article class="has-image">
    <a href="/posts/redis%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84/">
        
        
            <div class="article-image">
                
                    <img src="/27.png" loading="lazy" data-key="" data-hash="/27.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">RedisÊòØÂ¶Ç‰ΩïÊâßË°åÁöÑ</h2>
        </div>
    </a>
</article>
            
                
<article class="has-image">
    <a href="/posts/redis%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%E5%92%8C%E7%9B%B8%E5%85%B3%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">
        
        
            <div class="article-image">
                
                    <img src="/25.png" loading="lazy" data-key="" data-hash="/25.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">RedisÈóÆÈ¢òÊ±áÊÄªÂíåÁõ∏ÂÖ≥Ëß£ÂÜ≥ÊñπÊ°à</h2>
        </div>
    </a>
</article>
            
        </div>
    </div>
</aside>

     
    
        
    <script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
    .waline-container .vcount {
        color: var(--card-text-color-main);
    }
</style><script>
    
    new Waline({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tieba","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/alus"],"lang":"zh-CN","locale":{"admin":"Admin"},"requiredMeta":["name","email","url"],"serverURL":"https://blog-api-2w7xkqg6y-ahaomin.vercel.app/","visitor":true});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 ahao&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.10.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ">‰∏ª‰ªéÂêåÊ≠•ÁöÑ‰ºòÁÇπ</a></li>
    <li><a href="#ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠•">ÂºÄÂêØ‰∏ª‰ªéÂêåÊ≠•</a>
      <ol>
        <li><a href="#ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô®"><strong>ËøêË°å‰∏≠ËÆæÁΩÆ‰ªéÊúçÂä°Âô®</strong></a></li>
        <li><a href="#ÂêØÂä®Êó∂ËÆæÁΩÆ‰ªéÊúçÂä°Âô®"><strong>ÂêØÂä®Êó∂ËÆæÁΩÆ‰ªéÊúçÂä°Âô®</strong></a></li>
      </ol>
    </li>
    <li><a href="#Êï∞ÊçÆÂêåÊ≠•">Êï∞ÊçÆÂêåÊ≠•</a>
      <ol>
        <li><a href="#ÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•"><strong>ÂÆåÊï¥Êï∞ÊçÆÂêåÊ≠•</strong></a></li>
        <li><a href="#ÈÉ®ÂàÜÊï∞ÊçÆÂêåÊ≠•"><strong>ÈÉ®ÂàÜÊï∞ÊçÆÂêåÊ≠•</strong></a></li>
        <li><a href="#Êó†ÁõòÊï∞ÊçÆÂêåÊ≠•"><strong>Êó†ÁõòÊï∞ÊçÆÂêåÊ≠•</strong></a></li>
      </ol>
    </li>
    <li><a href="#Êü•ËØ¢ÊúçÂä°Âô®ÁöÑËßíËâ≤">Êü•ËØ¢ÊúçÂä°Âô®ÁöÑËßíËâ≤</a>
      <ol>
        <li><a href="#‰∏ªÊúçÂä°Êü•Áúã"><strong>‰∏ªÊúçÂä°Êü•Áúã</strong></a></li>
        <li><a href="#‰ªéÊúçÂä°Âô®Êü•Áúã"><strong>‰ªéÊúçÂä°Âô®Êü•Áúã</strong></a></li>
      </ol>
    </li>
    <li><a href="#ÂÖ≥Èó≠‰∏ª‰ªéÂêåÊ≠•">ÂÖ≥Èó≠‰∏ª‰ªéÂêåÊ≠•</a></li>
    <li><a href="#Ê≥®ÊÑè‰∫ãÈ°π">Ê≥®ÊÑè‰∫ãÈ°π</a>
      <ol>
        <li><a href="#Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò"><strong>Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò</strong></a></li>
        <li><a href="#‰ªéÊúçÂä°Âô®Âè™ËØªÊÄß"><strong>‰ªéÊúçÂä°Âô®Âè™ËØªÊÄß</strong></a></li>
        <li><a href="#Â§çÂà∂ÂëΩ‰ª§ÁöÑÂèòÂåñ"><strong>Â§çÂà∂ÂëΩ‰ª§ÁöÑÂèòÂåñ</strong></a></li>
      </ol>
    </li>
    <li><a href="#Â∞èÁªì">Â∞èÁªì</a></li>
  </ol>

  <ol>
    <li><a href="#redis-sentinel-Êê≠Âª∫">Redis Sentinel Êê≠Âª∫</a></li>
    <li><a href="#ÂêØÂä®-sentinel-ÈõÜÁæ§">ÂêØÂä® Sentinel ÈõÜÁæ§</a></li>
    <li><a href="#Ëá™Âä®ÂÆπÁÅæÊµãËØï">Ëá™Âä®ÂÆπÁÅæÊµãËØï</a></li>
    <li><a href="#‰∏ªÊúçÂä°Á´ûÈÄâËßÑÂàô">‰∏ªÊúçÂä°Á´ûÈÄâËßÑÂàô</a>
      <ol>
        <li><a href="#Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâ‰ºòÂÖàÁ∫ßËÆæÁΩÆ"><strong>Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâ‰ºòÂÖàÁ∫ßËÆæÁΩÆ</strong></a></li>
        <li><a href="#Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâËßÑÂàô"><strong>Êñ∞‰∏ªËäÇÁÇπÁ´ûÈÄâËßÑÂàô</strong></a></li>
        <li><a href="#Êóß‰∏ªËäÇÁÇπÊÅ¢Â§ç‰∏äÁ∫ø"><strong>Êóß‰∏ªËäÇÁÇπÊÅ¢Â§ç‰∏äÁ∫ø</strong></a></li>
      </ol>
    </li>
    <li><a href="#Âì®ÂÖµÂ∑•‰ΩúÂéüÁêÜ">Âì®ÂÖµÂ∑•‰ΩúÂéüÁêÜ</a></li>
    <li><a href="#Â∞èÁªì-1">Â∞èÁªì</a></li>
  </ol>

  <ol>
    <li><a href="#Êê≠Âª∫-redis-cluster">Êê≠Âª∫ Redis Cluster</a>
      <ol>
        <li><a href="#Âø´ÈÄüÊê≠Âª∫-redis-cluster"><strong>Âø´ÈÄüÊê≠Âª∫ Redis Cluster</strong></a></li>
        <li><a href="#ÊâãÂä®Êê≠Âª∫-redis-cluster"><strong>ÊâãÂä®Êê≠Âª∫ Redis Cluster</strong></a></li>
      </ol>
    </li>
    <li><a href="#Âä®ÊÄÅÂ¢ûÂà†ËäÇÁÇπ">Âä®ÊÄÅÂ¢ûÂà†ËäÇÁÇπ</a>
      <ol>
        <li><a href="#Â¢ûÂä†‰∏ªËäÇÁÇπ"><strong>Â¢ûÂä†‰∏ªËäÇÁÇπ</strong></a></li>
        <li><a href="#Ê∑ªÂä†‰ªéËäÇÁÇπ"><strong>Ê∑ªÂä†‰ªéËäÇÁÇπ</strong></a></li>
        <li><a href="#Âà†Èô§ËäÇÁÇπ"><strong>Âà†Èô§ËäÇÁÇπ</strong></a></li>
      </ol>
    </li>
    <li><a href="#Â∞èÁªì-2">Â∞èÁªì</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
